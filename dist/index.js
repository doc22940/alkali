!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.alkali=e():t.alkali=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;factory=function(){var getPrototypeOf=Object.getPrototypeOf||function(t){return t.__proto__},setPrototypeOf=Object.setPrototypeOf||function(t,e){for(var n in e)try{t.hasOwnProperty(n)||(e.hasOwnProperty(n)?Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n)):t[n]=e[n])}catch(t){}},hasFeatures={requestAnimationFrame:"undefined"!=typeof requestAnimationFrame,defineProperty:Object.defineProperty&&function(){try{return Object.defineProperty({},"t",{}),!0}catch(t){}}(),promise:"undefined"!=typeof Promise,MutationObserver:"undefined"!=typeof MutationObserver,WeakMap:"function"==typeof WeakMap};function has(t){return hasFeatures[t]}function SyncPromise(t){this.value=t}function SyncErrorPromise(t){this.value=t,this.unhandledTimeout=setTimeout(function(){console.error("Uncaught (in promise)",t)})}SyncPromise.prototype={then:function(t,e){if(!t)return new SyncPromise(this.value);try{var n=t(this.value);return n&&n.then?n:new SyncPromise(n)}catch(t){return new SyncErrorPromise(t)}},catch:function(t){return this.then(null,t)},finally:function(t){return t(),this}},SyncErrorPromise.prototype=new SyncPromise,SyncErrorPromise.prototype.then=function(t,e){return clearTimeout(this.unhandledTimeout),e?SyncPromise.prototype.then.call(this,e):new SyncErrorPromise(this.value)};var observe=has("defineProperty")?function(t,e){return e.addKey=function(n){var r="key"+n;if(this[r])return;this[r]=!0;var i,o=t[n],s=t;do{i=Object.getOwnPropertyDescriptor(s,n)}while(!i&&(s=getPrototypeOf(s)));if(i&&i.set){var u=i.set,a=i.get;Object.defineProperty(t,n,{get:function(){return o=a.call(this)},set:function(t){u.call(this,t),o!==t&&(o=t,e&&e([{target:this,name:n}]))},enumerable:i.enumerable})}else Object.defineProperty(t,n,{get:function(){return o},set:function(t){o!==t&&(o=t,e&&e([{target:this,name:n}]))},enumerable:!i||i.enumerable})},e.remove=function(){e=null},e}:function(t,e){timerStarted||(timerStarted=!0,setInterval(function(){for(var t=0,e=watchedObjects.length;t<e;t++)diff(watchedCopies[t],watchedObjects[t],listeners[t])},20));var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);watchedObjects.push(t),watchedCopies.push(n),listeners.push(e)},queuedListeners;function queue(t,e,n){queuedListeners?-1===queuedListeners.indexOf(t)&&queuedListeners.push(t):(queuedListeners=[t],lang.nextTurn(function(){queuedListeners.forEach(function(t){var e=[];t.properties.forEach(function(n){e.push({target:t.object,name:n})}),t(e),t.object=null,t.properties=null}),queuedListeners=null},0)),t.object=e;var r=t.properties||(t.properties=[]);-1===r.indexOf(n)&&r.push(n)}var unobserve=has("observe")?Object.unobserve:function(t,e){e.remove&&e.remove();for(var n=0,r=watchedObjects.length;n<r;n++)if(watchedObjects[n]===t&&listeners[n]===e)return watchedObjects.splice(n,1),watchedCopies.splice(n,1),void listeners.splice(n,1)},watchedObjects=[],watchedCopies=[],listeners=[],timerStarted=!1;function diff(t,e,n){var r;for(var i in t)t.hasOwnProperty(i)&&t[i]!==e[i]&&(t[i]=e[i](r||(r=[])).push({name:i}));for(var i in e)e.hasOwnProperty(i)&&!t.hasOwnProperty(i)&&(t[i]=e[i](r||(r=[])).push({name:i}));r&&n(r)}var id=1;function toJSONHidden(){return toJSONHidden}var Hidden=function(){},extendClass,constructOrCall;Hidden.prototype.toJSON=toJSONHidden;try{extendClass=eval("(function(Base){ return class extends Base {}})\n\n//# sourceURL=class-extend");var possibleConstructOrCall=eval('"use strict";(function(BaseClass, constructHandler, callHandler, constructClass){ return function Element() { return this instanceof Element ? constructHandler ? constructHandler.apply(new.target || this.constructor, arguments) : constructClass ? Reflect.construct(BaseClass, arguments, new.target || this.constructor) : lang.functionConstruct(BaseClass, arguments, new.target || this.constructor, this) : callHandler.apply(Element, arguments) } })\n\n//# sourceURL=construct-or-call');new(possibleConstructOrCall(function(){},function(){})),constructOrCall=possibleConstructOrCall}catch(t){}var lang={requestAnimationFrame:has("requestAnimationFrame")?requestAnimationFrame:function(){var t=[],e=!1;function n(){for(var n=0;n<t.length;n++)t[n]();t=[],e=!1}return function(r){e||(setTimeout(n),e=!0),t.push(r)}}(),SyncPromise:SyncPromise,SyncErrorPromise:SyncErrorPromise,Promise:has("promise")?Promise:function(){return function t(e){var n,r,i,o=0;function s(t){i=t,u()}function u(){n=!0;for(var t=0,e=o.length;t<e;t++)o[t]();o=0}return e(function t(e){e&&e.then?e.then(t,s):(r=e,u())},s),{then:function(e,s){return new t(function(t,u){function a(){try{i&&!s?u(i):t(i?s(i):e?e(r):r)}catch(t){u(t)}}n?a():(o||(o=[])).push(a)})}}}}(),Set:"undefined"!=typeof Set?new Set(["a"]).length?Set:function(t){var e=new Set;if(t)for(var n=0;n<t.length;n++)e.add(t[n]);return e}:function(t){return t=t||[],{add:function(e){this.has(e)||t.push(e)},has:function(e){return t.indexOf(e)>-1}}},Map:"undefined"!=typeof Map?Map:function(){var t=Object.create(null);return{set:function(e,n){t[e]=n},has:function(e){return Object.prototype.hasOwnProperty.call(t,key)},get:function(e){return t[e]}}},WeakMap:has("WeakMap")?WeakMap:function(t,e){var n="__"+(e||"")+id++;return has("defineProperty")?{get:function(t){return t[n]},set:function(t,e){Object.defineProperty(t,n,{value:e,enumerable:!1})}}:{get:function(t){var e=t[n];return e&&e.value},set:function(t,e){(t[n]||(t[n]=new Hidden)).value=e}}},observe:observe,unobserve:unobserve,extendClass:extendClass,when:function(t,e,n){return t&&t.then?t.then(e,n)||t:e(t)},compose:function(t,e,n){var r=e.prototype=Object.create(t.prototype);for(var i in setPrototypeOf(e,t),n)r[i]=n[i];return r.constructor=e,e},setPrototypeOf:setPrototypeOf,nextTurn:has("MutationObserver")?function(t){var e=document.createElement("div");new MutationObserver(t).observe(e,{attributes:!0}),e.setAttribute("a",id++)}:function(t){setTimeout(t,0)},copy:Object.assign||function(t,e){for(var n in e)t[n]=e[n];return t},deepCopy:function(t){if(t&&"object"==typeof t){if(t instanceof Array)for(var e=[],n=0,r=t.length;n<r;n++)e[n]=lang.deepCopy(t[n]);else{e={};for(var n in t)e[n]=lang.deepCopy(t[n])}return e}return t},constructOrCall:constructOrCall||function(t,e,n){return function r(){if(this instanceof r){if(this.hasOwnProperty("constructor")||r.prototype!==getPrototypeOf(this)){if(e)return e.apply(this.constructor,arguments)}else{if(e)return e.apply(r,arguments);lang.buggyConstructorSetter?Object.defineProperty(this,"constructor",{value:r}):this.constructor=r}return t.apply(this,arguments)}return n.apply(r,arguments)}},functionConstruct:function(t,e,n,r){return r.hasOwnProperty("constructor")||n.prototype!==Object.getPrototypeOf(r)||(r=Object.create(n.prototype),lang.buggyConstructorSetter?Object.defineProperty(r,"constructor",{value:n}):r.constructor=n),t.apply(r,e)}};function isGenerator(t){if("function"==typeof t){var e=t.constructor;return"GeneratorFunction"===(e.displayName||e.name)}}function isGeneratorIterator(t){if(t&&t.next){var e=t.constructor.constructor;return"GeneratorFunction"===(e.displayName||e.name)}}function spawn(t){var e,n,r="function"==typeof t?t():t;return function t(){for(;;){var i=r[n?"throw":"next"](e);if(i.done)return i.value;e=i.value;try{if(e&&e.next&&isGeneratorIterator(e)&&(e=spawn(e)),e&&e.then){var o=null,s=e.then(function(r){if(e=r,n=!1,!1===o)return t();o=!0},function(r){return e=r,n=!0,t()});if(!o)return o=!1,s}n=!1}catch(t){n=!0,e=t}}}()}return lang.isGenerator=isGenerator,lang.spawn=spawn,lang},__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(t,e,n){(function(r){var i,o,s;o=[n(0)],void 0===(s="function"==typeof(i=function(t){var e,n,i={},o=t.WeakMap,s=t.Map,u=t.Set,a=t.setPrototypeOf,f=Object.getPrototypeOf||function(t){return t.__proto__},c=t.isGenerator,p=3,h=4,l={name:"Not modified",toString:function(){return"Marker for not-modified response"}},d={getTyped:!0},v={getTyped:!0,allowUntyped:!0},y={ensureValidType:!0},g=new t.WeakMap(null,"propertyListenersMap"),b=(new t.WeakMap,Date.now()),w=(t.compose(o,function(){},{_propertyChange:function(t){this.variable._propertyChange(t,contextFromCache(this))}}),1);function O(t,e,n){return t&&t.then?t.then(e,n):e(t)}function _(t,e){this.subject=t,e&&(this.notifies=e)}function m(t,e){this.subject=e,this.listener=t}function j(){this.visited=new u}function S(t){this.visited=t?t.visited:new u}function P(t,e,n){this.key=t,this.propertyEvent=e,this.parent=n,this.visited=e.visited}function x(t,e,n,r,i){this.visited=new u,this.modifier=t,this.items=e,this.removed=n,this.start=r,this.deleteCount=i}function T(t,e,n){this.entryEvent=n,this.visited=n.visited,this.key=t,this.value=e}function V(t,e){this.key=t,this.value=e,this.visited=new u}function A(t,e){this.key=t,this.value=e,this.visited=new u}function W(t,e,n){var r;return e.then(function(i){if(!1!==r)r=!0;else{if(t.promise!==e)return;t.promise=null}n?n(i):t.value=i},function(n){if(!1!==r)r=!0;else{if(t.promise!==e)return;t.promise=null}t.error=n}),r||(r=!1,t.promise=e),e}function D(t){if(!(this instanceof D))return D.with(t);t!==n&&(t&&t.then&&!t.notifies?W(this,t):this.value=t)}_.prototype={constructor:_,newContext:function(t){return new this.constructor(this.subject,this.notifies)},executeWithin:function(t){var n=e;try{return e=this,t()}finally{e=n}},version:1,restart:function(){},contextualize:function(e,n){var r;if(this.distinctSubject){var i=e._contextMap||(e._contextMap=new t.WeakMap);if(!(r=i.get(this.distinctSubject))){i.set(this.distinctSubject,r=Object.create(e)),r.listeners=!1,r.context=this;for(var o=this.sources,s=0,u=o.length;s<u;s++)r[o[s]]=o[++s]}this.contextualized=r,n&&n.merge(this)}else r=e;return r},setVersion:function(t){if(isNaN(t))throw new Error("Bad version");return this.version=Math.max(this.version,t)},merge:function(t){this.distinctSubject||(this.distinctSubject=t.distinctSubject)},specify:function(t){var e,n=this.subject,r=n.constructor.ownedClasses;if(r){this.distinctSubject||(this.distinctSubject=n);var i=r.get(t);if(i)return(e=i.get(n))||i.set(n,e=i.createInstance?i.createInstance(n):new t),e}return t.defaultInstance},getContextualized:function(t){if(!this.subject)return t;var e=t._contextMap&&this.subject&&t._contextMap.get(this.subject);return e&&e.context&&e.context.matches(this)?e:void 0},matches:function(t){return t.subject===this.subject}},m.prototype=Object.create(_.prototype),m.prototype.constructor=m,j.prototype.type="replaced",S.prototype.type="replaced",P.prototype.type="property",x.prototype.type="spliced",T.prototype.type="entry",T.prototype.doesAffect=function(t){return this.value.constructor.for(t).id.valueOf()==this.value.id.valueOf()},V.prototype.type="deleted",A.prototype.type="added",A.prototype.doesAffect=function(){return!1},D._logStackTrace=function(t){var e=((new Error).stack||"").split(/[\r\n]+/);e[0]&&/^Error\s*/.test(e[0])&&e.shift(),e[0]&&/_logStackTrace/.test(e[0])&&e.shift();var n=this._debugOpts&&this._debugOpts.coalesce||[];if(this._debugOpts&&this._debugOpts.shortStackTrace)e.some(function(t){n.some(function(e){return e.re.test(t)})||(t=e[0])}),console.log("Variable "+t.__debug+" changed",s&&s.replace(/^\s+/,""));else{if(n.length){for(var r,i=[],o=0;o<e.length;o++){var s=e[o];if(r){if(r.test(s))continue;r=null}n.some(function(t){return t=t.re.test(s)}),s=s.replace(/^\s+/,""),r?(i.push("("+r.name+") "+s),r=r.re):i.push(s)}e=i}var u=this._debugOpts&&this._debugOpts.stackObject;u?console.log("Variable "+t.__debug+" changed",e):console.log("Variable "+t.__debug+" changed\r\n"+e.join("\r\n"))}},D._debugOpts={coalesce:[{name:"alkali",re:/\/alkali\//},{name:"Promise",re:/(Promise\.)|(PromiseArray\.)|(\/bluebird\/)/}],stackObject:!1};var F=D.prototype={constructor:D,valueOf:function(t){var e=this.gotValue(this.getValue());return!t&&e&&e.then?n:e},then:function(n,r){var i,o;try{i=this.valueOf(!0),(o=i&&i.then)||(i=new t.SyncPromise(i))}catch(e){i=new t.SyncErrorPromise(e)}if(n||r){if(o&&e){var s=e;return i.then(n&&function(t){return s.executeWithin(function(){return n(t)})},r&&function(t){return s.executeWithin(function(){return r(t)})})}return i.then(n,r)}return i},getValue:function(t){e&&e.setVersion(t?this.version:Math.max(this.version||0,this.versionWithChildren||0));var r,i=this.key;if(null!=i&&null!=(r=this.parent)){var o;if(e&&null!=e.ifModifiedSince&&(e.ifModifiedSince=n),(o=r.getValue?r.getValue(!0):r.value)&&o.then&&!o.notifies)return O(o,function(t){var e=null==t?n:"function"==typeof t.property?t.property(i):"function"==typeof t.get?t.get(i):t[i],r=g.get(t);return r&&r.observer&&r.observer.addKey&&r.observer.addKey(i),e});var s=null==o?n:"function"==typeof o.property?o.property(i):"function"==typeof o.get?o.get(i):o[i],u=g.get(o);return u&&u.observer&&u.observer.addKey&&u.observer.addKey(i),s}if(this.promise)return this.promise;var s=this.value;return s!==n?this.value:this.default},gotValue:function(t){var r=this.returnedVariable,i=this;if(r){if(t===r)return e&&e.ifModifiedSince>0&&(e.ifModifiedSince=n),t.valueOf(!0);i.listeners&&r.stopNotifies(i),i.returnedVariable=null}if(t&&t.notifies&&(i.returnedVariable=t,i.listeners&&t.notifies(i),e&&e.ifModifiedSince>0&&(e.ifModifiedSince=n),t=t.valueOf(!0)),t&&t.then){var o=e;return t.then(function(t){return t&&(t.__variable&&(t=t.__variable),t.subscribe)?o?o.executeWithin(function(){return D.prototype.gotValue.call(i,t)}):D.prototype.gotValue.call(i,t):t})}return t},PropertyClass:D,property:function(t,e){var r=this[t];if(r&&r.notifies||(r=this._properties&&this._properties[t]),r){if(e&&!(r instanceof e))throw new TypeError("Existing property variable does not match requested variable type")}else{var i=e;i||"function"==typeof(i=this.constructor[t])&&i.isPropertyClass||(i=this.PropertyClass),(r=new i).key=t,r.parent=this,this[t]===n?this[t]=r:(this._properties||(this._properties={}))[t]=r}return r},for:function(t){return t&&t.target&&!t.constructor.getForClass&&(t=t.target),this.parent?this.parent.for(t).property(this.key):new R(this,t||$)},get isWritable(){return this.fixed?!this.value||this.value.isWritable:this._isWritable},set isWritable(t){this._isWritable=t},_isWritable:!0,_propertyChange:function(t,e,n){this.onPropertyChange&&this.onPropertyChange(t,e),this.updated(new P(t,new S,this))},eachKey:function(t){for(var e in this._properties)t(e);for(var e in this)if(this.hasOwnProperty[e]){var n=this[e];n&&n.parent==this&&n.listeners&&t(e)}},apply:function(t,e){return new I(e[0],this,e)},call:function(t){return this.apply(t,Array.prototype.slice.call(arguments,1))},forDependencies:function(t){this.returnedVariable&&t(this.returnedVariable),this.hasNotifyingChild&&function t(e,n,r){for(var i in e===n&&t(e,e._properties,r),n){var o=n[i];if(o&&o.parent==e&&(o.returnedVariable&&r(o.returnedVariable),o.hasChildNotifiers)){var s=o._properties;s&&t(o,o,r)}}}(this,this,t),this.parent&&t(this.parent)},init:function(){var t=this,e=[];return this.forDependencies(function(n){var r=n.notifies(t);e.push(r)}),null===this.listeningToObject&&this.valueOf(),this},cleanup:function(){this.listeners=!1;var t=this.handles;if(t)for(var e=0;e<t.length;e++)t[e].remove();this.handles=null,this.returnedVariable;var n=this;this.forDependencies(function(t){t.stopNotifies(n)})},version:0,versionWithChildren:0,updateVersion:function(t){var e=256*(Date.now()-15e11);e>b&&(b=e),this.version=b++},getVersion:function(){return Math.max(this.version,this.returnedVariable&&this.returnedVariable.getVersion?this.returnedVariable.getFullVersion(e):0,this.parent?this.parent.getVersion(e):0)},getFullVersion:function(){return Math.max(this.versionWithChildren,this.getVersion())},getSubject:function(t){return this.subject},getUpdates:function(t){var e=[],n=this.nextUpdateMap;if(n&&t)for(;t=n.get(t);)"replaced"===t.type&&(e=[]),e.push(t);return e},_initUpdate:function(t,e){if(!t.version){var n=256*(Date.now()-15e11);n>b&&(b=n),t.version=b++}return t instanceof P?this.versionWithChildren=t.version:e||(this.version=t.version),t},updated:function(t,e,n){if(t||((t=new S).source=this),t.visited.has(this))return t;t.visited.add(this),this.__debug&&D._logStackTrace(this),this._initUpdate(t,n);var r=this.listeners;if(r){var i=this;r=r.slice();for(var o=0,s=r.length;o<s;o++){var u=r[o];if(!u.parent||t instanceof S)u.updated(t,i,!0);else if(t instanceof P)u.key===t.key&&u.updated(t.propertyEvent,i);else{var a=new S(t);u.updated(a,i,!0)}}}if(t instanceof P||t instanceof S){this.returnedVariable&&this.fixed&&this.returnedVariable.updated(t,this);var f=this.constructor,i=this;f.collection&&f.collection.updated(new T(this.id,this,t))}return this.parent&&this.parent.updated(new P(this.key,t,this.parent),this),this.collection&&this.collection.updated(t,this),t},invalidate:function(){this.updated()},notifies:function(t){if(!t)throw new Error("No listener provided for notification");var e=this.listeners;if(!e||!this.hasOwnProperty("listeners")){var n=this.init();return n.listeners=e=[t],n}return-1===e.indexOf(t)&&e.push(t),this},subscribe:function(e){var n,r,i=this;if("function"==typeof e){var i=this,o={value:function(){return new _(null,!0).executeWithin(function(){return i.valueOf(!0)})}};n=function(){r=!1,e(o)}}else{if(!e.next)throw new Error("Subscribing to an invalid listener, the listener must be a function, or have an update or next method");n=function(){r=!1,i.then(function(t){e.next(t)},function(t){e.error(value)})}}var s={updated:function(){r||(r=!0,t.nextTurn(n))}};return n(),this.notifies(s),{unsubscribe:function(){i.stopNotifies(s)}}},stopNotifies:function(t){var e=this.listeners;if(e){var n=e.indexOf(t);n>-1&&(e.splice(n,1),0===e.length&&this.cleanup())}},put:function(t,e){if(this.parent&&this.key!==n)return M(this,p,t,e);var r=this.getValue?this.getValue():this.value;if(r===t&&"object"!=typeof t)return i;if(r&&r.put&&r.notifies&&(this.fixed||!(t&&t.put&&t.notifies)))try{return r.put(t)}catch(t){if(!t.deniedPut)throw t}return t&&t.then&&!t.notifies?t=W(this,t):(this.value=t,t&&t.put&&(this.copiedFrom=t)),(e=e||new S).oldValue=r,e.target=this,this.updated(e,this),t},get:function(t){if(this[t]||this._properties&&this._properties[t])return this.property(t).valueOf(!0);var e=this.getValue();if(e){if("function"==typeof e.get)return e.get(t);var n=e[t];return n&&n.notifies?n.valueOf(!0):n}},set:function(t,e,n){M(this.property(t),h,e,n)},undefine:function(t){this.set(t,n)},is:function(t,e){if(this.parent){var n=this.parent,r=this.key,i=n.getValue?n.getValue(!0):n.value,o=new P(r,e||new S,n);return i?(i[r]=t,this.updated(o,this)):((i="number"==typeof r?[]:{})[r]=t,n.is(i,o)),this}return this.fixed=!0,t&&t.then&&!t.notifies?W(this,t):this.value=t,this.updated(new S,this),this},proxy:function(t){return this.is(t)},next:function(t){this.put(t)},error:function(t){var e=this.listeners;e&&e.forEach(function(e){e.error(t)})},complete:function(t){this.put(t)},save:function(){return!!this.copiedFrom&&(this.copiedFrom.put(this.valueOf()),!0)},onValue:function(t){return this.subscribe(function(e){O(e.value(),function(e){t(e)})})},toJSON:function(){return this.valueOf()},toString:function(){return String(this.valueOf())},to:function(t,e){if("function"!=typeof t)throw"object"==typeof t&&this.to(t.get,t.set),new Error("No function provided to transform");return e&&(t.reverse=function(t,n){return e.call(this,t,n[0])}),t.prototype instanceof D?new t(this):new(this._Transform||I)(this,t)},map:function(t){return this.to(function(e){if(e instanceof Array)throw new Error("map without VArray");return t(e)})},as:function(t){var e=new t(this);return e.fixed=!0,e},whileResolving:function(t,e){return t||arguments.length>0?new WhileResolving(this,t,e):new WhileResolving(this,n,!0)},validate:function(t,e){if(this.returnedVariable)return this.returnedVariable.validate(t,e);if(this.parent)return this.parent.validate(t.valueOf(),e);if(e){if(e.type&&e.type!==typeof t)return["Target type of "+typeof t+" does not match schema type of "+e.type];if(e.required&&(null==t||""==t||"number"==typeof t&&isNaN(t)))return["Value is required"]}var n=[];return n.isValid=!0,n},set structured(t){for(var e=Object.keys(this),n=e.length>1&&this._properties||(this._properties={}),r=0,i=e.length;r<i;r++){var o=e[r],s=this[o];if(s instanceof D){var u=n[o];if(u)u!==s&&u.put(s);else{if(s.parent){if(s.parent===this)continue;var a=new D;a.proxy(s),s=a}s.key=o,s.parent=this,n[o]=s}}}},observeObject:function(){var e=this;return O(this.valueOf(),function(r){var i=g.get(r);if(i||g.set(r,i=[]),i.observerCount)i.observerCount++;else{i.observerCount=1;var o=i.observer=t.observe(r,function(t){for(var e=0,n=i.length;e<n;e++)for(var o=i[e],s=0,u=t.length;s<u;s++){var a=t[s];o._propertyChange(a.name,r)}});if(o.addKey)for(var s=0,u=i.length;s<u;s++){var a=i[s];a.eachKey(function(t){o.addKey(t)})}}return function(t,e){var r=g.get(t),i=e.listenerId||(e.listenerId="-"+w++);r?r[i]===n&&(r[i]=r.push(e)-1):(g.set(t,r=[e]),r[i]=0,D.autoObserveObjects&&observe(t)),e.listeningToObject=t}(r,e),{remove:function(){!function(t){if(t.listeningToObject){var e=t.listeningToObject;t.listeningToObject=null;var n=g.get(e);if(n){var r=n[t.listenerId];r>-1&&(n.splice(r,1),delete n[t.listenerId])}}}(r),--i.observerCount||i.observer.remove()},done:function(){t.deliverChanges(o),this.remove()}}})},getCollectionOf:function(){return this.collectionOf||this.returnedVariable&&this.returnedVariable.collectionOf||this.constructor.collectionOf},_sN:function(t){return this.name=t,this},get _debug(){return this.__debug===n&&(this.__debug=this.name||(Math.random()+"").slice(2)),this.__debug},set _debug(t){this.__debug=t}};function M(e,n,r,o){var s=e.key,u=e.parent;if(!u)return e.put(r,o);var a=u.getValue?u.getValue(!0):u.value;if(null!=a){if("object"!=typeof a){var f=new Error("Can not set property on non-object");throw f.deniedPut=!0,f}var c="function"==typeof a.get?a.get(s):a[s];if(c===r&&"object"!=typeof r)return i}if(!a||"function"!=typeof a.set)return O(a,function(i){if(n==p&&c&&c.put&&!r&&r.put)return c.put(r,o);if(r&&r.then&&!r.notifies)return r.then(function(t){return M(e,n,t,o)});var a=null==i?"number"==typeof s?[]:{}:u.isWritable?t.copy(i.constructor===Object?{}:i.constructor===Array?[]:Object.create(Object.getPrototypeOf(i)),i):i;a[s]=r,o=o||new S;var f=new P(s,o,e);return f.oldValue=c,f.target=e,O(a===i?u.updated(f,e):u.put(a,f),function(){e.updated(o,e)})});a.set(s,r,o),e.updated(o,e);var h=g.get(a);if(h){h=h.slice(0);for(var l=0,d=h.length;l<d;l++){var v=h[l];v!==u&&v.updated(o)}}return r}for(var C in Object.defineProperties(F,{"=":{get:function(){return this.valueOf(!0)},set:function(t){this.put(t)},enumerable:!0},_lastUpdated:{get:function(){return new Date(this.getVersion()/256+15e11)}},schema:{get:function(){if(this.returnedVariable)return this.returnedVariable.schema;if(this.parent){var t=this.parent.schema.properties||this.parent.schema;return t&&t["number"==typeof this.key?"collectionOf":this.key]}return this.constructor},set:function(t){Object.defineProperty(this,"schema",{value:t})}},validation:{get:function(){var t=new K(this);return Object.defineProperty(this,"validation",{value:t}),t},set:function(t){Object.defineProperty(this,"validation",{value:t})}}}),F)Object.defineProperty(D,C,Object.getOwnPropertyDescriptor(F,C));function U(t,e){return O(t.cachedValue||t.valueOf(!0),function(r){var i=t.valueOf(d),o=r?t.isWritable?r.slice(0):r:[];return e.call(t,o,function(e,s,u){if(e<0&&(e=o.length+e),e===o.length)var a=!0;var f=[e,s],c=o.splice.apply(o,f.concat(u)),p=t.collectionOf;if(i&&p){var h=u;(u=u.map(function(e){return(e=e instanceof p?e:p.from(e)).parent=t,e})).untypedItems=h,c=i.slice(e,s+e)}var l=new x(t,u,c,e,s);a&&(l.atEnd=!0);var d=u.length;if(d>0)for(var v=o.length-d;v>e;){var y=t[--v];y&&(t[v]=n,y.key+=d,t[y.key]=y)}return O(o===r?t.updated(l,t):t.put(o,l),function(){if(i&&(t._typedVersion=t.version,c=i.splice.apply(i,f.concat(u)),t.isWritable))for(var n=e;n<i.length;n++)i[n].key=n;return t.cachedVersion=t.version,c})})})}D.as=function(t){var e=this.with({}),n=e.prototype,r=t.prototype;do{for(var i=Object.getOwnPropertyNames(r),o=0;o<i.length;o++){var s=i[o];Object.getOwnPropertyDescriptor(n,s)||Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))}r=f(r)}while(r&&r!==D.prototype);return e},D.with=function(e,n){var r=this;return!1===Object.getOwnPropertyDescriptor(this,"prototype").writable?(n=t.extendClass(this)).prototype:(n||(n=function(){if(!(this instanceof n))return n.with(e);r.apply(this,arguments)}),(n.prototype=Object.create(this.prototype)).constructor=n,a(n,this)),n.assign(e)},D.assign=function(e){var r=this.prototype;function i(t){return"object"==typeof t?t instanceof Array?t[0]?B.of(i(t[0])):B:D.with(t):"string"==typeof t?et(t):"number"==typeof t?nt(t):"boolean"==typeof t?rt(t):"function"==typeof t?t:D}if("object"!=typeof e)return this.prototype.default=e,this;for(var o in e){var s=(a=Object.getOwnPropertyDescriptor(e,o)).value;if("function"==typeof s||this.isPrimitive||(s=i(s)).prototype.default!==n&&(r.hasOwnProperty("default")||(r.default=r.default?Object.create(r.default):{}),r.default[o]=s.prototype.default),"function"==typeof s&&"collectionOf"!==o){if(s.notifies){function u(t,e){return{get:function(){var n=(this._properties||(this._properties={}))[t];return n||(this._properties[t]=n=new e,n.key=t,n.parent=this,n.listeners&&n.init()),n},set:function(e){M(this[t],h,e)},enumerable:!0}}var a=u(o,s);Object.defineProperty(r,o,a);try{Object.defineProperty(this,o,a)}catch(t){console.warn("Unable to define property",o)}continue}if(c(s))a=pt(s);else if(s.defineAs){if(!(a=s.defineAs(o,this)))continue}else s=Q(s,o)}Object.defineProperty(r,o,a),s!==n?(o in this?Object.defineProperty(this,o,{value:s,configurable:!0,enumerable:!0}):this[o]=s,r.default):Object.defineProperty(this,o,a)}return e&&e.hasOwn&&function(e,n){var r=this.ownedClasses||(this.ownedClasses=new t.WeakMap);return r.set(e,n||function(){return new e}),this}.call(this,e.hasOwn),this},Object.defineProperty(D,"defaultInstance",{get:function(){return this.hasOwnProperty("_defaultInstance")?this._defaultInstance:(this._defaultInstance=new this,this._defaultInstance.subject=$,this._defaultInstance)}}),D.hasOwn=function(e,n){var r=new t.WeakMap;r.createInstance=n,(this.ownedClasses||(this.ownedClasses=new t.WeakMap)).set(e,r)},"undefined"!=typeof Symbol&&(D.prototype[Symbol.iterator]=function(){var t=this.valueOf(v)[Symbol.iterator](),e=this,n=this.collectionOf;if(n){var r=0;return{next:function(){var i=t.next();return i.done||(i.value=e.property(r++,n)),i}}}return t});var L=D.VMap=t.compose(D,function(t){void 0!==t&&(this.value=t)},{fixed:!0,isWritable:!1,property:function(t,e){var n=this._properties||(this._properties=new s),r=n.get(t);return r||((r=new(e||this.PropertyClass)).key=t,r.parent=this,r.listeners&&r.init(),n.set(t,r)),r}}),I=D.Transform=t.compose(D,function(t,e,r,i){if((t!==n||r)&&(this.source=t),e&&(this.transform=e,r))for(var o=1,s=r.length;o<s;o++)this["source"+o]=r[o];i&&(this.dontCache=!0)},{getTransform:function(){return this.transform&&this.transform.valueOf()},getValue:function(){if("invalidated"==this.readyState)this.readyState=b.toString();else if(isFinite(this.readyState))   ;else if((this.listeners&&"up-to-date"===this.readyState||this.staysUpdated)&&this.cachedVersion>0)return e&&(e.setVersion(this.cachedVersion),e.ifModifiedSince>=this.cachedVersion&&!this.returnedVariable)?l:this.promise||this.cachedValue;var t,r=this.readyState,i=e,o=e=e?e.newContext():new _;try{this.version&&o.setVersion(this.version),this&&this.cachedVersion==this.version&&this.cachedVersion>0&&!this.hasOwnProperty("source1")&&(o.ifModifiedSince=this.cachedVersion);for(var s,u,a,f=this.getTransform(),c=[],p=1,h=this,d=function(t){return c[this.__index||0]=t,0==--p?w():this.__previousPromiseResult},v=0;(s=this[u=v>0?"source"+v:"source"])||u in this;v++)if(s){var g=s.valueOf(y);g&&g.then?(p++,a=0===v?g.then(d):g.then(d.bind({__index:v,__previousPromiseResult:a}))):c[v]=g}else c[v]=s;if(0==--p)return w();function w(){o.ifModifiedSince!==n&&(o.ifModifiedSince=n);var e=o.version;if(h.cachedVersion>=e||c[0]==l)return i&&i.setVersion(e),i&&i.ifModifiedSince>=e&&i.ifModifiedSince>=h.cachedVersion&&!h.returnedVariable?l:h.promise||p(h.cachedValue);var s=f?f.apply(h,c):c[0],u=s&&s.then&&!s.notifies;if(e=o.version,u){h.promise&&h.promise.abort&&(h.promise.replacedResolutionWith=s,h.promise.abort("Cancelled due to updated value being available")),h.readyState!==r||h.dontCache||(h.cachedVersion=e);var a=h.promise=s=s.then(function(t){return a===h.promise&&(h.promise=null,d(t,o.version)),t},function(t){if(a===h.promise)h.promise=null,h.lastError=t,d(null,0);else if(a.replacedResolutionWith)return a.replacedResolutionWith;throw t})}else d(s,e);return p(s);function p(e){return t&&e&&e.notifies?{__variable:e}:e}function d(t,e){h.readyState!==r||h.dontCache||(i&&i.setVersion(e),h.cachedVersion=e,h.cachedValue=t,h.readyState=(h.listeners||h.staysUpdated||i&&i.notifies)&&0!==e?"up-to-date":"")}}return t=!0,a.abort&&(a.abort=null),a}finally{i&&i.setVersion(o.version),e=i}},forDependencies:function(t){var e,n;D.prototype.forDependencies.call(this,t);for(var r=0;(e=this[n=r>0?"source"+r:"source"])||n in this;r++)e&&e.notifies&&t(e)},updated:function(t,e,n){if(this.readyState="invalidated",this.promise&&!this.promise.abort&&(this.cachedVersion>0&&(this.cachedVersion=0),this.promise=null),e!==this.returnedVariable&&t&&"replaced"!==t.type)for(var r,i,o=0;(r=this[i=o>0?"source"+o:"source"])||i in this;o++)r!==e||(t=new S(t));return D.prototype.updated.call(this,t,e,n)},cleanup:function(){"up-to-date"!==this.readyState||this.staysUpdated||(this.readyState=""),D.prototype.cleanup.call(this)},getUpdates:function(t){if(!t||t.version<getVersion())return[new S]},getArguments:function(){for(var t,e,n=[],r=0;(t=this[e=r>0?"source"+r:"source"])||e in this;r++)n.push(t);return n},put:function(t,e){var n=this;return function(t,e){return t&&t.then&&!t.notifies?t.then(e):e(t)}(this.getValue(),function(r){if(r===t&&"object"!=typeof t)return i;var o=n.transform.valueOf();if(o.reverse)return o.reverse.call(n,t,n.getArguments()),n.updated(e);if(r&&r.put)return r.put(t,e);var s=new Error("Can not put value into a one-way transform, that lacks a reversal");throw s.deniedPut=!0,s})},setReverse:function(t){return this.transform.valueOf().reverse=t,this}});Object.defineProperty(I.prototype,"isWritable",{get:function(){return this.transform&&!!this.transform.reverse}}),WhileResolving=t.compose(I,function(t,e,r){this.source=t,e!==n&&(this.default=e),r&&(this.useLastValue=!0)},{fixed:!0,getValue:function(){var t=I.prototype.getValue.call(this);if(t&&t.then){var e=this.version,n=this;return t.then(function(t){e===n.version&&(D.prototype.updated.call(n),n.cachedVersion=n.version)},function(t){console.error("Variable resolution failed",t),e===n.version&&(D.prototype.updated.call(n),n.cachedVersion=n.version,n.cachedValue="Error occurred: "+t,n.readyState="up-to-date")}),this.useLastValue&&"cachedValue"in this?this.cachedValue:this.default}return t},put:function(t,e){return this.source.put(t,e)}});var N=t.compose(I,function(){I.apply(this,arguments)},{getValue:function(){var t=e?e.getContextualized(this):this;return t&&t!==this?t.getValue():I.prototype.getValue.call(this)},_needsContextualization:!0}),k=t.compose(D,function(t,e){this.value=t,this.collection=e},{}),R=t.compose(D,function(t,e){this.generic=t,this.subject=e},{valueOf:function(){var t=this.subject,e=t.getContextualized?t:new _(t),n=this.generic;return e.executeWithin(function(){return n.valueOf()})},forDependencies:function(t){this.sources&&this.sources.forEach(t)},getVersion:function(){for(var t=D.prototype.getVersion.call(this),e=this.sources||0,n=0,r=e.length;n<r;n++){var i=e[n];i.getFullVersion&&(t=Math.max(t,i.getFullVersion()))}return t},put:function(t,e){return this.subject,this.generic.put(t,e)}}),B=t.compose(D,function t(e){return z(this,e,t)},{valueOf:function(t){var e=D.prototype.valueOf.call(this,t),n=this;return O(e,function(e){if(t&&t.getTyped){if(!t.allowUntyped)return;if(!e)return[]}else if(!e)return t&&t.ensureValidType?[]:e;if(n.sortFunction&&n._sortedArray!=e){var r=n.reversed,i=n.sortFunction;n.sortFunction=null,e=n.sort(i),r&&n.reversed()}return e})},forEach:function(t,e){return O(this.valueOf(v),function(n){n.forEach(t,e)})},splice:function(t,e){var n=arguments;return U(this,function(r,i){return i(t,e,[].slice.call(n,2))})},push:function(){var t=arguments;return U(this,function(e,n){return O(n(e.length,0,[].slice.call(t)),function(t){return e.length})})},unshift:function(){var t=arguments;return U(this,function(e,n){return O(n(0,0,[].slice.call(t)),function(t){return e.length})})},pop:function(){return U(this,function(t,e){return O(e(t.length-1,1,[]),function(t){return t[0]})})},shift:function(){return U(this,function(t,e){return O(e(0,1,[]),function(t){return t[0]})})},sort:function(t){var e=this;return O(this.valueOf(!0),function(n){var r,i=e.valueOf(d);if(n||(r=n=[]),i){for(var o=[],s=n.length,u=0;u<s;u++)o.push({typed:i[u],untyped:n[u]});o.sort(function(e,n){return t(e.typed,n.typed)}),n.splice(0,n.length),n.push.apply(n,o.map(function(t){return t.untyped})),e._typedArray=o.map(function(t){return t.typed})}else n.sort(t);return e.source&&(e.sortFunction=t,e._sortedArray=n,e.reversed&&(e.reversed=!1)),r?e.put(r):e.updated(),e.cachedVersion=e.version,e._typedArray&&(e._typedVersion=e.version),n})},reverse:function(){var t=this;return O(this.valueOf(v),function(e){return e.reverse(),t.source&&(t.reversed=!t.reversed),t.updated(),e})},slice:function(t,e){return O(this.valueOf(!0),function(n){return(n||[]).slice(t,e)})},indexOf:function(t){var e=this.valueOf(v);return e.indexOf(t)},includes:function(t){return this.indexOf(t)>-1},for:function(t){if(this.source)return this.source.for(t);var e=this.indexOf(t),n=this.valueOf(),r=this.collectionOf.from(n[e]||{});return r.id=t,r},add:function(t){-1===this.indexOf(t)&&this.push(t)},delete:function(t){var e=this.indexOf(t);return e>-1&&this.splice(e,1),this},clear:function(){this.is([])},has:function(t){return this.indexOf(t)>-1}});function H(t){var e=[];return t.forEach&&t.forEach(function(t){e.push(t)}),e}Object.defineProperty(B.prototype,"length",{get:function(){if("function"!=typeof this){var t=this._properties||(this._properties={});if(!t.length){var e=t.length=new nt;return e.key="length",e.parent=this,Object.defineProperty(this,"length",{configurable:!0,value:e}),e}}},configurable:!0,set:function(t){this.value.length=t}}),B.of=function(t){var e=ot({collectionOf:t});return this!==B?new e:e};var q=t.compose(I,function(t){this.generator=t},{transform:{valueOf:function(){var t,r=e;return function e(){var i,o,s,u;if(t){if(s=t.iterator,o=t.i,(i=t.value)&&i.then)throw new Error("Generator resumed with promise or variable",i);u=t.isThrowing}else r&&r.restart(),o=0,s=this.generator();for(;;){var a=s[u?"throw":"next"](i);if(a.done){for(var f=this.sources||[],p=o,h=[];this[l=o>0?"source"+o:"source"];)this[l]=n,o++;for(o=0;o<p;o++){var l=o>0?"source"+o:"source";this[l]&&this[l].notifies&&h.push(this[l])}for(o=0;o<f.length;o++)-1==h.indexOf(f[o])&&f[o].stopNotifies(this);return this.sources=h,a.value}i=a.value;try{var l=o>0?"source"+o:"source";if(this[l]===i&&this[l]!==n||(i&&i.notifies?(this.listeners&&i.notifies(this),this[l]=i):"function"==typeof i&&c(i)?(t={i:o,iterator:i()},e.call(this),o=t.i):this[l]=null),o++,i&&i.then){var d=this;t={i:o,iterator:s};var v=null,y=i.then(function(n){return!1!==v?(v=!0,void(i=n)):(t.value=n,r?r.executeWithin(e.bind(d)):e.call(d))},function(n){return t.value=n,t.isThrowing=!0,r?r.executeWithin(e.bind(d)):e.call(d)});if(!v)return v=!1,y}u=!1}catch(t){u=!0,i=t}}}}}}),K=t.compose(I,function(t){this.source=t},{transform:function(t){var t=this.source;return t&&t.validate(t,t.schema)}});function z(t,e,n){if(!(t instanceof D))return n.with(e);D.call(t,e)}var Y={apply:function(t,e){return e},reverse:function(t,e){return e.map(function(e,n){return e.put(t[n])})}};function Z(t,e){if(t instanceof Array){var n="function"==typeof e;return t.length>0||n?new I(t[0],n?e:Y,t,!n):new B([])}if(arguments.length>1)return new I(arguments[0],Y,arguments,!0).as(B);if("object"==typeof t){var r=[],i=[];for(var o in t)r.push(o),i.push(t[o]);return new D(function(t){for(var e={},n=0;n<t.length;n++)e[r[n]]=t[n];return e}).apply(null,i)}throw new TypeError("Variable.all requires an array")}function J(t,e,n){return"function"==typeof t.value?{value:Q(n,e)}:t}function Q(t,e){var n=t[e]=function(){var n=t.for(this);return n[e].apply(n,arguments)};return n.for=function(n){var r=t.for(n);return function(){return r[e].apply(r,arguments)}},n}var $={name:"Default context",description:"This object is the default context for classes, corresponding to a singleton instance of that class",constructor:{getForClass:function(t,e){return e.defaultInstance}},contains:function(){return!0}};function G(t,e){if(!e)return t.defaultInstance;var n=e.specify(t);return e.instanceMap||(e.instanceMap=new s),e.instanceMap.set(t,n),n}D.valueOf=function(t){return G(this,e).valueOf(t)},D.then=function(t,n){return G(this,e).then(t,n)},D.getValue=function(t){return G(this,e).getValue(t)},D.put=function(t){return G(this,e).put(t)},D.for=function(t){var e;return null!=t?"object"!=typeof t?this.collection.for(t):(t.target&&!t.constructor.getForClass&&(t=t.target),(e=new _(t).specify(this))&&!e.subject&&(e.subject=t),e||this.defaultInstance):this.defaultInstance},D.from=function(e){if(e&&"object"==typeof e){var n=this.instanceMap||(this.instanceMap=new t.WeakMap),r=n.get(e);return r||n.set(e,r=new this(e)),r}return new this(e)},D.notifies=function(t){var n=G(this,e);return n.notifies(t),n},D.stopNotifies=function(t){this.defaultInstance.stopNotifies(t)},D.getCollectionOf=function(){return this.collectionOf},D.updated=function(t,n){return G(this,e).updated(t,n)},D._Transform=N,["add","delete","clear","filter","map","forEach","slice","push","splice","pop","shift","unshift"].forEach(function(t){D[t]=function(){return this.collection[t].apply(this.collection,arguments)},B[t]=B.prototype[t]}),D.default=function(t){return D.with({default:t})};var X={get:function(t,e){var r=t[e];return r===n?t.property(e):r},set:function(t,e,n){var r=t[e];return r&&r.put?r.put(n):t.set(e,n),!0},has:function(t,e){return e in t||e in t.valueOf()},deleteProperty:function(t,e){return X.set(t,e,n)},ownKeys:function(t){return Object.getOwnPropertyNames(t.valueOf())}};function E(){}function tt(){}function et(t){return z(this,"object"==typeof t||t===n?t:String(t),et)}function nt(t){return z(this,"object"==typeof t||t===n?t:Number(t),nt)}function rt(t){return z(this,"object"==typeof t?t:Boolean(t),rt)}function it(e){return z(this,e instanceof Array?new t.Set(e):e,it)}D.proxy=function(t){return new Proxy(t instanceof this?t:this.from(t),X)},Object.defineProperty(D,"collectionOf",{get:function(){return this._collectionOf},set:function(t){this._collectionOf!=t&&(this._collectionOf=t,t.collection=this)}}),Object.defineProperty(D,"collection",{get:function(){return this.hasOwnProperty("_collection")?this._collection:(this.collection=new ot,this.collection.fixed=!0,this.collection)},set:function(t){this.hasOwnProperty("_collection")&&this._collection==t||(this._collection=t,t.collectionOf=this)}}),D.generalize=function(){for(var t=this.prototype,e=Object.getOwnPropertyNames(t),n=0,r=e.length;n<r;n++){var i=e[n];Object.defineProperty(this,i,J(Object.getOwnPropertyDescriptor(t,i),i,this))}},D.call=Function.prototype.call,D.apply=Function.prototype.apply,E.returns=function(t){function e(){}return e.defineAs=function(e){return{value:function(){var r=arguments;return new t(new I(this,function(t){return null==t?n:t[e].apply(t,r)}))},writable:!0,configurable:!0}},e},tt.defineAs=function(t){return{value:function(){var e=arguments,n=this;return O(this.valueOf(),function(r){r&&r[t]||(r=new n.constructor.wrapsType(r));var i=r[t].apply(r,e);return O(n.put(r),function(){return i})})},writable:!0,configurable:!0}},(et=D.with({charAt:E.returns(et),codeCharAt:E.returns(nt),indexOf:E.returns(nt),lastIndexOf:E.returns(nt),match:E.returns(B),replace:E.returns(et),substr:E.returns(et),slice:E.returns(et),toUpperCase:E.returns(et),toLowerCase:E.returns(et),replace:E.returns(et),toString:function(){return this.valueOf()||""}},et)).prototype.type="string",et.isPrimitive=!0,(nt=D.with({toFixed:E.returns(et),toExponential:E.returns(et),toPrecision:E.returns(et),toLocaleString:E.returns(et)},nt)).prototype.type="number",nt.isPrimitive=!0,(rt=D.with({},rt)).prototype.type="boolean",rt.isPrimitive=!0,it=D.with({has:function(t){return this.to(function(e){return e&&e.has?e.has(t):!(!e||!e.indexOf)&&e.indexOf(t)>-1}).as(rt)},add:tt,clear:tt,delete:tt},it),Object.defineProperty(it.prototype,"array",{get:function(){return this._array||(this._array=this.to(H).as(B))}}),it.wrapsType=t.Set;var ot=t.compose(B,function t(e){return z(this,e,t)},{valueOf:function(t){var n=e,r=e=e?e.newContext():new _,i=D.prototype.valueOf.call(this,t);r.setVersion(this.version);var o=this;try{return O(i,function(e){if(!t||!t.getTyped)return e;if(!e)return[];var n=o.getCollectionOf();if(!n||o._typedArray&&o._typedVersion>=r.version||(o._typedArray=e.map(function(t,e){return t instanceof n||((t=n===D?at.reactive(t):n.from(t)).parent||(t.parent=o),o.isWritable&&(t.key=e)),t}),o._typedVersion=r.version),e=o._typedArray||t.allowUntyped&&e,o.sortFunction&&o._sortedArray!=e){var i=o.reversed,s=o.sortFunction;o.sortFunction=null,e=o.sort(s),i&&o.reversed()}return e})}finally{n&&n.setVersion(r.version),e=n}},property:function(t,e){if(this._typedArray){var n=this._typedArray[t];return n.key=t,n}return D.prototype.property.call(this,t,e||"number"==typeof t&&this.collectionOf)},indexOf:function(t){var e=this.valueOf()||[],n=this.collectionOf;if(n.prototype.getId){for(var r=t&&t.getId?t.getId():t,i=0,o=e.length;i<o;i++)if(e[i].getId()==r)return i;return-1}return e.indexOf(t&&t.valueOf())}});function st(t){return z(this,"object"==typeof t?t:new Date(t),st)}(st=D.with({toDateString:E.returns(et),toTimeString:E.returns(et),toGMTString:E.returns(et),toUTCString:E.returns(et),getTime:E.returns(nt),setTime:tt},st)).wrapsType=Date;var ut=t.compose(D,function t(e){return z(this,e,t)},{valueOf:function(){return this.then()}}),at={__esModule:!0,Variable:D,VArray:B,default:D,VString:et,VNumber:nt,VBoolean:rt,VPromise:ut,VDate:st,VSet:it,VMap:L,GeneratorVariable:q,Transform:I,deny:{},noChange:i,Context:_,Item:k,NotifyingContext:m,all:Z,react:function(t,e){if("function"!=typeof t)throw new Error("react() must be called with a generator.");return e&&e.reverse&&(t.reverse=e.reverse),new q(t)},delayUpdate:function(t,e){var n=t.updated;t.updated=function(){var t=n.apply(this,arguments);t.visited.enqueueUpdate=function(t){e.then(t)}}},objectUpdated:function(t){var e=g.get(t);if(e)for(var n=0,r=e.length;n<r;n++)e[n]._propertyChange(null,t)},NOT_MODIFIED:l,_changeValue:M,getNextVersion:function(){var t=256*(Date.now()-15e11);return t>b&&(b=t),b++},ReplacedEvent:S,AddedEvent:A,DeletedEvent:V,UpdateEvent:j};Object.defineProperty(at,"currentContext",{get:function(){return e},set:function(t){e=t}});var ft=t.compose(I,function(t,e){},{transform:function(){var t=this.source.valueOf(v),e=this.method;return"string"==typeof e?this.hasOwnProperty("source2")?[][e].call(t,this.source1.valueOf(),this.source2):[][e].call(t,this.source1.valueOf()):e(t,[this.source1.valueOf(),this.source2])},_mappedItems:function(t){var e=this.source,n=e&&e.collectionOf;return n?t.map(function(t,r){var i=n.from(t);return i.collection=e,i}):t},slice:function(t,e){return O(this.valueOf(!0),function(n){return n.slice(t,e)})},getCollectionOf:function(){return this.source.getCollectionOf()}});function ct(e,n,r,i,o){var s=t.compose(i?i.as(ft):ft,n,r);s.prototype.method||(s.prototype.method=e),Object.defineProperty(s.prototype,"isIterable",{value:!0}),(o=o||B)[e]=o.prototype[e]=function(t,e){var n=new s(this);return n.source=this,n.source1=t,e&&(n.source2=e),n}}ct("filter",function(t){},{updated:function(t,n,r){if(!t||t.modifier===this||t.modifier&&t.modifier.constructor===this)return I.prototype.updated.call(this,t,n);var i=e&&e.getContextualized(this)||this,o=this.source1.valueOf();if("spliced"!==t.type){if("entry"===t.type){var s=t.value,u=i.cachedValue.indexOf(s),a=[s].filter(o).length>0;if(u>-1){if(a)return D.prototype.updated.call(this,t,n,r);U(i,function(t,e){e(u,1,[])})}else a&&U(i,function(t,e){e(t.length,0,[s])});return}return I.prototype.updated.call(this,t,n,r)}for(var f=[],c=t.items,p=0;p<c.length;p++)o.call(c,c[p],p)&&(c.untypedItems?f.push(c.untypedItems[p]):f.push(c[p]));var h,l,d=t.removed.filter(o);if(d.length>1)return I.prototype.updated.call(this,new S(t));if(1==d.length){if(!d[0].parent)return I.prototype.updated.call(this,new S(t));h=i.cachedValue.indexOf(d[0]),l=1}else h=t.atEnd?i.cachedValue.length:0,l=0;U(i,function(t,e){e(h,l,f)})},transform:function(){var t=this.source.valueOf(v),e=this.source,n=[],r=this.source1.valueOf();return O(t,function(t){var i=e.valueOf();return t.forEach(function(t,e){r(t,e)&&n.push(i[e])},this.source2),n})},push:function(t){return this.source.push.apply(this.source,arguments)},unshift:function(t){return this.source.unshift.apply(this.source,arguments)},pop:function(t){return O(this.valueOf(),function(t){return t.length&&this.source.remove(t[t.length-1])})},shift:function(t){return O(this.valueOf(),function(t){return t.length&&this.source.remove(t[0])})},splice:function(t){throw new Error("Not supported yet")},getCollectionOf:function(){return this.source.getCollectionOf()}},ot),ct("map",function(t){},{updated:function(t,n,r){if(!t||t.modifier===this||t.modifier&&t.modifier.constructor===this)return D.prototype.updated.call(this,t,n);var i=e&&e.getContextualized(this)||this;if("spliced"===t.type)this.splice.apply(this,[t.start,t.deleteCount].concat(t.items.map(this.source1.valueOf())));else if("property"===t.type){if(this.getCollectionOf())return;var o=t.parent.valueOf(),s=i.cachedValue,u=t.key;if(t.value,u>-1?o[u]:u=s&&s.map&&s.indexOf(o),!(u>-1))return I.prototype.updated.call(this,t,n,r);i.splice(u,1,this.source1.valueOf().call(this.source2,this.source.property(u)))}else{if("entry"!==t.type)return I.prototype.updated.call(this,t,n,r);if(this.getCollectionOf())return}}},B),ct("reduce",function(){}),ct("reduceRight",function(){}),ct("some",function(){},{},rt),ct("every",function(){},{},rt),ct("join",function(){},{},et),ct("keyBy",function(t,e){},{property:L.prototype.property,method:function(t,e){for(var n=new s,r=e[0],i=e[1],o="function"==typeof r,u="function"==typeof i,a=!!r,f=0,c=t.length;f<c;f++){var p=t[f];n.set(o?r(p,h):a?p[r]:p,u?i(p):p)}function h(t,e){n.set(t,e)}return n}}),ct("groupBy",function(t,e){},{property:L.prototype.property,method:function(t,e){for(var n=new s,r=e[0],i=e[1],o="function"==typeof r,u="function"==typeof i,a=!!r,f=0,c=t.length;f<c;f++){var p=t[f],h=o?r(p):a?p[r]:p,l=n.get(h);l||n.set(h,l=[]),l.push(u?i(p):p)}return n}});var pt=D.getGeneratorDescriptor=function(e){var n;return{get:function(){n||(n=new t.WeakMap);var r=n.get(this);return r||n.set(this,r=new q(e.bind(this))),r},enumerable:!0}};D.all=Z,D.Context=_;var ht=void 0!==r?r:window;return(ht.devtoolsFormatters||(ht.devtoolsFormatters=[])).push({header:function(t,e){if(t&&t instanceof D){var n=Object.assign({},t);n[Symbol.toStringTag]=t.constructor.name;var r=t.version/256+15e11;return["span",{},"","invalidated"===t.readyState?" invalidated ":"object"==typeof t.valueOf()?["object",{object:t.valueOf()}]:["span",{}," = "+t],["object",{object:n}],["span",{}," ("+(t.version?new Date(r)[Date.now()-r>3e7?"toLocaleString":"toLocaleTimeString"]():"")+(t.listeners?" live)":")")]]}return null},hasBody:function(t){return!1},body:function(t){var e=t.version/256+15e11,n=["div",{},["div",{},"version: "+(e&&new Date(e).toLocaleString())],["div",{},"readyState: "+t.readyState]];t.valueOf()&&n.push(["div",{},["object",{object:t.valueOf()}],"(value)"]),t.listeners&&n.push(["div",{},["object",{object:t.listeners}],"(listeners)"]);for(var r=0;t["source"+(r||"")];)n.push(["div",{},["object",{object:t["source"+(r||"")]}],["div",{float:"left"},"(source "+r+")"]]),r++;return n}}),at})?i.apply(e,o):i)||(t.exports=s)}).call(this,n(2))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r,i,o;i=[n(0),n(1)],void 0===(o="function"==typeof(r=function(t,e){"undefined"!=typeof document&&document;var n,r,i=[],o=1,s=t.requestAnimationFrame,u=e.Context;function a(t){var e=t.variable;if(this.variable=e,t.selector&&(this.selector=t.selector),t.getElements)this.getElements=t.getElements;else{if(!t.element)throw new Error("No element provided to Renderer");var n=this.element=t.element;(n.alkaliRenderers||(n.alkaliRenderers=[])).push(this)}if(t.update&&(this.updateRendering=t.update),t.shouldRender&&(this.shouldRender=t.shouldRender),t.renderUpdate&&(this.renderUpdate=t.renderUpdate),t.alwaysUpdate&&(this.alwaysUpdate=t.alwaysUpdate),!1===t.updateOnStart){var r=this.contextualized||this.variable;this.variable.valueOf(this),r.notifies(this)}else n?this.updateRendering(!0):this.variable.notifies(this)}function f(t){a.call(this,t)}function c(t){t.name&&(this.name=t.name),f.apply(this,arguments)}function p(t){t.name&&(this.name=t.name),f.apply(this,arguments)}function h(t){t.element&&"SELECT"===t.element.tagName&&"value"===t.name&&(this.renderUpdate=this.renderSelectValueUpdate),p.apply(this,arguments)}function l(t){t.name&&(this.name=t.name),f.apply(this,arguments)}function d(t){f.apply(this,arguments)}function v(t){this.position=t.position,this.textNode=t.textNode,f.apply(this,arguments)}function y(t){t.each&&(this.each=t.each),f.apply(this,arguments)}function g(t){if(t.alkaliRenderers)for(var e=t.alkaliRenderers,n=0;n<e.length;n++){var r=e[n];r.variable.stopNotifies(r)}}return a.prototype={constructor:a,version:0,notifies:!0,updateRendering:function(){throw new Error("updateRendering must be implemented by sub class of Renderer")},updated:function(e,n,r){if(!this.invalidated){if(this.getElements){this.variable;var i=this.invalidated||(this.invalidated=new t.Set);this.getElements().forEach(function(t){e.doesAffect&&!e.doesAffect(t)||i.add(t)})}else this.invalidated=!0;this.deferredRender&&(this.deferredRender.isCanceled=!0,this.deferredRender=null);var o=this;(e.visited.enqueueUpdate||s)(function(){!0===o.invalidated?o.updateRendering(o.alwaysUpdate,o.element):o.invalidated&&o.invalidated.forEach(function(t){o.updateRendering(o.alwaysUpdate,t)})})}},executeWithin:u.prototype.executeWithin,setVersion:function(){},newContext:function(){return new u(this.element,!0)},getContextualized:function(t){return u.prototype.getContextualized.call(this,t)},specify:function(t){return this.contextualized=u.prototype.specify.call(this,t)},merge:function(){},contextMatches:function(t){return!0},invalidateElement:function(e){n||(n=new WeakMap(null,"invalidated"));var o=n.get(e);n.set(e,o={}),o[id]||(o[id]=!0),r||(t.queueTask(processQueue),r=!0);var s=this;i.push(function(){s.invalidated=!1,s.updateElement(e)})},getId:function(){return this.id||(this.id=o++)},stop:function(){(this.contextualized||this.variable).stopNotifies(this),this.builtList&&(this.builtList=!1,this.omitValueOf=!1)},restart:function(){this.updateRendering(!0)},isSameProperty:function(t){return t.constructor===this.constructor&&t.name===this.name}},Object.defineProperty(a.prototype,"subject",{get:function(){return this.element}}),f.prototype=Object.create(a.prototype),f.prototype.shouldRender=function(t){return document.body.contains(t)},f.prototype.getSubject=function(){return this.element},f.prototype.updateRendering=function(t,e){if(!e&&this.elements){var n=this.elements;if(!n.length){if(!this.selector)throw new Error("No element or selector was provided to the Renderer");return void(n=document.querySelectorAll(this.selector))}for(var r=0,i=n.length;r<i;r++)this.updateRendering(t,n[r])}else{var o=e||this.element;if(t||this.shouldRender(o))this.updateElement(o);else{var s=this.getId(),u=o.renderersOnShow;u||(u=o.renderersOnShow=[],o.className+=" needs-rerendering"),u[s]||(u[s]=this)}}},f.prototype.addElement=function(t){this.selector?t.renderersOnShow=[this]:this.elements.push(t),this.updateElement(t)},f.prototype.updateElement=function(t){if(this.invalidated=!1,this.omitValueOf)return this.started=!0,void this.renderUpdate(void 0,t);var e,n,r=t.constructor._generalized,i=t===this.element?this:Object.create(this,{element:{value:t}});if(i.executeWithin(function(){n=i.variable.then(function(o){if(e=!0,!(n&&(n===i.deferredRender&&(i.deferredRender=null),n.isCanceled)||i.invalidated)){if(i.contextualized&&i.contextualized!==i.variable&&i.contextualized.stopNotifies(i),r){var s=i.toString();r[s]||(r[s]=!0,(i.contextualized=i.variable).notifies(i))}else i.executeWithin(function(){i.contextualized=i.variable.notifies(i)});(void 0!==o||i.started)&&(i.started=!0,i.renderUpdate(o,t))}},function(t){console.error("Error rendering",i,t)})}),!e){if(r){var o=i.toString();r[o]||(r[o]=!0,(i.contextualized=i.variable).notifies(i))}else i.executeWithin(function(){i.contextualized=i.variable.notifies(i)});this.deferredRender=n,this.renderLoading&&this.renderLoading(n,t)}},f.prototype.renderUpdate=function(t,e){throw new Error("renderUpdate(newValue) must be implemented")},a.Renderer=a,a.ElementRenderer=f,c.prototype=Object.create(f.prototype),c.prototype.type="AttributeRenderer",c.prototype.renderUpdate=function(t,e){"boolean"==typeof t||null==t?t?e.setAttribute(this.name,""):e.removeAttribute(this.name):e.setAttribute(this.name,t)},a.AttributeRenderer=c,p.prototype=Object.create(f.prototype),p.prototype.type="PropertyRenderer",p.prototype.renderUpdate=function(t,e){e[this.name]=t},a.PropertyRenderer=p,h.prototype=Object.create(p.prototype),h.prototype.type="InputPropertyRenderer",h.prototype.renderUpdate=function(t,e){(null==t||"number"===e.type&&isNaN(t))&&(t="");var n=e[this.name];"string"==typeof n&&"string"!=typeof t&&(t=null==t?"":String(t)),n!=t&&(e[this.name]=t)},h.prototype.renderSelectValueUpdate=function(e,n){n.value=e,n.value==e||n.value?n.eventualValue=void 0:(n.eventualValue=e,t.nextTurn(function(){n.eventualValue&&(n.value=n.eventualValue,n.eventualValue=void 0)}))},a.InputPropertyRenderer=h,l.prototype=Object.create(f.prototype),l.prototype.type="StyleRenderer",l.prototype.renderUpdate=function(t,e){e.style[this.name]=t},a.StyleRenderer=l,d.prototype=Object.create(f.prototype),d.prototype.type="ContentRenderer",d.prototype.renderUpdate=function(t,e){e.innerHTML="",void 0===t&&(t=""),e.appendChild(document.createTextNode(t))},a.ContentRenderer=d,v.prototype=Object.create(f.prototype),v.prototype.type="TextRenderer",v.prototype.updated=function(t,e){this.builtList&&("replaced"===t.type?(this.builtList=!1,this.omitValueOf=!1):(this.updates||(this.updates=[])).push(t)),f.prototype.updated.call(this,t,e)},v.prototype.renderUpdate=function(t,e){null==t&&(t=""),t.create&&(t=t.create({parent:e})),t.nodeType?(this.textNode&&this.textNode.parentNode==e?e.replaceChild(t,this.textNode):e.appendChild(t),this.textNode=t):t instanceof Array?(this.renderUpdate=y.prototype.renderUpdate,this.omitValueOf=!0,this.renderUpdate(t,e)):(this.textNode||e.childNodes[this.position]).nodeValue=t},a.TextRenderer=v,y.prototype=Object.create(f.prototype),y.prototype.updated=function(t,e){this.builtList&&("replaced"===t.type?(this.builtList=!1,this.omitValueOf=!1):(this.updates||(this.updates=[])).push(t)),f.prototype.updated.call(this,t,e)},y.prototype.type="ListRenderer",y.prototype.renderUpdate=function(t,e){var n=this.each||function(t){return t},r=this.element,i=this;if(this.builtList){s=this.childElements;var o=this.updates||[{type:"replaced"}];o.forEach(function(t){if("replaced"===t.type){i.builtList=!1;for(var e=0,n=s.length;e<n;e++)r.removeChild(s[e]);i.updateElement(r)}else if("spliced"===t.type){for(t.start,e=0;e<t.deleteCount;e++)r.removeChild(s[t.start+e]);for(s.splice(t.start,t.deleteCount),e=0;e<t.items.length;e++){var o=t.items[e],u=s[e+t.start],f=a.append(r,c(o));u?(r.insertBefore(f,u),s.splice(e+t.start,0,f)):s.push(f)}}else t.type}),this.updates=[]}else{this.builtList=!0,this.omitValueOf=!0,e.innerHTML="";var s=this.childElements=[];if(n.defineHasOwn&&n.defineHasOwn(),t){var u=function(t){s.push(a.append(r,c(t)))},f=this.variable;f.collectionOf?this.executeWithin(function(){f.forEach(u)}):t.forEach(u)}(this.contextualized||this.variable).notifies(this)}function c(t){var e;return n.create?e=n.create({parent:r,_item:t}):(e=n(t,r))&&e.create&&(e=e.create({parent:r,_item:t})),e}},a.ListRenderer=y,a.onShowElement=function(t){s(function(){n=null;var e=[].slice.call(t.getElementsByClassName("needs-rerendering"));if(t.className.indexOf("needs-rerendering")>0){var r=[t];r.push.apply(r,e),e=r}for(var i=0,o=e.length;i<o;i++){var s=e[i],u=s.renderersOnShow;if(u)for(var a in s.renderersOnShow=null,s.className=s.className.replace(/\s?needs\-rerendering\s?/g,""),u){var f=u[a];f.omitValueOf&&(f.omitValueOf=!1),f.updateElement(s)}}})},a.onElementRemoval=function(t,e){e||g(t);for(var n=t.getElementsByTagName("*"),r=0,i=n.length;r<i;r++){var o=n[r];o.alkaliRenderers&&g(o)}},a})?r.apply(e,i):r)||(t.exports=o)},function(t,e,n){var r,i,o;i=[n(1)],void 0===(o="function"==typeof(r=function(t){var e=t.VBoolean,n=t.VNumber,r={},i={};function o(t){return r[t]||(r[t]=new Function("a","b","return "+t))}function s(e,n,r,s,u,a,f){var c=function(t,e){var n,r=e[0],i=e[1];if(r&&r.put)try{return r.put(a(t,i&&i.valueOf()))}catch(t){if(!t.deniedPut)throw t;n=t}if(!i||!i.put)throw n&&n.message?n:new Error("Can not assign change value to constant operators");i.put(f(t,r&&r.valueOf()))},p={apply:function(n,r){return u=o(u),a=a&&o(a),f=f&&o(f),u.reverse=c,i[e]=p=new t.Variable(u),h(p),r=Array.prototype.slice.call(r),p.apply(n,r)}};function h(t){t.precedence=s,t.infix=!1!==f}h(p),i[e]=p,i[r]=function(){var t=p.apply(null,arguments);return n?t.as(n):t}}return s("+",n,"add",6,"a+b","a-b","a-b"),s("-",n,"subtract",6,"a-b","a+b","b-a"),s("*",n,"multiply",5,"a*b","a/b","a/b"),s("/",n,"divide",5,"a/b","a*b","b/a"),s("?",null,"if",16,"b[a?0:1]","a===b[0]||(a===b[1]?false:(function(){throw new Error()})())","[a,b]"),s(":",null,"choose",15,"[a,b]","a[0]?a[1]:(function(){throw new Error()})()","a[1]"),s("!",e,"not",4,"!a","!a",!1),s("%",n,"remainder",5,"a%b"),s(">",e,"greater",8,"a>b"),s(">=",e,"greaterOrEqual",8,"a>=b"),s("<",e,"less",8,"a<b"),s("<=",e,"lessOrEqual",8,"a<=b"),s("===",e,"strictEqual",9,"a===b"),s("==",e,"equal",9,"a==b"),s("&",e,"and",8,"a&&b"),s("|",e,"or",8,"a||b"),s("nint",n,"round",8,"Math.round(a*Math.pow(10,b||1)/Math.pow(10,b||1))","a","a"),i})?r.apply(e,i):r)||(t.exports=o)},function(t,e,n){(function(r){var i,o,s;o=[n(6),n(3),n(7),n(8),n(4),n(1),n(0),n(9)],void 0===(s="function"==typeof(i=function(t,e,n,i,o,s,u,a){var f=Object.create(t);f.Copy=i,f.Element=t,u.copy(f,s),Object.defineProperty(f,"currentContext",Object.getOwnPropertyDescriptor(s,"currentContext")),f.reactive=n,u.copy(f.react,n),f.spawn=u.spawn,f.when=u.when,f.Renderer=e.ElementRenderer,u.copy(f,e),u.copy(f,o),f.ContextualPromise=a,f.default=n;var c="undefined"==typeof window?r:window;return c.alkali&&console.warn("Multiple instances of alkali have been defined, which can cause alkali context instances to be out of sync"),c.alkali=f})?i.apply(e,o):i)||(t.exports=s)}).call(this,n(2))},function(t,e,n){var r,i,o;i=[n(0),n(3),n(1)],void 0===(o="function"==typeof(r=function(t,e,n){var r,i=n.Variable,o=/^(\.|#)([-\w]+)(.+)?/,s=t.isGenerator,u=n.Context,a=e.PropertyRenderer,f=e.InputPropertyRenderer,c=e.AttributeRenderer,p=t.compose(e.StyleRenderer,function(){e.StyleRenderer.apply(this,arguments)},{renderUpdate:function(t,e){var n=T[this.name];n?n(e,t,this.name):-1==this.name.indexOf("-")?cssRule.style[this.name]=t:cssRule.setProperty(this.name,t)}}),h="undefined"!=typeof Reflect?Reflect.construct:function(t,e,n){return t.apply(Object.create(n.prototype),e)},l=t.constructOrCall,d=t.compose(e.ElementRenderer,function(t){this.name=t.name,e.apply(this,arguments)},{renderUpdate:function(t,e){var n=e.className,r=this.name,i=n&&(" "+n+" ").replace(" "+r+" "," ");(r=t?n?(i+r).slice(1):r:i.slice(1,i.length-1))!=n&&(e.className=r)}}),v=t.compose(e.ElementRenderer,function(t){this.PropertyRenderer=t.PropertyRenderer,e.apply(this,arguments)},{renderUpdate:function(t,e){var n=[];for(var r in t)this.PropertyRenderer.prototype.renderUpdate.call({name:r},t[r],e),n.push(r);var i=this.lastProperties;if(i)for(var o=0,s=i.length;o<s;o++){var r=i[o];r in t||this.PropertyRenderer.prototype.renderUpdate.call({name:r},void 0,e)}this.lastProperties=n}}),y=e.TextRenderer,g=e.ListRenderer,b="undefined"!=typeof document?document:{createElement:function(t){return{}},addEventListener:function(){}},w={INPUT:1,TEXTAREA:1},O=!1,_=b.createElement("font"),m=_.constructor;function j(t){return function(e,n,r){"string"!=typeof n&&(n=t[n?0:1]),e.style[r]=n}}function S(t,e,n){"number"==typeof e&&(e+="px"),t.style[n]=e}function P(t,e,n){t.style[n]=e}_.constructor=function(){},b.createElement("font").constructor==_.constructor&&(_.__proto__.constructor=m,O=!0,t.buggyConstructorSetter=O);var x,T={display:j(["","none"]),visibility:j(["visible","hidden"]),color:P,opacity:P,zoom:P,minZoom:P,maxZoom:P,fontWeight:P,position:j(["absolute",""]),textDecoration:j(["underline",""]),fontWeight:P};["alignContent","alignItems","alignSelf","animation","animationDelay","animationDirection","animationDuration","animationFillMode","animationIterationCount","animationName","animationPlayState","animationTimingFunction","backfaceVisibility","background","backgroundAttachment","backgroundBlendMode","backgroundClip","backgroundColor","backgroundImage","backgroundOrigin","backgroundPosition","backgroundPositionX","backgroundPositionY","backgroundRepeat","backgroundRepeatX","backgroundRepeatY","backgroundSize","baselineShift","border","borderBottom","borderBottomColor","borderBottomLeftRadius","borderBottomRightRadius","borderBottomStyle","borderBottomWidth","borderCollapse","borderColor","borderImage","borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth","borderLeft","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRadius","borderRight","borderRightColor","borderRightStyle","borderRightWidth","borderSpacing","borderStyle","borderTop","borderTopColor","borderTopLeftRadius","borderTopRightRadius","borderTopStyle","borderTopWidth","borderWidth","bottom","boxShadow","boxSizing","bufferedRendering","captionSide","clear","clip","clipPath","clipRule","color","colorInterpolation","colorInterpolationFilters","colorRendering","counterIncrement","counterReset","cursor","direction","display","emptyCells","fill","fillOpacity","fillRule","filter","flex","flexBasis","flexDirection","flexFlow","flexGrow","flexShrink","flexWrap","float","floodColor","floodOpacity","font","fontFamily","fontFeatureSettings","fontKerning","fontSize","fontStretch","fontStyle","fontVariant","fontVariantLigatures","fontWeight","height","imageRendering","isolation","justifyContent","left","letterSpacing","lightingColor","lineHeight","listStyle","listStyleImage","listStylePosition","listStyleType","margin","marginBottom","marginLeft","marginRight","marginTop","marker","markerEnd","markerMid","markerStart","mask","maskType","maxHeight","maxWidth","maxZoom","minHeight","minWidth","minZoom","mixBlendMode","motion","motionOffset","motionPath","motionRotation","objectFit","objectPosition","opacity","order","orientation","orphans","outline","outlineColor","outlineOffset","outlineStyle","outlineWidth","overflow","overflowWrap","overflowX","overflowY","padding","paddingBottom","paddingLeft","paddingRight","paddingTop","page","pageBreakAfter","pageBreakBefore","pageBreakInside","paintOrder","perspective","perspectiveOrigin","pointerEvents","position","quotes","resize","right","shapeImageThreshold","shapeMargin","shapeOutside","shapeRendering","size","speak","src","stopColor","stopOpacity","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","tabSize","tableLayout","textAlign","textAlignLast","textAnchor","textCombineUpright","textDecoration","textIndent","textOrientation","textOverflow","textRendering","textShadow","textTransform","top","touchAction","transform","transformOrigin","transformStyle","transition","transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction","unicodeBidi","unicodeRange","userZoom","vectorEffect","verticalAlign","visibility","whiteSpace","widows","width","willChange","wordBreak","wordSpacing","wordWrap","writingMode","zIndex","zoom"].forEach(function(t){T[t]=T[t]||S});var V=new t.WeakMap,A=t.setPrototypeOf,W=Object.getPrototypeOf||function(t){return t.__proto__};function D(t){if(!x){var e=b.createElement("style");e.setAttribute("type","text/css"),b.head.insertBefore(e,b.head.firstChild),x=e.sheet}var n=x.cssRules||x.rules;return n[x.insertRule(t+" {}",n.length)]}function F(t,e,n,r){for(var i=e.length>1||r?b.createDocumentFragment():t,o=0,s=e.length;o<s;o++){var u,a=e[o];if(null!=a)if(a.notifies){var f=a.isIterable?i:t;i.appendChild(u=M(f,a))}else if("function"==typeof a)Y=t,u=new a,i.appendChild(u),a.isContentNode&&(n.contentNode=u);else if("object"==typeof a)if(a instanceof Array)n=n||t,F((u=u||t).contentNode||u,a,n);else{if(!a.nodeType)throw new Error("Unknown child type "+a);i.appendChild(u=a)}else u=b.createTextNode(a),i.appendChild(u)}return i!=t&&(r?t.insertBefore(i,t.firstChild):t.appendChild(i)),u}function M(t,e){if(null==e)return b.createTextNode("");var n;if(e.notifies){n=b.createTextNode("");var r=new y({element:t,textNode:n,variable:e});n=r.textNode}else n=b.createTextNode(e);return n}function C(t,e,n){e&&e.notifies?(new f({name:n,variable:e,element:t}),(w[t.tagName]||"SELECT"===t.tagName)&&q(t,e,n)):"SELECT"===t.tagName&&"value"===n?f.prototype.renderSelectValueUpdate(e,t):("number"===t.type&&isNaN(e)&&(e=""),t[n]=e)}function U(){}var L={children:U,tagName:U,_generators:U,classes:function(t,e){if(e.notifies&&e.put)new v({PropertyRenderer:d,element:t,variable:e});else{var n;if(e.length>-1)n=!0;else{var r=0;for(var i in e)e[r]||(e[r]=i),r++;e.length=r}for(var r=0,o=e.length;r<o;r++){var s=e[r],u=e[s];u&&u.notifies?new d({element:t,name:s,variable:u}):(u||n)&&(t.className+=" "+s)}}},class:N,for:N,role:N,render:function(t,e,r,i){new a({name:r,variable:"function"==typeof e?new n.GeneratorVariable(e.bind(t,i)):e,element:t})},dataset:R(function(t,e,n){n=n||this.name,null==t?delete e.dataset[n]:e.dataset[n]=t}),attributes:R(function(t,e,n){c.prototype.renderUpdate.call({name:n||this.name},t,e)}),style:function(t,e,n){"string"==typeof e?t.setAttribute("style",e):e&&e.notifies?new c({name:"style",variable:e,element:t}):k(t,e,n)},_item:function(e,n){!function(e,n,r){var i=e.constructor,o=i.ownedClasses||(i.ownedClasses=new t.WeakMap),s=o.get(n);s||o.set(n,s=new t.WeakMap),(e.ownedInstances||(e.ownedInstances=new t.WeakMap)).set(n,r),s.set(e,r)}(e,n.constructor,n)}};["textContent","id","className","innerHTML","title","lang","hidden","translate","dir","tabIndex","accessKey","draggable","dropzone","spellcheck","contentEditable","innerText","translate","webkitdropzone"].forEach(function(t){L[t]=!0}),"undefined"!=typeof HTMLElement&&(HTMLElement.prototype._propertyHandlers=L);var I={input:t.copy(["accept","alt","autocomplete","autofocus","capture","defaultChecked","dirName","disabled","form","files","formAction","formEnctype","formMethod","formNoValidate","formTarget","indeterminate","inputMode","list","max","maxLength","min","minLength","multiple","name","pattern","placeholder","readOnly","required","size","src","step","type","defaultValue","willValidate","validity","validationMessage","useMap","autocapitalize","webkitdirectory","incremental","stepUp","stepDown"],{value:C,valueAsNumber:C,valueAsDate:C,checked:C,type:function(t,e){try{t.type=e}catch(t){}}}),select:t.copy(["disabled","name","size","type","selectedIndex","validationMessage"],{value:C}),textarea:t.copy(["cols","dirName","maxLength","minLength","name","placeholder","rows","wrap","type","defaultValue","textLength","validationMessage","autocapitalize"],{value:C}),a:["target","download","ping","rel","hreflang","type","referrerPolicy","href","media"],area:["target","download","coords","rel","hreflang","type","referrerPolicy","href","media","alt","shape"],button:["disabled","formAction","formEnctype","formMethod","formTarget","name","type","value","validationMessage"],details:["open"],dialog:["open"],embed:["src","type","name"],fieldset:["disabled","form","name"],form:["acceptCharset","action","autocomplete","enctype","encoding","method","name","target","novalidate"],frame:["name","scrolling","src","frameBorder"],frameset:["cols","rows"],iframe:["src","srcdoc","name","referrerPolicy","align","scrolling","frameBorder","longDesc"],img:["src","alt","crossorigin","ismap","longdesc","sizes","srcset","usemap","referrerpolicy"],option:["label","value","text","index"],optgroup:["label"],output:["name","type","defaultValue","value","validationMessage"],label:["htmlFor"],td:["colSpan","rowSpan"],th:["colSpan","rowSpan"],script:["src","type","charset","text","event","htmlFor","integrity"],style:["media","type"],track:["kind","src","srclang","label"],link:["href","rel","media","hreflang","type","charset","rev","target","integrity","as"],meta:["name","httpEquiv","content","scheme"],meter:["value","min","max","low","high","optimum"],progress:["value","max","position"],del:["cite","dateTime"],ins:["cite","dateTime"],source:["src","type","srcset","sizes","media"],video:["videoWidth","videoHeight","poster","webkitDecodedFrameCount","webkitDroppedFrameCount"],keygen:["challenge","keytype","name","type","validationMessage"],object:["data","type","name","useMap","validationMessage","archive","code","hspace","standby","vspace","codeBase","codeType"],param:["name","value","type","valueType"]};function N(t,e,n){e&&e.notifies?new c({name:n,variable:e,element:t}):t.setAttribute(n,e)}var k=R(function(t,e,n){-1==(n=n||this.name).indexOf("-")?e.style[n]=t:e.style.setProperty(n,t)});function R(e){var n=t.compose(a,function(t){a.apply(this,arguments)},{renderUpdate:e});return function(t,r,i){if(r.notifies&&r.put)new v({PropertyRenderer:n,variable:r,element:t});else for(var o in r){var s=r[o];s&&s.notifies?new n({name:o,variable:s,element:t}):e(s,t,o)}}}function B(t,e){var n=t._propertyHandlers,r=t.constructor;for(var i in e){var o,s=e[i],u=r[i];"function"==typeof u&&u.notifies&&u!==s&&(ht(r,u),u.for(t).put(s));var f=n[i];f?!0===f?s&&s.notifies?new a({name:i,variable:s,element:t}):t[i]=s:f(t,s,i,e):(o=T[i])?s&&s.notifies?new p({name:i,variable:s,element:t}):o(t,s,i):"function"==typeof s&&"on"===i.slice(0,2)?(null===t[i]||t["_registeredEvent_"+i]||(t["_registeredEvent_"+i]=!0,t.addEventListener(i.slice(2),function(t){this["on"+t.type](t)})),t[i]=s):null==t[i]?t[i]=s:Object.defineProperty(t,i,{value:s,enumerable:!0,configurable:!0,writable:!0})}}function H(t,e,n,r){var i=t.each||r.each;if(i&&e)if(i.create&&(i.defineHasOwn=function(){ht(i,vt,function(t){var e=vt.from(t._item);return e});var t=e.getCollectionOf&&e.getCollectionOf();t&&ht(i,t,function(e){var n=t.from(e._item);return n})}),e.notifies)new g({each:i,variable:e,element:t});else{var o=b.createDocumentFragment();i.defineHasOwn&&i.defineHasOwn(),e.forEach(function(e){i.create?childElement=i.create({parent:t,_item:e}):childElement=i(e,t),o.appendChild(childElement)}),t.appendChild(o)}else w[t.tagName]?function(t,e){var n=t.type,r=n in{date:1,datetime:1,time:1}?"valueAsDate":"checkbox"===n||"radio"===n?"checked":"value";e&&e.notifies?(new f({variable:e,name:r,element:t}),q(t,e,r,K)):t[r]=e}(t,e):e instanceof Array?F(t=t.contentNode||t,e,t):"function"==typeof e&&e.for?F(t=t.contentNode||t,[e],t):t.appendChild(M(t,e))}function q(e,r,i,o){t.nextTurn(function(){for(var t=e.inputEvents||["change","alkali-change"],s=0,a=t.length;s<a;s++)e.addEventListener(t[s],function(t){var s=e[i];new u(e).executeWithin(function(){var t=r.put(o?o(s,e):s);if(t===n.deny)throw new Error("Variable change denied")})})})}function K(t,e){return"number"==e.type?parseFloat(t):t}function z(t,e,n,r){var i=r[n];if(i)for(var o in e)i[o]=e[o];else r[n]=e}b.addEventListener("click",function(t){var e=t.target;if("radio"===e.type)for(var n=b.querySelectorAll("input[type=radio]"),r=0,i=n.length;r<i;r++){var o=n[r];o.name===e.name&&o!==e&&o.dispatchEvent(new Event("alkali-change",{}))}});var Y,Z={classes:z,_generators:z,dataset:z,attributes:z,style:z,hasOwn:function(t,e){ht(t,e)},children:function(t,e){t.children=e},shadow:function(t,e){t.shadow=e}};function J(t,e){var n=e._applyOnCreate;if(t&&"object"==typeof t)if(t instanceof Array||t.notifies)n.content=t;else for(var r in t){var o=t[r],u=e[r];"function"==typeof o?o.notifies?(o===i&&(o=i()),e[r]?Object.defineProperty(e,r,{value:o,enumerable:!0}):e[r]=o):s(o)&&("get_"===r.slice(0,4)&&(r=r.slice(4)),(n._generators||(n._generators={}))[r]=o):o&&o.notifies&&(e[r]?Object.defineProperty(e,r,{value:o,enumerable:!0}):e[r]=o),Z[r]?Z[r](e,o,r,n):"function"==typeof u&&u.notifies?n[r]=new u(o):n[r]=o}else{if("function"==typeof t&&!t.for)throw new TypeError("Function as argument not supported");n.content=t}}function Q(t){if(t.hasOwnProperty("_applyOnCreate"))return t._applyOnCreate;if(t.getForClass){var e=t._applyOnCreate={},n=Q(W(t));for(var r in n)e[r]=Z[r]?Object.create(n[r]):n[r];for(var i,o=t.prototype,u=Object.getOwnPropertyNames(o),a=0,f=u.length;a<f;a++){var r=u[a];if("on"===r.slice(0,2)||"render"===r&&s(o[r])){if(nt.disallowClassEventHandlers&&null===W(o)[r])throw new Error("Defining event handlers through class methods is not allowed (due to incompatibility with compiled code)");e[r]=o[r]}else if("_render"===r.slice(0,7)){var c=r[7].toLowerCase()+r.slice(8);i||(i=o._propertyHandlers=Object.create(o._propertyHandlers)),i[c]=!0,Object.defineProperty(o,c,$(r))}}return e}return null}function $(e){var n=new t.WeakMap;return{get:function(){return n.has(this)?n.get(this):null},set:function(t){n.set(this,t),this[e](t)}}}function G(t,e){var n=function(t){var e=!t.with;if(Object.setPrototypeOf)for(;t.prototype.constructor!==t&&!t.hasOwnProperty("with");)t=W(t);var n=!1===Object.getOwnPropertyDescriptor(t,"prototype").writable;return l(t,e&&X,G,n)}(this);this.with?(A(n,this),n.ownedClasses=null):(n.create=X,n.with=G,n.defineElement=et,n.for=pt,n.property=dt,n.getForClass=lt),n.prototype=this.prototype;var r=n._applyOnCreate={},i=Q(this);for(var s in i)r[s]=Z[s]?Object.create(i[s]):i[s];var u=0;if("string"==typeof t){var a=t.match(o);if(a)do{var f=a[1],c=a[2];"."==f?r.className?r.className+=" "+c:r.className=c:r.id=c;var p=a[3];a=p&&p.match(o)}while(a);else r.content=t;u++}for(var h=arguments.length;u<h;u++)J(arguments[u],n);return n}function X(t,e){var r=Q(this);if(Y){var i=Y;Y=null}var s=this._ElementClass?h(this._BaseElementClass||HTMLElement,arguments,this._ElementClass):b.createElement(this.tagName);t&&t.parent&&(i=t.parent),i&&V.set(s,i),s instanceof this||A(s,this.prototype),s.constructor!=this&&(s.constructor=this);var u=arguments.length>0;if(u||s.created||s.ready){var a=r;for(var f in r={},a)r[f]=Z[f]?Object.create(a[f]):a[f]}if(u){var c=0;if("string"==typeof t){c++;var p=t.match(o);if(p)do{var l=p[1],d=p[2];"."==l?r.className?r.className+=" "+d:s.className?s.className+=" "+d:s.className=d:r.id?r.id=d:s.id=d;var v=p[3];p=v&&v.match(o)}while(p);else r.content=t}else t&&t._item&&(s._item=t._item);for(var y=arguments.length;c<y;c++){var g=arguments[c];if(g&&"object"==typeof g)if(g instanceof Array||g.notifies)r.content=g;else for(var f in g)Z[f]?Z[f](this,g[f],f,r):r[f]=g[f];else"function"==typeof g&&g.for?r.content=g.for(s):r.content=g}}return s.created?r=s.created(r)||r:r.created&&(r=r.created.call(s,r)||r),B(s,r),r._generators&&function(t,e){var r,i,o,s=e._generators,u=t._propertyHandlers;for(var a in s){var f=new n.GeneratorVariable(s[a].bind(t,e));u[a]?(o||(o={}))[a]=f:T[a]?(i||(i={}))[a]=f:(r||(r={}))[a]=f}r&&B(t,r),i&&B(t,i),o&&B(t,o)}(s,r),this.children&&F(s,this.children,s),this.shadow&&F(s.attachShadow({mode:"open"}),this.shadow,s),null!=s.content&&H(s,s.content,0,r),s.ready&&s.ready(r),s}var E=[].slice;function tt(t){return this.nodeType?F(this,arguments,this):F(t,E.call(arguments,1),t)}function et(t,e){if(!e){if("string"!=typeof t)return t.with();e=this}var n=void 0===e.nativeTagName?e.tagName:e.nativeTagName,i=t.match(/[\.\#].+/),o=i?t.slice(0,t.length-(i=i[0]).length):t;if(n||(e.tagName=o),e.nativeTagName=n||null,"object"==typeof customElements){if(void 0===r){var s=function(){};customElements.define("alkali-test-support",s,{extends:"div"}),r=!1;try{h(HTMLDivElement,[],s),r=!0}catch(t){}}if(!n||r)try{(e._ElementClass=customElements.get(o))?console.warn("Element",o,"already registered"):(customElements.define(o,e,{extends:n}),e._ElementClass=e,n&&(e._BaseElementClass=customElements.get(n)||b.createElement(n).constructor))}catch(t){console.warn(t)}}return e.with||(e.with=G),ft(e,{selector:i,uniqueTag:!0})}var nt=ot("undefined"!=typeof HTMLElement?HTMLElement:function(){});nt.defineElement=et,nt.assign=function(t,e){if("function"==typeof t)Q(t),J(e,t);else{var n=t.alkaliRenderers,r=n?n.length:0;B(t,e);for(var i=n?n.length:0,o=r;o<i;o++)for(var s=0;s<r;s++)n[s].isSameProperty(n[o])&&(n[s].stop(),n.splice(s,1),s=-1,r--,i--)}},nt.within=function(t){},["Video","Source","Media","Audio","UL","U","Track","Title","TextArea","Template","TBody","THead","TFoot","TR","Table","Col","ColGroup","TH","TD","Caption","Sup","Sub","Style","Strong","Span","Small","Shadow","Select","Script","S","Quote","Progress","Pre","Picture","Param","P","Output","Option","Optgroup","Object","OL","Ins","I","Del","Meter","Meta","Menu","Map","Link","Legend","Label","LI","KeyGen","Input","Img","IFrame","H1","H2","H3","H4","H5","H6","Hr","FrameSet","Frame","Form","Font","FieldSet","Embed","Em","Code","Cite","Dfn","B","Article","Aside","Abbr","Footer","Figure","FigCaption","Header","Main","Mark","MenuItem","Nav","Section","Slot","Summary","WBr","Div","Dialog","Details","DataList","DL","DT","DD","Canvas","Button","Base","Br","Area","A"].forEach(function(t){var e;Object.defineProperty(nt,t,{get:function(){return e||(e=it(t))}})}),function(t){t.forEach(function(t){var e;Object.defineProperty(nt,t,{get:function(){return e||(e=ot(HTMLInputElement,"input",t.toLowerCase()))}}),Object.defineProperty(nt,t+"Input",{get:function(){return this[t]}})})}(["Checkbox","Password","Submit","Radio","Color","Date","DateTime","Email","Month","Number","Range","Search","Tel","Time","Url","Week"]);var rt={};function it(t){return t=t.toLowerCase(),rt[t]||(rt[t]=ot(b.createElement(t).constructor,t))}function ot(t,e,n){O&&(Object.defineProperty(t.prototype,"constructor",{get:function(){return this._constructor},set:function(t){this._constructor=t}}),t.prototype._constructor=t);var r=n?G.call(t,{type:n}):G.call(t),i=I[e];if(i&&!i.assigned){for(var o=r.prototype._propertyHandlers=Object.create(L),s=0,u=i.length;s<u;s++)o[i[s]]=!0;if(i.value)for(var s in i)s>-1||(o[s]=i[s]);i.assigned=!0}return r.tagName=e,r}var st={Anchor:"A",Image:"Img",Paragraph:"P",Textarea:"TextArea",DList:"DL",UList:"UL",OList:"OL",ListItem:"LI",Text:"Input",TextInput:"Input",TableRow:"TR",TableCell:"TD",TableHeaderCell:"TH",TableHeader:"THead",TableBody:"TBody"};for(var ut in st)!function(t,e){Object.defineProperty(nt,t,{get:function(){return this[e]}})}(ut,st[ut]);function at(t){return{variable:t,then:function(t,e){return this.variable.then(t,e)},notifies:function(){},stopNotifies:function(){}}}function ft(t,e){e=e||{};var n,r=Q(t),i={},o=t.prototype._propertyHandlers;for(var s in r){var u=r[s];if(u&&u.notifies&&!0===o[s])new a({name:s,variable:u.collection||u,getElements:function(){return e.uniqueTag?document.getElementsByTagName(v.tagName):ct(v,e.parent)}}),i[s]=at(u);else if(T[s])u&&u.notifies?(new p({name:s,variable:u.collection||u,getElements:function(){return e.uniqueTag?document.getElementsByTagName(v.tagName):ct(v,e.parent)}}),i[s]=at(u)):(n=n||D(e.uniqueTag?t.tagName:t.tagName+"."+r.className),T[s](n,u,s),i[s]=void 0);else if("style"===s&&u&&!u.notifies){for(var f in n=n||D(e.uniqueTag?t.tagName:t.tagName+"."+r.className),u)-1==f.indexOf("-")?n.style[f]=u[f]:n.setProperty(f,u[f]);i.style=void 0}}if(t._cssRule&&e.uniqueTag&&(t._cssRule.selectorText+=","+t.tagName),t.children){for(var c=[],h=0;h<t.children.length;h++){var l=t.children[h];if(l){if(l.notifies)throw new Error("Variables can not be used as child nodes in generalized/bound classes, consider wrapping with a span");"function"==typeof l&&(l=ft(l,{parent:e.parent}))}c[h]=l}i.children=c}var d=r.content;d&&(d.notifies?(new y({getElements:function(){return e.uniqueTag?document.getElementsByTagName(v.tagName):ct(v,e.parent)},variable:d.collection||d,position:0}),i.content=at(d)):d instanceof Array&&(i.content=d.map(function(t){if(t.notifies)throw new Error("Variables can not be used as child nodes in generalized/bound classes, consider wrapping with a span");return"function"==typeof t&&(t=ft(t,{parent:e.parent})),t})));var v=e.selector?t.with(e.selector,i):t.with(i);return n&&(v._cssRule=n),v}function ct(t,e){var n=t.tagName,r=t._applyOnCreate.className;return r&&(n+="."+r),[].filter.call((e||document).querySelectorAll(n),function(e){return e.constructor===t})}function pt(t){return t.constructor.getForClass(t,this)}function ht(e,n,r){if("object"==typeof n){var i=e.ownedClasses||(e.ownedClasses=new t.WeakMap),o={get:function(){return n}};return i.set(n.constructor,o),ht(e,n.Class,n.createInstance)}if(n instanceof Array)return n.forEach(function(t){ht(e,t)});var i=e.ownedClasses||(e.ownedClasses=new t.WeakMap);if(!i.has(n)){var o=new t.WeakMap;o.createInstance=r,i.set(n,o)}return e}function lt(e,n){for(var r;e&&!(r=e.constructor.ownedClasses&&e.constructor.ownedClasses.get(n));)e=e.parentNode||V.get(e);if(r){var i=e.ownedInstances||(e.ownedInstances=new t.WeakMap),o=i.get(n);return void 0===o&&(i.set(n,o=r(e)),o.subject=e),o}}function dt(t){return ThisElementVariable=this._Variable,ThisElementVariable||(ThisElementVariable=this._Variable=i(),ht(this,ThisElementVariable,function(t){var e;if(t.alkaliRenderers){for(var n={},r=0;r<t.alkaliRenderers.length;r++){var i=t.alkaliRenderers[r];i.name&&(n[i.name]={value:i.variable})}e=Object.create(t,n)}else e=t;var o=new ThisElementVariable(e);return o})),ThisElementVariable.property(t)}nt.append=tt,e.append=tt,nt.prepend=function(t){return this.nodeType?F(this,arguments,this,!0):F(t,E.call(arguments,1),t,!0)},nt.refresh=e.refresh,nt.options={moveLiveElementsEnabled:!0},nt.content=function(t){function e(){return new t}return e.isContentNode=!0,e},nt.ElementClass=function(){},"undefined"!=typeof Symbol&&Object.defineProperty(nt.ElementClass,Symbol.hasInstance,{value:function(t){return t&&t.create&&t.with}}),nt.extend=function(t,e){function n(){return t.apply(this,arguments)}A(n,t);var r=n.prototype=Object.create(t.prototype,{constructor:{value:n}});return Object.getOwnPropertyNames(e).forEach(function(t){var i=Object.getOwnPropertyDescriptor(e,t);Z[t]?Z[t](n,i.value,t,e):Object.defineProperty(r,t,i)}),n},nt.bindElementClass=ft;var vt=nt.Item=n.Item,yt=[{name:"detached",nodes:"removedNodes",action:function(t){t.detached&&t.detached(),function(t){var e=t.alkaliRenderers;if(e){for(var n=0,r=e.length;n<r;n++)e[n].stop();t.needsRestart=!0}}(t)}},{name:"attached",nodes:"addedNodes",action:function(t){t.constructor.create&&(t.needsRestart&&function(t){var e=t.alkaliRenderers;if(e)for(var n=0,r=e.length;n<r;n++)e[n].restart();t.needsRestart=!1}(t),t.attached&&t.attached())}}];function gt(t,e){if("attached"===e.name)return!t.__alkaliAttached__&&(t.__alkaliAttached__=!0,e.action(t),!0);if(t.__alkaliAttached__){if(b.body.contains(t))return!1;t.__alkaliAttached__=!1,e.action(t)}return!0}if("function"==typeof MutationObserver){var bt=new MutationObserver(function(t){for(var e=0,n=t.length;e<n;e++)for(var r=t[e],i=0,o=yt.length;i<o;i++){var s=yt[i],u=r[s.nodes];t:for(var a=0,f=u.length;a<f;a++){var c=u[a];if(gt(c,s)){var p=c.firstChild;if(p)for(;;){var h;if(1===p.nodeType&&gt(p,s)&&(h=p.firstChild)||(h=p.nextSibling),!h)do{if((p=p.parentNode)===c)continue t}while(!(h=p.nextSibling));p=h}}}}});bt.observe(b.body||b,{childList:!0,subtree:!0})}else"undefined"!=typeof document&&setInterval(function(){for(var t=document.all,e=yt[1],n=0,r=t.length;n<r;n++)gt(t[n],e)},300);return t.copy(n.Context.prototype,{specify:function(t){var e=this.subject,n=!0;for((this.generics||(this.generics=[])).push(t);e;){this.distinctSubject===e&&(n=!1);var r=e.constructor.ownedClasses;if(r){var i=r.get(t);if(i)return n&&(this.distinctSubject=e),specifiedInstance=i.get(e),specifiedInstance||i.set(e,specifiedInstance=i.createInstance?i.createInstance(e):new t),specifiedInstance}e=e.parentNode||V.get(e)}return t.defaultInstance},getContextualized:function(t){var e=this.subject;if(!e)return t;if(t._contextMap)do{var n=t._contextMap.get(e);if(n&&n.context.matches(e))return n}while(e=e.parentNode||V.get(e));return t.context&&t.context.matches(this.subject)?t:void 0},merge:function(t){(!this.distinctSubject||this.distinctSubject!==t.distinctSubject&&this.distinctSubject.contains(t.distinctSubject))&&(this.distinctSubject=t.distinctSubject),[].push.apply(this.generics||(this.generics=[]),t.generics)},getDistinctElement:function(t,e){do{var n=e.constructor.ownedClasses;if(n){var r=n.get(t);if(r&&r.has(e))return e}}while(e=e.parentNode||V.get(e))},matches:function(t){var e=this.generics;if(e)for(var n=0,r=e.length;n<r;n++)if(this.getDistinctElement(e[n],t)!==this.distinctSubject)return!1;return!0}}),nt.createElement=function(t,e){for(var n in e=e||{},arguments.length>2&&(e.content=[].slice.call(arguments,2)),"string"==typeof t&&(t=it(t)),e)"string"==typeof n&&"data-"==n.slice(0,5)&&(e.dataset||(e.dataset={}),e.dataset[n.slice(5).toLowerCase().replace(/-[a-zA-Z]/g,function(t){return t.charAt(1).toUpperCase()})]=e[n],delete e[n]);if(t.with)return t.with(e);if("function"==typeof t)return t(e);throw Error("Unrecognize element type")},nt})?r.apply(e,i):r)||(t.exports=o)},function(t,e,n){var r,i,o;i=[n(0),n(4),n(1)],void 0===(o="function"==typeof(r=function(t,e,n){var r=n.Transform,i=n.Variable,o=n._changeValue,s=n.VArray,u=t.isGenerator;function a(t){for(var e=0,n=t.length;e<n;e++){var r=t[e];r&&r._getAsObject&&(t[e]=r._getAsObject())}return t}t.compose(r,function(t,e,n){this.sources=n,r.apply(this,arguments)},{_getAsObject:function(){return this.transform.apply(this,a(this.sources))}});var f=new Map;function c(t){return p(t)}function p(t,e,n){var o=f.get(typeof t)||f.get(t&&t.constructor)||t instanceof i&&!(t instanceof r)&&t.constructor;if(o)return new o(e?void 0:t);if(!n){var s;if(e?s=new i:(s=new i(t),t&&"object"==typeof t&&(s.fixed=!0)),t.then)return s;for(var u in t)if(t.hasOwnProperty(u)){var a=t[u],c=p(a,!0,!0);c?(c.key=u,c.parent=s,void 0===s[u]?s[u]=c:(s._properties||(s._properties={}))[u]=c):h(s,u,t)}return s}}function h(t,e,n){Object.defineProperty(t,e,{get:function(){return c.get(this,e,function(){return p(n[e],!0)})},set:function(t){c.set(this,e,t)},enumerable:!0})}function l(t){if(f.has(t))return f.get(t);if("object"==typeof t){if(t instanceof Array)return t[0]?s.of(l(t[0])):s;var e,n={};for(var r in t)n[r]=l(t[r]),e=!0;return e?i.with(n):i}return t}function d(t,e,n){n?n.notifies||(n=l(n)||i):console.warn("Invalid type specified for",t&&t.constructor.name,"property",e,"(ensure you are using a concrete type, not an interface)"),Object.defineProperty(t,e,{get:function(){return c.get(this,e,n)},set:function(t){c.set(this,e,t)},enumerable:!0})}return f.set("string",n.VString),f.set("number",n.VNumber),f.set("boolean",n.VBoolean),f.set("undefined",i),f.set(null,i),f.set(Array,s),f.set(Map,n.VMap),f.set(Set,n.VSet),n.reactive=c,t.copy(c,{from:function(t,e){return t&&t.property?t:"function"==typeof t&&u(t)?n.react(t,e):i.from(t)},getp:function(t,e){if(t){if(t.property){var n=t[e];return void 0!==n?n:t.property(e)}return t[e]}},get:function(t,e,n){var r=(t._properties||(t._properties={}))[e];return r||(t._properties[e]=r=new(l(n)),t.getValue&&(r.key=e,r.parent=t,r.listeners&&r.init())),r},set:function(t,e,n){var r=t[e];r.parent?o(r,3,n):r.put(n)},prop:function(t){return function(e,n){d(e,n,t)}},cond:function(t,n,r){return e.if(t,e.choose(n,r))},fcall:function(t,e){return t.property&&"function"==typeof t?t.apply(null,a(e)):new r(e[0],t,e)},mcall:function(t,e,n){var i=t[e];return"function"==typeof i&&i.property||"bind"===e?i.apply(t,a(n)):new r(n[0],t[e].bind(t),n)},ncall:function(t,e){return t.property&&"function"==typeof t?new(t.bind.apply(t,[null].concat(a(e)))):new r(e[0],function(){return new(t.bind.apply(t,[null].concat(arguments)))},e)},obj:function(t){return t},val:function(t){return t&&t.valueOf()},cls:function(t){return c=this,function(e){var n=e.prototype;for(var r in n instanceof i||(Object.getPrototypeOf(n)==Object.prototype?(Object.setPrototypeOf(e,i),Object.setPrototypeOf(n,i.prototype)):console.warn("Unable to make class a reactive variable")),t)d(n,r,t[r])}}}),t.copy(c,e),c})?r.apply(e,i):r)||(t.exports=o)},function(t,e,n){var r,i,o;i=[n(0),n(1)],void 0===(o="function"==typeof(r=function(t,e){var n=e.Variable;function r(t,e,n){if(t&&"object"==typeof t){if(t instanceof Array){e=[];for(var i=0,o=t.length;i<o;i++)e[i]=r(t[i],null,n)}else for(var i in e&&"object"==typeof e||(e=n&&n.get(t))||(e={},n&&n.set(t,e)),t)e[i]=r(t[i],e[i],n);return e}return t}return t.compose(n,function(e){this.copiedFrom=e,this.derivativeMap=new t.WeakMap(null,"derivative"),this.isDirty=new n(!1)},{getValue:function(t,e,i){this.state&&(this.state=null);var o=this.copiedFrom.valueOf();if(o&&"object"==typeof o){var s=this.derivativeMap.get(o);null==s&&(this.derivativeMap.set(o,s=r(o,void 0,this.derivativeMap)),this.value=s)}return void 0===this.value?o:n.prototype.getValue.call(this,t,e,i)},getCopyOf:function(t){var e=this.derivativeMap.get(t);return null==e&&this.derivativeMap.set(t,e=r(t,void 0,this.derivativeMap)),e},save:function(){if(this.copiedFrom.put)this.copiedFrom.put(this.valueOf());else{var t=this.copiedFrom.valueOf();r(this.valueOf(),t)}this.isDirty.put(!1),this.onSave&&this.onSave()},revert:function(){var e=this.copiedFrom.valueOf();this.derivativeMap=new t.WeakMap(null,"derivative"),this.put(r(e,void 0,this.derivativeMap)),this.isDirty.put(!1)},updated:function(){return this.isDirty.put(!0),n.prototype.updated.apply(this,arguments)}})})?r.apply(e,i):r)||(t.exports=o)},function(t,e,n){(function(r){var i,o,s;o=[n(0),n(1)],void 0===(s="function"==typeof(i=function(t,e){var n=(void 0!==r?r:window).Promise;function i(t){this.context=e.currentContext,this.promise=new n(t)}function o(t,e){return t&&e?function(n){return e.executeWithin(function(){var r=t(n);return r&&r.then?new u(r,e):r})}:t}function s(t){for(var e=new Array(t.length),n=i.propagateAbort,r=0,o=t.length;r<o;r++){var s=t[r];s&&s.then&&(s.notifies&&(s=s.then()),s.abort||(n=!1)),e[r]=s}return n&&(e.assignAbort=function(e){e.abort=function(e){for(var n=0,r=t.length;n<r;n++){var i=t[n];i&&i.abort&&i.abort(e)}}}),e}function u(t,e,n){this.context=e,this.promise=t,i.propagateAbort&&(n||t).abort&&(this.abort=(n||t).abort)}return t.copy(i.prototype,{then:function(t,e){var n=this.context,r=this.promise;if(n&&r.notifies){var i=this;return n.executeWithin(function(){return new u(r.then(o(t,n),o(e,n)),n,i)})}return new u(r.then(o(t,n),o(e,n)),n,this)},catch:function(t){var e=this.context;return new u(this.promise.catch(o(t,e)),e,this)},finally:function(t){var e=this.context;return new u(this.promise.finally(o(t,e)),e,this)},isContextual:!0}),i.resolve=function(t){return new u(t&&t.then?t:n.resolve(t),e.currentContext)},i.reject=function(t){return new u(n.reject(t),e.currentContext)},i.all=function(t){var r=s(t),i=new u(n.all(r),e.currentContext);return r.assignAbort&&r.assignAbort(i),i},i.race=function(t){var r=s(t),i=new u(n.race(r),e.currentContext);return r.assignAbort&&r.assignAbort(i),i},u.prototype=i.prototype,i})?i.apply(e,o):i)||(t.exports=s)}).call(this,n(2))}])});
//# sourceMappingURL=index.js.map