!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.alkali=t():e.alkali=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;factory=function(){var getPrototypeOf=Object.getPrototypeOf||function(e){return e.__proto__},setPrototypeOf=Object.setPrototypeOf||function(e,t){for(var n in t)try{e.hasOwnProperty(n)||(t.hasOwnProperty(n)?Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n)):e[n]=t[n])}catch(e){}},hasFeatures={requestAnimationFrame:"undefined"!=typeof requestAnimationFrame,defineProperty:Object.defineProperty&&function(){try{return Object.defineProperty({},"t",{}),!0}catch(e){}}(),promise:"undefined"!=typeof Promise,MutationObserver:"undefined"!=typeof MutationObserver,WeakMap:"function"==typeof WeakMap};function has(e){return hasFeatures[e]}function SyncPromise(e){this.value=e}function SyncErrorPromise(e){this.value=e,this.unhandledTimeout=setTimeout(function(){console.error("Uncaught (in promise)",e)})}SyncPromise.prototype={then:function(e,t){if(!e)return new SyncPromise(this.value);try{var n=e(this.value);return n&&n.then?n:new SyncPromise(n)}catch(e){return new SyncErrorPromise(e)}},catch:function(e){return this.then(null,e)},finally:function(e){return e(),this}},SyncErrorPromise.prototype=new SyncPromise,SyncErrorPromise.prototype.then=function(e,t){return clearTimeout(this.unhandledTimeout),t?SyncPromise.prototype.then.call(this,t):new SyncErrorPromise(this.value)};var observe=has("defineProperty")?function(e,t){return t.addKey=function(n){var r="key"+n;if(this[r])return;this[r]=!0;var i,o=e[n],a=e;do{i=Object.getOwnPropertyDescriptor(a,n)}while(!i&&(a=getPrototypeOf(a)));if(i&&i.set){var s=i.set,u=i.get;Object.defineProperty(e,n,{get:function(){return o=u.call(this)},set:function(e){s.call(this,e),o!==e&&(o=e,t&&t([{target:this,name:n}]))},enumerable:i.enumerable})}else Object.defineProperty(e,n,{get:function(){return o},set:function(e){o!==e&&(o=e,t&&t([{target:this,name:n}]))},enumerable:!i||i.enumerable})},t.remove=function(){t=null},t}:function(e,t){timerStarted||(timerStarted=!0,setInterval(function(){for(var e=0,t=watchedObjects.length;e<t;e++)diff(watchedCopies[e],watchedObjects[e],listeners[e])},20));var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);watchedObjects.push(e),watchedCopies.push(n),listeners.push(t)},queuedListeners;function queue(e,t,n){queuedListeners?-1===queuedListeners.indexOf(e)&&queuedListeners.push(e):(queuedListeners=[e],lang.nextTurn(function(){queuedListeners.forEach(function(e){var t=[];e.properties.forEach(function(n){t.push({target:e.object,name:n})}),e(t),e.object=null,e.properties=null}),queuedListeners=null},0)),e.object=t;var r=e.properties||(e.properties=[]);-1===r.indexOf(n)&&r.push(n)}var unobserve=has("observe")?Object.unobserve:function(e,t){t.remove&&t.remove();for(var n=0,r=watchedObjects.length;n<r;n++)if(watchedObjects[n]===e&&listeners[n]===t)return watchedObjects.splice(n,1),watchedCopies.splice(n,1),void listeners.splice(n,1)},watchedObjects=[],watchedCopies=[],listeners=[],timerStarted=!1;function diff(e,t,n){var r;for(var i in e)e.hasOwnProperty(i)&&e[i]!==t[i]&&(e[i]=t[i](r||(r=[])).push({name:i}));for(var i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i](r||(r=[])).push({name:i}));r&&n(r)}var id=1;function toJSONHidden(){return toJSONHidden}var Hidden=function(){},extendClass,constructOrCall;Hidden.prototype.toJSON=toJSONHidden;try{extendClass=eval("(function(Base){ return class extends Base {}})\n\n//# sourceURL=class-extend");var possibleConstructOrCall=eval('"use strict";(function(BaseClass, constructHandler, callHandler, constructClass){ return function Element() { return this instanceof Element ? constructHandler ? constructHandler.apply(new.target || this.constructor, arguments) : constructClass ? Reflect.construct(BaseClass, arguments, new.target || this.constructor) : lang.functionConstruct(BaseClass, arguments, new.target || this.constructor, this) : callHandler.apply(Element, arguments) } })\n\n//# sourceURL=construct-or-call');new(possibleConstructOrCall(function(){},function(){})),constructOrCall=possibleConstructOrCall}catch(e){}var lang={requestAnimationFrame:has("requestAnimationFrame")?requestAnimationFrame:function(){var e=[],t=!1;function n(){for(var n=0;n<e.length;n++)e[n]();e=[],t=!1}return function(r){t||(setTimeout(n),t=!0),e.push(r)}}(),SyncPromise:SyncPromise,Promise:has("promise")?Promise:function(){return function e(t){var n,r,i,o=0;function a(e){i=e,s()}function s(){n=!0;for(var e=0,t=o.length;e<t;e++)o[e]();o=0}return t(function e(t){t&&t.then?t.then(e,a):(r=t,s())},a),{then:function(t,a){return new e(function(e,s){function u(){try{i&&!a?s(i):e(i?a(i):t?t(r):r)}catch(e){s(e)}}n?u():(o||(o=[])).push(u)})}}}}(),Set:"undefined"!=typeof Set?new Set(["a"]).length?Set:function(e){var t=new Set;if(e)for(var n=0;n<e.length;n++)t.add(e[n]);return t}:function(e){return e=e||[],{add:function(t){this.has(t)||e.push(t)},has:function(t){return e.indexOf(t)>-1}}},Map:"undefined"!=typeof Map?Map:function(){var e=Object.create(null);return{set:function(t,n){e[t]=n},has:function(t){return Object.prototype.hasOwnProperty.call(e,key)},get:function(t){return e[t]}}},WeakMap:has("WeakMap")?WeakMap:function(e,t){var n="__"+(t||"")+id++;return has("defineProperty")?{get:function(e){return e[n]},set:function(e,t){Object.defineProperty(e,n,{value:t,enumerable:!1})}}:{get:function(e){var t=e[n];return t&&t.value},set:function(e,t){(e[n]||(e[n]=new Hidden)).value=t}}},observe:observe,unobserve:unobserve,extendClass:extendClass,when:function(e,t,n){return e&&e.then?e.then(t,n)||e:t(e)},compose:function(e,t,n){var r=t.prototype=Object.create(e.prototype);for(var i in setPrototypeOf(t,e),n)r[i]=n[i];return r.constructor=t,t},setPrototypeOf:setPrototypeOf,nextTurn:has("MutationObserver")?function(e){var t=document.createElement("div");new MutationObserver(e).observe(t,{attributes:!0}),t.setAttribute("a",id++)}:function(e){setTimeout(e,0)},copy:Object.assign||function(e,t){for(var n in t)e[n]=t[n];return e},deepCopy:function(e){if(e&&"object"==typeof e){if(e instanceof Array)for(var t=[],n=0,r=e.length;n<r;n++)t[n]=lang.deepCopy(e[n]);else{t={};for(var n in e)t[n]=lang.deepCopy(e[n])}return t}return e},constructOrCall:constructOrCall||function(e,t,n){return function r(){if(this instanceof r){if(this.hasOwnProperty("constructor")||r.prototype!==getPrototypeOf(this)){if(t)return t.apply(this.constructor,arguments)}else{if(t)return t.apply(r,arguments);lang.buggyConstructorSetter?Object.defineProperty(this,"constructor",{value:r}):this.constructor=r}return e.apply(this,arguments)}return n.apply(r,arguments)}},functionConstruct:function(e,t,n,r){return r.hasOwnProperty("constructor")||n.prototype!==Object.getPrototypeOf(r)||(r=Object.create(n.prototype),lang.buggyConstructorSetter?Object.defineProperty(r,"constructor",{value:n}):r.constructor=n),e.apply(r,t)}};function isGenerator(e){if("function"==typeof e){var t=e.constructor;return"GeneratorFunction"===(t.displayName||t.name)}}function isGeneratorIterator(e){if(e&&e.next){var t=e.constructor.constructor;return"GeneratorFunction"===(t.displayName||t.name)}}function spawn(e){var t,n,r="function"==typeof e?e():e;return function e(){for(;;){var i=r[n?"throw":"next"](t);if(i.done)return i.value;t=i.value;try{if(t&&t.next&&isGeneratorIterator(t)&&(t=spawn(t)),t&&t.then){var o=null,a=t.then(function(r){if(t=r,n=!1,!1===o)return e();o=!0},function(r){return t=r,n=!0,e()});if(!o)return o=!1,a}n=!1}catch(e){n=!0,t=e}}}()}return lang.isGenerator=isGenerator,lang.spawn=spawn,lang},__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(e,t,n){(function(r){var i,o,a;o=[n(0)],void 0===(a="function"==typeof(i=function(e){var t,n,i={},o=e.WeakMap,a=e.Map,s=e.Set,u=e.setPrototypeOf,c=Object.getPrototypeOf||function(e){return e.__proto__},l=e.isGenerator,f=3,p=4,h={name:"Not modified",toString:function(){return"Marker for not-modified response"}},d={getTyped:!0},v={getTyped:!0,allowUntyped:!0},y={ensureValidType:!0},m=new e.WeakMap(null,"propertyListenersMap"),g=(new e.WeakMap,Date.now()),b=(e.compose(o,function(){},{_propertyChange:function(e){this.variable._propertyChange(e,contextFromCache(this))}}),1);function w(e,t,n){return e&&e.then?e.then(t,n):t(e)}function O(e,t){this.subject=e,t&&(this.notifies=t)}function _(e,t){this.subject=t,this.listener=e}function x(){this.visited=new s}function C(e){this.visited=e?e.visited:new s}function j(e,t,n){this.key=e,this.propertyEvent=t,this.parent=n,this.visited=t.visited}function E(e,t,n,r,i){this.visited=new s,this.modifier=e,this.items=t,this.removed=n,this.start=r,this.deleteCount=i}function S(e,t,n){this.entryEvent=n,this.visited=n.visited,this.key=e,this.value=t}function P(e,t){this.key=e,this.value=t,this.visited=new s}function V(e,t){this.key=e,this.value=t,this.visited=new s}function T(e,t,n){var r;return t.then(function(i){if(!1!==r)r=!0;else{if(e.promise!==t)return;e.promise=null}n?n(i):e.value=i},function(n){if(!1!==r)r=!0;else{if(e.promise!==t)return;e.promise=null}e.error=n}),r||(r=!1,e.promise=t),t}function k(e){if(!(this instanceof k))return k.with(e);e!==n&&(e&&e.then&&!e.notifies?T(this,e):this.value=e)}O.prototype={constructor:O,newContext:function(e){return new this.constructor(this.subject,this.notifies)},executeWithin:function(e){var n=t;try{return t=this,e()}finally{t=n}},version:1,restart:function(){},contextualize:function(t,n){var r;if(this.distinctSubject){var i=t._contextMap||(t._contextMap=new e.WeakMap);if(!(r=i.get(this.distinctSubject))){i.set(this.distinctSubject,r=Object.create(t)),r.listeners=!1,r.context=this;for(var o=this.sources,a=0,s=o.length;a<s;a++)r[o[a]]=o[++a]}this.contextualized=r,n&&n.merge(this)}else r=t;return r},setVersion:function(e){if(isNaN(e))throw new Error("Bad version");return this.version=Math.max(this.version,e)},merge:function(e){this.distinctSubject||(this.distinctSubject=e.distinctSubject)},specify:function(e){var t,n=this.subject,r=n.constructor.ownedClasses;if(r){this.distinctSubject||(this.distinctSubject=n);var i=r.get(e);if(i)return(t=i.get(n))||i.set(n,t=i.createInstance?i.createInstance(n):new e),t}return e.defaultInstance},getContextualized:function(e){if(!this.subject)return e;var t=e._contextMap&&this.subject&&e._contextMap.get(this.subject);return t&&t.context&&t.context.matches(this)?t:void 0},matches:function(e){return e.subject===this.subject}},_.prototype=Object.create(O.prototype),_.prototype.constructor=_,x.prototype.type="replaced",C.prototype.type="replaced",j.prototype.type="property",E.prototype.type="spliced",S.prototype.type="entry",S.prototype.doesAffect=function(e){return this.value.constructor.for(e).id.valueOf()==this.value.id.valueOf()},P.prototype.type="deleted",V.prototype.type="added",V.prototype.doesAffect=function(){return!1},k._logStackTrace=function(e){var t=((new Error).stack||"").split(/[\r\n]+/);t[0]&&/^Error\s*/.test(t[0])&&t.shift(),t[0]&&/_logStackTrace/.test(t[0])&&t.shift();var n=this._debugOpts&&this._debugOpts.coalesce||[];if(this._debugOpts&&this._debugOpts.shortStackTrace)t.some(function(e){n.some(function(t){return t.re.test(e)})||(e=t[0])}),console.log("Variable "+e.__debug+" changed",a&&a.replace(/^\s+/,""));else{if(n.length){for(var r,i=[],o=0;o<t.length;o++){var a=t[o];if(r){if(r.test(a))continue;r=null}n.some(function(e){return e=e.re.test(a)}),a=a.replace(/^\s+/,""),r?(i.push("("+r.name+") "+a),r=r.re):i.push(a)}t=i}var s=this._debugOpts&&this._debugOpts.stackObject;s?console.log("Variable "+e.__debug+" changed",t):console.log("Variable "+e.__debug+" changed\r\n"+t.join("\r\n"))}},k._debugOpts={coalesce:[{name:"alkali",re:/\/alkali\//},{name:"Promise",re:/(Promise\.)|(PromiseArray\.)|(\/bluebird\/)/}],stackObject:!1};var M=k.prototype={constructor:k,valueOf:function(e){var t=this.gotValue(this.getValue());return!e&&t&&t.then?n:t},then:function(n,r){var i=this.valueOf(!0),o=i&&i.then;if(o||(i=new e.SyncPromise(i)),n||r){if(o&&t){var a=t;return i.then(n&&function(e){return a.executeWithin(function(){return n(e)})},r&&function(e){return a.executeWithin(function(){return r(e)})})}return i.then(n,r)}return i},getValue:function(e){t&&t.setVersion(e?this.version:Math.max(this.version||0,this.versionWithChildren||0));var r,i=this.key;if(null!=i&&null!=(r=this.parent)){var o;if(t&&null!=t.ifModifiedSince&&(t.ifModifiedSince=n),(o=r.getValue?r.getValue(!0):r.value)&&o.then&&!o.notifies)return w(o,function(e){var t=null==e?n:"function"==typeof e.property?e.property(i):"function"==typeof e.get?e.get(i):e[i],r=m.get(e);return r&&r.observer&&r.observer.addKey&&r.observer.addKey(i),t});var a=null==o?n:"function"==typeof o.property?o.property(i):"function"==typeof o.get?o.get(i):o[i],s=m.get(o);return s&&s.observer&&s.observer.addKey&&s.observer.addKey(i),a}if(this.promise)return this.promise;var a=this.value;return a!==n?this.value:this.default},gotValue:function(e){var r=this.returnedVariable,i=this;if(r){if(e===r)return t&&t.ifModifiedSince>0&&(t.ifModifiedSince=n),e.valueOf(!0);i.listeners&&r.stopNotifies(i),i.returnedVariable=null}if(e&&e.notifies&&(i.returnedVariable=e,i.listeners&&e.notifies(i),t&&t.ifModifiedSince>0&&(t.ifModifiedSince=n),e=e.valueOf(!0)),e&&e.then){var o=t;return e.then(function(e){return e&&(e.__variable&&(e=e.__variable),e.subscribe)?o?o.executeWithin(function(){return k.prototype.gotValue.call(i,e)}):k.prototype.gotValue.call(i,e):e})}return e},PropertyClass:k,property:function(e,t){var r=this[e];if(r&&r.notifies||(r=this._properties&&this._properties[e]),r){if(t&&!(r instanceof t))throw new TypeError("Existing property variable does not match requested variable type")}else{var i=t;i||"function"==typeof(i=this.constructor[e])&&i.isPropertyClass||(i=this.PropertyClass),(r=new i).key=e,r.parent=this,this[e]===n?this[e]=r:(this._properties||(this._properties={}))[e]=r}return r},for:function(e){return e&&e.target&&!e.constructor.getForClass&&(e=e.target),this.parent?this.parent.for(e).property(this.key):new F(this,e||Z)},get isWritable(){return this.fixed?!this.value||this.value.isWritable:this._isWritable},set isWritable(e){this._isWritable=e},_isWritable:!0,_propertyChange:function(e,t,n){this.onPropertyChange&&this.onPropertyChange(e,t),this.updated(new j(e,new C,this))},eachKey:function(e){for(var t in this._properties)e(t);for(var t in this)if(this.hasOwnProperty[t]){var n=this[t];n&&n.parent==this&&n.listeners&&e(t)}},apply:function(e,t){return new D(t[0],this,t)},call:function(e){return this.apply(e,Array.prototype.slice.call(arguments,1))},forDependencies:function(e){this.returnedVariable&&e(this.returnedVariable),this.hasNotifyingChild&&function e(t,n,r){for(var i in t===n&&e(t,t._properties,r),n){var o=n[i];if(o&&o.parent==t&&(o.returnedVariable&&r(o.returnedVariable),o.hasChildNotifiers)){var a=o._properties;a&&e(o,o,r)}}}(this,this,e),this.parent&&e(this.parent)},init:function(){var e=this,t=[];return this.forDependencies(function(n){var r=n.notifies(e);t.push(r)}),null===this.listeningToObject&&this.valueOf(),this},cleanup:function(){this.listeners=!1;var e=this.handles;if(e)for(var t=0;t<e.length;t++)e[t].remove();this.handles=null,this.returnedVariable;var n=this;this.forDependencies(function(e){e.stopNotifies(n)})},version:0,versionWithChildren:0,updateVersion:function(e){var t=256*(Date.now()-15e11);t>g&&(g=t),this.version=g++},getVersion:function(){return Math.max(this.version,this.returnedVariable&&this.returnedVariable.getVersion?this.returnedVariable.getFullVersion(t):0,this.parent?this.parent.getVersion(t):0)},getFullVersion:function(){return Math.max(this.versionWithChildren,this.getVersion())},getSubject:function(e){return this.subject},getUpdates:function(e){var t=[],n=this.nextUpdateMap;if(n&&e)for(;e=n.get(e);)"replaced"===e.type&&(t=[]),t.push(e);return t},_initUpdate:function(e,t){if(!e.version){var n=256*(Date.now()-15e11);n>g&&(g=n),e.version=g++}return e instanceof j?this.versionWithChildren=e.version:t||(this.version=e.version),e},updated:function(e,t,n){if(e||((e=new C).source=this),e.visited.has(this))return e;e.visited.add(this),this.__debug&&k._logStackTrace(this),this._initUpdate(e,n);var r=this.listeners;if(r){var i=this;r=r.slice();for(var o=0,a=r.length;o<a;o++){var s=r[o];e instanceof j&&s.parent?s.key===e.key&&s.updated(e.propertyEvent,i):s.updated(e,i,!0)}}if(e instanceof j){this.returnedVariable&&this.fixed&&this.returnedVariable.updated(e,this);var u=this.constructor,i=this;u.collection&&u.collection.updated(new S(this.id,this,e))}return this.parent&&this.parent.updated(new j(this.key,e,this.parent),this),this.collection&&this.collection.updated(e,this),e},invalidate:function(){this.updated()},notifies:function(e){if(!e)throw new Error("No listener provided for notification");var t=this.listeners;if(!t||!this.hasOwnProperty("listeners")){var n=this.init();return n.listeners=t=[e],n}return-1===t.indexOf(e)&&t.push(e),this},subscribe:function(t){var n,r,i=this;if("function"==typeof t){var i=this,o={value:function(){return new O(null,!0).executeWithin(function(){return i.valueOf(!0)})}};n=function(){r=!1,t(o)}}else{if(!t.next)throw new Error("Subscribing to an invalid listener, the listener must be a function, or have an update or next method");n=function(){r=!1,i.then(function(e){t.next(e)},function(e){t.error(value)})}}var a={updated:function(){r||(r=!0,e.nextTurn(n))}};return n(),this.notifies(a),{unsubscribe:function(){i.stopNotifies(a)}}},stopNotifies:function(e){var t=this.listeners;if(t){var n=t.indexOf(e);n>-1&&(t.splice(n,1),0===t.length&&this.cleanup())}},put:function(e,t){if(this.parent&&this.key!==n)return N(this,f,e,t);var r=this.getValue?this.getValue():this.value;if(r===e&&"object"!=typeof e)return i;if(r&&r.put&&r.notifies&&(this.fixed||!(e&&e.put&&e.notifies)))try{return r.put(e)}catch(e){if(!e.deniedPut)throw e}return e&&e.then&&!e.notifies?e=T(this,e):(this.value=e,e&&e.put&&(this.copiedFrom=e)),(t=t||new C).oldValue=r,t.target=this,this.updated(t,this),e},get:function(e){if(this[e]||this._properties&&this._properties[e])return this.property(e).valueOf(!0);var t=this.getValue();if(t){if("function"==typeof t.get)return t.get(e);var n=t[e];return n&&n.notifies?n.valueOf(!0):n}},set:function(e,t,n){N(this.property(e),p,t,n)},undefine:function(e){this.set(e,n)},is:function(e,t){if(this.parent){var n=this.parent,r=this.key,i=n.getValue?n.getValue(!0):n.value,o=new j(r,t||new C,n);return i?(i[r]=e,this.updated(o,this)):((i="number"==typeof r?[]:{})[r]=e,n.is(i,o)),this}return this.fixed=!0,this.value=e,this.updated(new C,this),this},proxy:function(e){return this.is(e)},next:function(e){this.put(e)},error:function(e){var t=this.listeners;t&&t.forEach(function(t){t.error(e)})},complete:function(e){this.put(e)},save:function(){return!!this.copiedFrom&&(this.copiedFrom.put(this.valueOf()),!0)},onValue:function(e){return this.subscribe(function(t){w(t.value(),function(t){e(t)})})},toJSON:function(){return this.valueOf()},toString:function(){return String(this.valueOf())},to:function(e,t){if("function"!=typeof e)throw"object"==typeof e&&this.to(e.get,e.set),new Error("No function provided to transform");return t&&(e.reverse=function(e,n){return t.call(this,e,n[0])}),e.prototype instanceof k?new e(this):new(this._Transform||D)(this,e)},map:function(e){return this.to(function(t){if(t instanceof Array)throw new Error("map without VArray");return e(t)})},as:function(e){var t=new e(this);return t.fixed=!0,t},whileResolving:function(e,t){return e||arguments.length>0?new WhileResolving(this,e,t):new WhileResolving(this,n,!0)},validate:function(e,t){if(this.returnedVariable)return this.returnedVariable.validate(e,t);if(this.parent)return this.parent.validate(e.valueOf(),t);if(t){if(t.type&&t.type!==typeof e)return["Target type of "+typeof e+" does not match schema type of "+t.type];if(t.required&&(null==e||""==e||"number"==typeof e&&isNaN(e)))return["Value is required"]}var n=[];return n.isValid=!0,n},set structured(e){for(var t=Object.keys(this),n=t.length>1&&this._properties||(this._properties={}),r=0,i=t.length;r<i;r++){var o=t[r],a=this[o];if(a instanceof k){var s=n[o];if(s)s!==a&&s.put(a);else{if(a.parent){if(a.parent===this)continue;var u=new k;u.proxy(a),a=u}a.key=o,a.parent=this,n[o]=a}}}},observeObject:function(){var t=this;return w(this.valueOf(),function(r){var i=m.get(r);if(i||m.set(r,i=[]),i.observerCount)i.observerCount++;else{i.observerCount=1;var o=i.observer=e.observe(r,function(e){for(var t=0,n=i.length;t<n;t++)for(var o=i[t],a=0,s=e.length;a<s;a++){var u=e[a];o._propertyChange(u.name,r)}});if(o.addKey)for(var a=0,s=i.length;a<s;a++){var u=i[a];u.eachKey(function(e){o.addKey(e)})}}return function(e,t){var r=m.get(e),i=t.listenerId||(t.listenerId="-"+b++);r?r[i]===n&&(r[i]=r.push(t)-1):(m.set(e,r=[t]),r[i]=0,k.autoObserveObjects&&observe(e)),t.listeningToObject=e}(r,t),{remove:function(){!function(e){if(e.listeningToObject){var t=e.listeningToObject;e.listeningToObject=null;var n=m.get(t);if(n){var r=n[e.listenerId];r>-1&&(n.splice(r,1),delete n[e.listenerId])}}}(r),--i.observerCount||i.observer.remove()},done:function(){e.deliverChanges(o),this.remove()}}})},getCollectionOf:function(){return this.collectionOf||this.returnedVariable&&this.returnedVariable.collectionOf||this.constructor.collectionOf},_sN:function(e){return this.name=e,this},get _debug(){return this.__debug===n&&(this.__debug=this.name||(Math.random()+"").slice(2)),this.__debug},set _debug(e){this.__debug=e}};function N(t,n,r,o){var a=t.key,s=t.parent;if(!s)return t.put(r,o);var u=s.getValue?s.getValue(!0):s.value;if(null!=u){if("object"!=typeof u){var c=new Error("Can not set property on non-object");throw c.deniedPut=!0,c}var l="function"==typeof u.get?u.get(a):u[a];if(l===r&&"object"!=typeof r)return i}if(!u||"function"!=typeof u.set){if(n==f&&l&&l.put&&!r&&r.put)return l.put(r,o);if(r&&r.then&&!r.notifies)return r.then(function(e){return N(t,n,e,o)});var p=null==u?"number"==typeof a?[]:{}:s.isWritable?e.copy(u.constructor===Object?{}:u.constructor===Array?[]:Object.create(Object.getPrototypeOf(u)),u):u;p[a]=r,o=o||new C;var h=new j(a,o,t);return h.oldValue=l,h.target=t,w(p===u?s.updated(h,t):s.put(p,h),function(){t.updated(o,t)})}u.set(a,r,o),t.updated(o,t);var d=m.get(u);if(d){d=d.slice(0);for(var v=0,y=d.length;v<y;v++){var g=d[v];g!==s&&g.updated(o)}}return r}for(var R in Object.defineProperties(M,{"=":{get:function(){return this.valueOf(!0)},set:function(e){this.put(e)},enumerable:!0},_lastUpdated:{get:function(){return new Date(this.getVersion()/256+15e11)}},schema:{get:function(){if(this.returnedVariable)return this.returnedVariable.schema;if(this.parent){var e=this.parent.schema.properties||this.parent.schema;return e&&e[this.key]}return this.constructor},set:function(e){Object.defineProperty(this,"schema",{value:e})}},validation:{get:function(){var e=new z(this);return Object.defineProperty(this,"validation",{value:e}),e},set:function(e){Object.defineProperty(this,"validation",{value:e})}}}),M)Object.defineProperty(k,R,Object.getOwnPropertyDescriptor(M,R));function A(e,t){return w(e.cachedValue||e.valueOf(!0),function(r){var i=e.valueOf(d),o=r?e.isWritable?r.slice(0):r:[];return t.call(e,o,function(t,a,s){if(t<0&&(t=o.length+t),t===o.length)var u=!0;var c=[t,a],l=o.splice.apply(o,c.concat(s)),f=e.collectionOf;if(i&&f){var p=s;(s=s.map(function(t){return(t=t instanceof f?t:f.from(t)).parent=e,t})).untypedItems=p,l=i.slice(t,a+t)}var h=new E(e,s,l,t,a);u&&(h.atEnd=!0);var d=s.length;if(d>0)for(var v=o.length-d;v>t;){var y=e[--v];y&&(e[v]=n,y.key+=d,e[y.key]=y)}return w(o===r?e.updated(h,e):e.put(o,h),function(){if(i&&(e._typedVersion=e.version,l=i.splice.apply(i,c.concat(s)),e.isWritable))for(var n=t;n<i.length;n++)i[n].key=n;return e.cachedVersion=e.version,l})})})}k.as=function(e){var t=this.with({}),n=t.prototype,r=e.prototype;do{for(var i=Object.getOwnPropertyNames(r),o=0;o<i.length;o++){var a=i[o];Object.getOwnPropertyDescriptor(n,a)||Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(r,a))}r=c(r)}while(r&&r!==k.prototype);return t},k.with=function(t,n){var r=this;return!1===Object.getOwnPropertyDescriptor(this,"prototype").writable?(n=e.extendClass(this)).prototype:(n||(n=function(){if(!(this instanceof n))return n.with(t);r.apply(this,arguments)}),(n.prototype=Object.create(this.prototype)).constructor=n,u(n,this)),n.assign(t)},k.assign=function(t){var r=this.prototype;function i(e){return"object"==typeof e?e instanceof Array?e[0]?U.of(i(e[0])):U:k.with(e):"string"==typeof e?te(e):"number"==typeof e?ne(e):"boolean"==typeof e?re(e):"function"==typeof e?e:k}if("object"!=typeof t)return this.prototype.default=t,this;for(var o in t){var a=(u=Object.getOwnPropertyDescriptor(t,o)).value;if("function"==typeof a||this.isPrimitive||(a=i(a)).prototype.default!==n&&(r.hasOwnProperty("default")||(r.default=r.default?Object.create(r.default):{}),r.default[o]=a.prototype.default),"function"==typeof a&&"collectionOf"!==o){if(a.notifies){function s(e,t){return{get:function(){var n=(this._properties||(this._properties={}))[e];return n||(this._properties[e]=n=new t,n.key=e,n.parent=this,n.listeners&&n.init()),n},set:function(t){N(this[e],p,t)},enumerable:!0}}var u=s(o,a);Object.defineProperty(r,o,u);try{Object.defineProperty(this,o,u)}catch(e){console.warn("Unable to define property",o)}continue}if(l(a))u=fe(a);else if(a.defineAs){if(!(u=a.defineAs(o,this)))continue}else a=J(a,o)}Object.defineProperty(r,o,u),a!==n?(o in this?Object.defineProperty(this,o,{value:a,configurable:!0,enumerable:!0}):this[o]=a,r.default):Object.defineProperty(this,o,u)}return t&&t.hasOwn&&function(t,n){var r=this.ownedClasses||(this.ownedClasses=new e.WeakMap);return r.set(t,n||function(){return new t}),this}.call(this,t.hasOwn),this},Object.defineProperty(k,"defaultInstance",{get:function(){return this.hasOwnProperty("_defaultInstance")?this._defaultInstance:(this._defaultInstance=new this,this._defaultInstance.subject=Z,this._defaultInstance)}}),k.hasOwn=function(t,n){var r=new e.WeakMap;r.createInstance=n,(this.ownedClasses||(this.ownedClasses=new e.WeakMap)).set(t,r)},"undefined"!=typeof Symbol&&(k.prototype[Symbol.iterator]=function(){var e=this.valueOf(v)[Symbol.iterator](),t=this,n=this.collectionOf;if(n){var r=0;return{next:function(){var i=e.next();return i.done||(i.value=t.property(r++,n)),i}}}return e});var I=k.VMap=e.compose(k,function(e){void 0!==e&&(this.value=e)},{fixed:!0,isWritable:!1,property:function(e,t){var n=this._properties||(this._properties=new a),r=n.get(e);return r||((r=new(t||this.PropertyClass)).key=e,r.parent=this,r.listeners&&r.init(),n.set(e,r)),r}}),D=k.Transform=e.compose(k,function(e,t,r,i){if((e!==n||r)&&(this.source=e),t&&(this.transform=t,r))for(var o=1,a=r.length;o<a;o++)this["source"+o]=r[o];i&&(this.dontCache=!0)},{getTransform:function(){return this.transform&&this.transform.valueOf()},getValue:function(){if("invalidated"==this.readyState)this.readyState=g.toString();else if(isFinite(this.readyState));else if((this.listeners&&"up-to-date"===this.readyState||this.staysUpdated)&&this.cachedVersion>0)return t&&(t.setVersion(this.cachedVersion),t.ifModifiedSince>=this.cachedVersion&&!this.returnedVariable)?h:this.promise||this.cachedValue;var e,r=this.readyState,i=t,o=t=t?t.newContext():new O;try{this.version&&o.setVersion(this.version),this&&this.cachedVersion==this.version&&this.cachedVersion>0&&!this.hasOwnProperty("source1")&&(o.ifModifiedSince=this.cachedVersion);for(var a,s,u,c=this.getTransform(),l=[],f=1,p=this,d=function(e){return l[this.__index||0]=e,0==--f?b():this.__previousPromiseResult},v=0;(a=this[s=v>0?"source"+v:"source"])||s in this;v++)if(a){var m=a.valueOf(y);m&&m.then?(f++,u=0===v?m.then(d):m.then(d.bind({__index:v,__previousPromiseResult:u}))):l[v]=m}else l[v]=a;if(0==--f)return b();function b(){o.ifModifiedSince!==n&&(o.ifModifiedSince=n);var t=o.version;if(p.cachedVersion>=t||l[0]==h)return i&&i.setVersion(t),i&&i.ifModifiedSince>=t&&i.ifModifiedSince>=p.cachedVersion&&!p.returnedVariable?h:p.promise||f(p.cachedValue);var a=c?c.apply(p,l):l[0],s=a&&a.then&&!a.notifies;if(t=o.version,s){p.promise&&p.promise.abort&&(p.promise.replacedResolutionWith=a,p.promise.abort("Cancelled due to updated value being available")),p.readyState!==r||p.dontCache||(p.cachedVersion=t);var u=p.promise=a=a.then(function(e){return u===p.promise&&(p.promise=null,d(e,o.version)),e},function(e){if(u===p.promise)p.promise=null,p.lastError=e,d(null,0);else if(u.replacedResolutionWith)return u.replacedResolutionWith;throw e})}else d(a,t);return f(a);function f(t){return e&&t&&t.notifies?{__variable:t}:t}function d(e,t){p.readyState!==r||p.dontCache||(i&&i.setVersion(t),p.cachedVersion=t,p.cachedValue=e,p.readyState=(p.listeners||p.staysUpdated||i&&i.notifies)&&0!==t?"up-to-date":"")}}return e=!0,u.abort&&(u.abort=null),u}finally{i&&i.setVersion(o.version),t=i}},forDependencies:function(e){var t,n;k.prototype.forDependencies.call(this,e);for(var r=0;(t=this[n=r>0?"source"+r:"source"])||n in this;r++)t&&t.notifies&&e(t)},updated:function(e,t,n){if(this.readyState="invalidated",this.promise&&!this.promise.abort&&(this.cachedVersion>0&&(this.cachedVersion=0),this.promise=null),t!==this.returnedVariable&&e&&"replaced"!==e.type)for(var r,i,o=0;(r=this[i=o>0?"source"+o:"source"])||i in this;o++)r!==t||(e=new C(e));return k.prototype.updated.call(this,e,t,n)},cleanup:function(){"up-to-date"!==this.readyState||this.staysUpdated||(this.readyState=""),k.prototype.cleanup.call(this)},getUpdates:function(e){if(!e||e.version<getVersion())return[new C]},getArguments:function(){for(var e,t,n=[],r=0;(e=this[t=r>0?"source"+r:"source"])||t in this;r++)n.push(e);return n},put:function(e,t){var n=this;return function(e,t){return e&&e.then&&!e.notifies?e.then(t):t(e)}(this.getValue(),function(r){if(r===e&&"object"!=typeof e)return i;var o=n.transform.valueOf();if(o.reverse)return o.reverse.call(n,e,n.getArguments()),n.updated(t);if(r&&r.put)return r.put(e,t);var a=new Error("Can not put value into a one-way transform, that lacks a reversal");throw a.deniedPut=!0,a})},setReverse:function(e){return this.transform.valueOf().reverse=e,this}});Object.defineProperty(D.prototype,"isWritable",{get:function(){return this.transform&&!!this.transform.reverse}}),WhileResolving=e.compose(D,function(e,t,r){this.source=e,t!==n&&(this.default=t),r&&(this.useLastValue=!0)},{fixed:!0,getValue:function(){var e=D.prototype.getValue.call(this);if(e&&e.then){var t=this.version,n=this;return e.then(function(e){t===n.version&&(k.prototype.updated.call(n),n.cachedVersion=n.version)},function(e){console.error("Variable resolution failed",e),t===n.version&&(k.prototype.updated.call(n),n.cachedVersion=n.version,n.cachedValue="Error occurred: "+e,n.readyState="up-to-date")}),this.useLastValue&&"cachedValue"in this?this.cachedValue:this.default}return e},put:function(e,t){return this.source.put(e,t)}});var W=e.compose(D,function(){D.apply(this,arguments)},{getValue:function(){var e=t?t.getContextualized(this):this;return e&&e!==this?e.getValue():D.prototype.getValue.call(this)},_needsContextualization:!0}),L=e.compose(k,function(e,t){this.value=e,this.collection=t},{}),F=e.compose(k,function(e,t){this.generic=e,this.subject=t},{valueOf:function(){var e=this.subject,t=e.getContextualized?e:new O(e),n=this.generic;return t.executeWithin(function(){return n.valueOf()})},forDependencies:function(e){this.sources&&this.sources.forEach(e)},getVersion:function(){for(var e=k.prototype.getVersion.call(this),t=this.sources||0,n=0,r=t.length;n<r;n++){var i=t[n];i.getFullVersion&&(e=Math.max(e,i.getFullVersion()))}return e},put:function(e,t){return this.subject,this.generic.put(e,t)}}),U=e.compose(k,function e(t){return q(this,t,e)},{valueOf:function(e){var t=k.prototype.valueOf.call(this,e),n=this;return w(t,function(t){if(e&&e.getTyped){if(!e.allowUntyped)return;if(!t)return[]}else if(!t)return e&&e.ensureValidType?[]:t;if(n.sortFunction&&n._sortedArray!=t){var r=n.reversed,i=n.sortFunction;n.sortFunction=null,t=n.sort(i),r&&n.reversed()}return t})},forEach:function(e,t){return w(this.valueOf(v),function(n){n.forEach(e,t)})},splice:function(e,t){var n=arguments;return A(this,function(r,i){return i(e,t,[].slice.call(n,2))})},push:function(){var e=arguments;return A(this,function(t,n){return w(n(t.length,0,[].slice.call(e)),function(e){return t.length})})},unshift:function(){var e=arguments;return A(this,function(t,n){return w(n(0,0,[].slice.call(e)),function(e){return t.length})})},pop:function(){return A(this,function(e,t){return w(t(e.length-1,1,[]),function(e){return e[0]})})},shift:function(){return A(this,function(e,t){return w(t(0,1,[]),function(e){return e[0]})})},sort:function(e){var t=this;return w(this.valueOf(!0),function(n){var r=t.valueOf(d);if(r){for(var i=[],o=n.length,a=0;a<o;a++)i.push({typed:r[a],untyped:n[a]});i.sort(function(t,n){return e(t.typed,n.typed)}),n.splice(0,n.length),n.push.apply(n,i.map(function(e){return e.untyped})),t._typedArray=i.map(function(e){return e.typed})}else n.sort(e);return t.source&&(t.sortFunction=e,t._sortedArray=n,t.reversed&&(t.reversed=!1)),t.updated(),t.cachedVersion=t.version,t._typedArray&&(t._typedVersion=t.version),n})},reverse:function(){var e=this;return w(this.valueOf(v),function(t){return t.reverse(),e.source&&(e.reversed=!e.reversed),e.updated(),t})},slice:function(e,t){return w(this.valueOf(!0),function(n){return n.slice(e,t)})},indexOf:function(e){var t=this.valueOf(v);return t.indexOf(e)},includes:function(e){return this.indexOf(e)>-1},for:function(e){if(this.source)return this.source.for(e);var t=this.indexOf(e),n=this.valueOf(),r=new this.collectionOf.from(n[t]||{});return r.id=e,r},add:function(e){-1===this.indexOf(e)&&this.push(e)},delete:function(e){var t=this.indexOf(e);return t>-1&&this.splice(t,1),this},clear:function(){this.is([])},has:function(e){return this.indexOf(e)>-1}});function B(e){var t=[];return e.forEach&&e.forEach(function(e){t.push(e)}),t}Object.defineProperty(U.prototype,"length",{get:function(){if("function"!=typeof this){var e=this._properties||(this._properties={});if(!e.length){var t=e.length=new ne;return t.key="length",t.parent=this,Object.defineProperty(this,"length",{configurable:!0,value:t}),t}}},configurable:!0,set:function(e){this.value.length=e}}),U.of=function(e){var t=oe({collectionOf:e});return this!==U?new t:t};var H=e.compose(D,function(e){this.generator=e},{transform:{valueOf:function(){var e,r=t;return function t(){var i,o,a,s;if(e){if(a=e.iterator,o=e.i,(i=e.value)&&i.then)throw new Error("Generator resumed with promise or variable",i);s=e.isThrowing}else r&&r.restart(),o=0,a=this.generator();for(;;){var u=a[s?"throw":"next"](i);if(u.done){for(var c=this.sources||[],f=o,p=[];this[h=o>0?"source"+o:"source"];)this[h]=n,o++;for(o=0;o<f;o++){var h=o>0?"source"+o:"source";this[h]&&this[h].notifies&&p.push(this[h])}for(o=0;o<c.length;o++)-1==p.indexOf(c[o])&&c[o].stopNotifies(this);return this.sources=p,u.value}i=u.value;try{var h=o>0?"source"+o:"source";if(this[h]===i&&this[h]!==n||(i&&i.notifies?(this.listeners&&i.notifies(this),this[h]=i):"function"==typeof i&&l(i)?(e={i:o,iterator:i()},t.call(this),o=e.i):this[h]=null),o++,i&&i.then){var d=this;e={i:o,iterator:a};var v=null,y=i.then(function(n){return!1!==v?(v=!0,void(i=n)):(e.value=n,r?r.executeWithin(t.bind(d)):t.call(d))},function(n){return e.value=n,e.isThrowing=!0,r?r.executeWithin(t.bind(d)):t.call(d)});if(!v)return v=!1,y}s=!1}catch(e){s=!0,i=e}}}}}}),z=e.compose(D,function(e){this.source=e},{transform:function(e){var e=this.source;return e&&e.validate(e,e.schema)}});function q(e,t,n){if(!(e instanceof k))return n.with(t);k.call(e,t)}var K={apply:function(e,t){return t},reverse:function(e,t){return t.map(function(t,n){return t.put(e[n])})}};function G(e,t){if(e instanceof Array)return e.length>0||"function"==typeof t?new D(e[0],"function"==typeof t?t:K,e,!0):new U([]);if(arguments.length>1)return new D(arguments[0],K,arguments,!0).as(U);if("object"==typeof e){var n=[],r=[];for(var i in e)n.push(i),r.push(e[i]);return new k(function(e){for(var t={},r=0;r<e.length;r++)t[n[r]]=e[r];return t}).apply(null,r)}throw new TypeError("Variable.all requires an array")}function Y(e,t,n){return"function"==typeof e.value?{value:J(n,t)}:e}function J(e,t){var n=e[t]=function(){var n=e.for(this);return n[t].apply(n,arguments)};return n.for=function(n){var r=e.for(n);return function(){return r[t].apply(r,arguments)}},n}var Z={name:"Default context",description:"This object is the default context for classes, corresponding to a singleton instance of that class",constructor:{getForClass:function(e,t){return t.defaultInstance}},contains:function(){return!0}};function X(e,t){if(!t)return e.defaultInstance;var n=t.specify(e);return t.instanceMap||(t.instanceMap=new a),t.instanceMap.set(e,n),n}k.valueOf=function(e){return X(this,t).valueOf(e)},k.then=function(e,n){return X(this,t).then(e,n)},k.getValue=function(e){return X(this,t).getValue(e)},k.put=function(e){return X(this,t).put(e)},k.for=function(e){var t;return null!=e?"object"!=typeof e?this.collection.for(e):(e.target&&!e.constructor.getForClass&&(e=e.target),(t=new O(e).specify(this))&&!t.subject&&(t.subject=e),t||this.defaultInstance):this.defaultInstance},k.from=function(t){if(t&&"object"==typeof t){var n=this.instanceMap||(this.instanceMap=new e.WeakMap),r=n.get(t);return r||n.set(t,r=new this(t)),r}return new this(t)},k.notifies=function(e){var n=X(this,t);return n.notifies(e),n},k.stopNotifies=function(e){this.defaultInstance.stopNotifies(e)},k.getCollectionOf=function(){return this.collectionOf},k.updated=function(e,n){return X(this,t).updated(e,n)},k._Transform=W,["add","delete","clear","filter","map","forEach","slice","push","splice","pop","shift","unshift"].forEach(function(e){k[e]=function(){return this.collection[e].apply(this.collection,arguments)},U[e]=U.prototype[e]}),k.default=function(e){return k.with({default:e})};var Q={get:function(e,t){var r=e[t];return r===n?e.property(t):r},set:function(e,t,n){var r=e[t];return r&&r.put?r.put(n):e.set(t,n),!0},has:function(e,t){return t in e||t in e.valueOf()},deleteProperty:function(e,t){return Q.set(e,t,n)},ownKeys:function(e){return Object.getOwnPropertyNames(e.valueOf())}};function $(){}function ee(){}function te(e){return q(this,"object"==typeof e||e===n?e:String(e),te)}function ne(e){return q(this,"object"==typeof e||e===n?e:Number(e),ne)}function re(e){return q(this,"object"==typeof e?e:Boolean(e),re)}function ie(t){return q(this,t instanceof Array?new e.Set(t):t,ie)}k.proxy=function(e){return new Proxy(e instanceof this?e:this.from(e),Q)},Object.defineProperty(k,"collectionOf",{get:function(){return this._collectionOf},set:function(e){this._collectionOf!=e&&(this._collectionOf=e,e.collection=this)}}),Object.defineProperty(k,"collection",{get:function(){return this.hasOwnProperty("_collection")?this._collection:(this.collection=new oe,this.collection.fixed=!0,this.collection)},set:function(e){this.hasOwnProperty("_collection")&&this._collection==e||(this._collection=e,e.collectionOf=this)}}),k.generalize=function(){for(var e=this.prototype,t=Object.getOwnPropertyNames(e),n=0,r=t.length;n<r;n++){var i=t[n];Object.defineProperty(this,i,Y(Object.getOwnPropertyDescriptor(e,i),i,this))}},k.call=Function.prototype.call,k.apply=Function.prototype.apply,$.returns=function(e){function t(){}return t.defineAs=function(t){return{value:function(){var r=arguments;return new e(new D(this,function(e){return null==e?n:e[t].apply(e,r)}))},writable:!0,configurable:!0}},t},ee.defineAs=function(e){return{value:function(){var t=arguments,n=this;return w(this.valueOf(),function(r){r&&r[e]||(r=new n.constructor.wrapsType(r));var i=r[e].apply(r,t);return w(n.put(r),function(){return i})})},writable:!0,configurable:!0}},(te=k.with({charAt:$.returns(te),codeCharAt:$.returns(ne),indexOf:$.returns(ne),lastIndexOf:$.returns(ne),match:$.returns(U),replace:$.returns(te),substr:$.returns(te),slice:$.returns(te),toUpperCase:$.returns(te),toLowerCase:$.returns(te),replace:$.returns(te),toString:function(){return this.valueOf()||""}},te)).prototype.type="string",te.isPrimitive=!0,(ne=k.with({toFixed:$.returns(te),toExponential:$.returns(te),toPrecision:$.returns(te),toLocaleString:$.returns(te)},ne)).prototype.type="number",ne.isPrimitive=!0,(re=k.with({},re)).prototype.type="boolean",re.isPrimitive=!0,ie=k.with({has:function(e){return this.to(function(t){return t&&t.has?t.has(e):!(!t||!t.indexOf)&&t.indexOf(e)>-1}).as(re)},add:ee,clear:ee,delete:ee},ie),Object.defineProperty(ie.prototype,"array",{get:function(){return this._array||(this._array=this.to(B).as(U))}}),ie.wrapsType=e.Set;var oe=e.compose(U,function e(t){return q(this,t,e)},{valueOf:function(e){var n=t,r=t=t?t.newContext():new O,i=k.prototype.valueOf.call(this,e);r.setVersion(this.version);var o=this;try{return w(i,function(t){if(!e||!e.getTyped)return t;if(!t)return[];var n=o.getCollectionOf();if(!n||o._typedArray&&o._typedVersion>=r.version||(o._typedArray=t.map(function(e,t){return e instanceof n||((e=n===k?ue.reactive(e):n.from(e)).parent||(e.parent=o),o.isWritable&&(e.key=t)),e}),o._typedVersion=r.version),t=o._typedArray||e.allowUntyped&&t,o.sortFunction&&o._sortedArray!=t){var i=o.reversed,a=o.sortFunction;o.sortFunction=null,t=o.sort(a),i&&o.reversed()}return t})}finally{n&&n.setVersion(r.version),t=n}},property:function(e,t){if(this._typedArray){var n=this._typedArray[e];return n.key=e,n}return k.prototype.property.call(this,e,t||"number"==typeof e&&this.collectionOf)},indexOf:function(e){var t=this.valueOf()||[],n=this.collectionOf;if(n.prototype.getId){for(var r=e&&e.getId?e.getId():e,i=0,o=t.length;i<o;i++)if(t[i].getId()==r)return i;return-1}return t.indexOf(e&&e.valueOf())}});function ae(e){return q(this,"object"==typeof e?e:new Date(e),ae)}(ae=k.with({toDateString:$.returns(te),toTimeString:$.returns(te),toGMTString:$.returns(te),toUTCString:$.returns(te),getTime:$.returns(ne),setTime:ee},ae)).wrapsType=Date;var se=e.compose(k,function e(t){return q(this,t,e)},{valueOf:function(){return this.then()}}),ue={__esModule:!0,Variable:k,VArray:U,default:k,VString:te,VNumber:ne,VBoolean:re,VPromise:se,VDate:ae,VSet:ie,VMap:I,GeneratorVariable:H,Transform:D,deny:{},noChange:i,Context:O,Item:L,NotifyingContext:_,all:G,react:function(e,t){if("function"!=typeof e)throw new Error("react() must be called with a generator.");return t&&t.reverse&&(e.reverse=t.reverse),new H(e)},delayUpdate:function(e,t){var n=e.updated;e.updated=function(){var e=n.apply(this,arguments);e.visited.enqueueUpdate=function(e){t.then(e)}}},objectUpdated:function(e){var t=m.get(e);if(t)for(var n=0,r=t.length;n<r;n++)t[n]._propertyChange(null,e)},NOT_MODIFIED:h,_changeValue:N,getNextVersion:function(){var e=256*(Date.now()-15e11);return e>g&&(g=e),g++},ReplacedEvent:C,AddedEvent:V,DeletedEvent:P,UpdateEvent:x};Object.defineProperty(ue,"currentContext",{get:function(){return t},set:function(e){t=e}});var ce=e.compose(D,function(e,t){},{transform:function(){var e=this.source.valueOf(v),t=this.method;return"string"==typeof t?this.hasOwnProperty("source2")?[][t].call(e,this.source1.valueOf(),this.source2):[][t].call(e,this.source1.valueOf()):t(e,[this.source1.valueOf(),this.source2])},_mappedItems:function(e){var t=this.source,n=t&&t.collectionOf;return n?e.map(function(e,r){var i=n.from(e);return i.collection=t,i}):e},slice:function(e,t){return w(this.valueOf(!0),function(n){return n.slice(e,t)})},getCollectionOf:function(){return this.source.getCollectionOf()}});function le(t,n,r,i,o){var a=e.compose(i?i.as(ce):ce,n,r);a.prototype.method||(a.prototype.method=t),Object.defineProperty(a.prototype,"isIterable",{value:!0}),(o=o||U)[t]=o.prototype[t]=function(e,t){var n=new a(this);return n.source=this,n.source1=e,t&&(n.source2=t),n}}le("filter",function(e){},{updated:function(e,n,r){if(!e||e.modifier===this||e.modifier&&e.modifier.constructor===this)return D.prototype.updated.call(this,e,n);var i=t&&t.getContextualized(this)||this,o=this.source1.valueOf();if("spliced"!==e.type){if("entry"===e.type){var a=e.value,s=i.cachedValue.indexOf(a),u=[a].filter(o).length>0;if(s>-1){if(u)return k.prototype.updated.call(this,e,n,r);A(i,function(e,t){t(s,1,[])})}else u&&A(i,function(e,t){t(e.length,0,[a])});return}return D.prototype.updated.call(this,e,n,r)}for(var c=[],l=e.items,f=0;f<l.length;f++)o.call(l,l[f],f)&&(l.untypedItems?c.push(l.untypedItems[f]):c.push(l[f]));var p,h,d=e.removed.filter(o);if(d.length>1)return D.prototype.updated.call(this,new C(e));if(1==d.length){if(!d[0].parent)return D.prototype.updated.call(this,new C(e));p=i.cachedValue.indexOf(d[0]),h=1}else p=e.atEnd?i.cachedValue.length:0,h=0;A(i,function(e,t){t(p,h,c)})},transform:function(){var e=this.source.valueOf(v),t=this.source,n=[],r=this.source1.valueOf();return w(e,function(e){var i=t.valueOf();return e.forEach(function(e,t){r(e,t)&&n.push(i[t])},this.source2),n})},push:function(e){return this.source.push.apply(this.source,arguments)},unshift:function(e){return this.source.unshift.apply(this.source,arguments)},pop:function(e){return w(this.valueOf(),function(e){return e.length&&this.source.remove(e[e.length-1])})},shift:function(e){return w(this.valueOf(),function(e){return e.length&&this.source.remove(e[0])})},splice:function(e){throw new Error("Not supported yet")},getCollectionOf:function(){return this.source.getCollectionOf()}},oe),le("map",function(e){},{updated:function(e,n,r){if(!e||e.modifier===this||e.modifier&&e.modifier.constructor===this)return k.prototype.updated.call(this,e,n);var i=t&&t.getContextualized(this)||this;if("spliced"===e.type)this.splice.apply(this,[e.start,e.deleteCount].concat(e.items.map(this.source1.valueOf())));else if("property"===e.type){if(this.getCollectionOf())return;var o=e.parent.valueOf(),a=i.cachedValue,s=e.key;if(e.value,s>-1?o[s]:s=a&&a.map&&a.indexOf(o),!(s>-1))return D.prototype.updated.call(this,e,n,r);i.splice(s,1,this.source1.valueOf().call(this.source2,this.source.property(s)))}else{if("entry"!==e.type)return D.prototype.updated.call(this,e,n,r);if(this.getCollectionOf())return}}},U),le("reduce",function(){}),le("reduceRight",function(){}),le("some",function(){},{},re),le("every",function(){},{},re),le("join",function(){},{},te),le("keyBy",function(e,t){},{property:I.prototype.property,method:function(e,t){for(var n=new a,r=t[0],i=t[1],o="function"==typeof r,s="function"==typeof i,u=!!r,c=0,l=e.length;c<l;c++){var f=e[c];n.set(o?r(f,p):u?f[r]:f,s?i(f):f)}function p(e,t){n.set(e,t)}return n}}),le("groupBy",function(e,t){},{property:I.prototype.property,method:function(e,t){for(var n=new a,r=t[0],i=t[1],o="function"==typeof r,s="function"==typeof i,u=!!r,c=0,l=e.length;c<l;c++){var f=e[c],p=o?r(f):u?f[r]:f,h=n.get(p);h||n.set(p,h=[]),h.push(s?i(f):f)}return n}});var fe=k.getGeneratorDescriptor=function(t){var n;return{get:function(){n||(n=new e.WeakMap);var r=n.get(this);return r||n.set(this,r=new H(t.bind(this))),r},enumerable:!0}};k.all=G,k.Context=O;var pe=void 0!==r?r:window;return(pe.devtoolsFormatters||(pe.devtoolsFormatters=[])).push({header:function(e,t){if(e&&e instanceof k){var n=Object.assign({},e);n[Symbol.toStringTag]=e.constructor.name;var r=e.version/256+15e11;return["span",{},"","invalidated"===e.readyState?" invalidated ":"object"==typeof e.valueOf()?["object",{object:e.valueOf()}]:["span",{}," = "+e],["object",{object:n}],["span",{}," ("+(e.version?new Date(r)[Date.now()-r>3e7?"toLocaleString":"toLocaleTimeString"]():"")+(e.listeners?" live)":")")]]}return null},hasBody:function(e){return!1},body:function(e){var t=e.version/256+15e11,n=["div",{},["div",{},"version: "+(t&&new Date(t).toLocaleString())],["div",{},"readyState: "+e.readyState]];e.valueOf()&&n.push(["div",{},["object",{object:e.valueOf()}],"(value)"]),e.listeners&&n.push(["div",{},["object",{object:e.listeners}],"(listeners)"]);for(var r=0;e["source"+(r||"")];)n.push(["div",{},["object",{object:e["source"+(r||"")]}],["div",{float:"left"},"(source "+r+")"]]),r++;return n}}),ue})?i.apply(t,o):i)||(e.exports=a)}).call(this,n(2))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r,i,o;i=[n(0),n(1)],void 0===(o="function"==typeof(r=function(e,t){"undefined"!=typeof document&&document;var n,r,i=[],o=1,a=e.requestAnimationFrame,s=t.Context;function u(e){var t=e.variable;if(this.variable=t,e.selector&&(this.selector=e.selector),e.getElements)this.getElements=e.getElements;else{if(!e.element)throw new Error("No element provided to Renderer");var n=this.element=e.element;(n.alkaliRenderers||(n.alkaliRenderers=[])).push(this)}if(e.update&&(this.updateRendering=e.update),e.shouldRender&&(this.shouldRender=e.shouldRender),e.renderUpdate&&(this.renderUpdate=e.renderUpdate),e.alwaysUpdate&&(this.alwaysUpdate=e.alwaysUpdate),!1===e.updateOnStart){var r=this.contextualized||this.variable;this.variable.valueOf(this),r.notifies(this)}else n?this.updateRendering(!0):this.variable.notifies(this)}function c(e){u.call(this,e)}function l(e){e.name&&(this.name=e.name),c.apply(this,arguments)}function f(e){e.name&&(this.name=e.name),c.apply(this,arguments)}function p(e){e.element&&"SELECT"===e.element.tagName&&"value"===e.name&&(this.renderUpdate=this.renderSelectValueUpdate),f.apply(this,arguments)}function h(e){e.name&&(this.name=e.name),c.apply(this,arguments)}function d(e){c.apply(this,arguments)}function v(e){this.position=e.position,this.textNode=e.textNode,c.apply(this,arguments)}function y(e){e.each&&(this.each=e.each),c.apply(this,arguments)}function m(e){if(e.alkaliRenderers)for(var t=e.alkaliRenderers,n=0;n<t.length;n++){var r=t[n];r.variable.stopNotifies(r)}}return u.prototype={constructor:u,version:0,notifies:!0,updateRendering:function(){throw new Error("updateRendering must be implemented by sub class of Renderer")},updated:function(t,n,r){if(!this.invalidated){if(this.getElements){this.variable;var i=this.invalidated||(this.invalidated=new e.Set);this.getElements().forEach(function(e){t.doesAffect&&!t.doesAffect(e)||i.add(e)})}else this.invalidated=!0;this.deferredRender&&(this.deferredRender.isCanceled=!0,this.deferredRender=null);var o=this;(t.visited.enqueueUpdate||a)(function(){!0===o.invalidated?o.updateRendering(o.alwaysUpdate,o.element):o.invalidated&&o.invalidated.forEach(function(e){o.updateRendering(o.alwaysUpdate,e)})})}},executeWithin:s.prototype.executeWithin,setVersion:function(){},newContext:function(){return new s(this.element,!0)},getContextualized:function(e){return s.prototype.getContextualized.call(this,e)},specify:function(e){return this.contextualized=s.prototype.specify.call(this,e)},merge:function(){},contextMatches:function(e){return!0},invalidateElement:function(t){n||(n=new WeakMap(null,"invalidated"));var o=n.get(t);n.set(t,o={}),o[id]||(o[id]=!0),r||(e.queueTask(processQueue),r=!0);var a=this;i.push(function(){a.invalidated=!1,a.updateElement(t)})},getId:function(){return this.id||(this.id=o++)},stop:function(){(this.contextualized||this.variable).stopNotifies(this),this.builtList&&(this.builtList=!1,this.omitValueOf=!1)},restart:function(){this.updateRendering(!0)},isSameProperty:function(e){return e.constructor===this.constructor&&e.name===this.name}},Object.defineProperty(u.prototype,"subject",{get:function(){return this.element}}),c.prototype=Object.create(u.prototype),c.prototype.shouldRender=function(e){return document.body.contains(e)},c.prototype.getSubject=function(){return this.element},c.prototype.updateRendering=function(e,t){if(!t&&this.elements){var n=this.elements;if(!n.length){if(!this.selector)throw new Error("No element or selector was provided to the Renderer");return void(n=document.querySelectorAll(this.selector))}for(var r=0,i=n.length;r<i;r++)this.updateRendering(e,n[r])}else{var o=t||this.element;if(e||this.shouldRender(o))this.updateElement(o);else{var a=this.getId(),s=o.renderersOnShow;s||(s=o.renderersOnShow=[],o.className+=" needs-rerendering"),s[a]||(s[a]=this)}}},c.prototype.addElement=function(e){this.selector?e.renderersOnShow=[this]:this.elements.push(e),this.updateElement(e)},c.prototype.updateElement=function(e){if(this.invalidated=!1,this.omitValueOf)return this.started=!0,void this.renderUpdate(void 0,e);var t,n,r=e.constructor._generalized,i=e===this.element?this:Object.create(this,{element:{value:e}});if(i.executeWithin(function(){n=i.variable.then(function(o){if(t=!0,!(n&&(n===i.deferredRender&&(i.deferredRender=null),n.isCanceled)||i.invalidated)){if(i.contextualized&&i.contextualized!==i.variable&&i.contextualized.stopNotifies(i),r){var a=i.toString();r[a]||(r[a]=!0,(i.contextualized=i.variable).notifies(i))}else i.executeWithin(function(){i.contextualized=i.variable.notifies(i)});(void 0!==o||i.started)&&(i.started=!0,i.renderUpdate(o,e))}},function(e){console.error("Error rendering",i,e)})}),!t){if(r){var o=i.toString();r[o]||(r[o]=!0,(i.contextualized=i.variable).notifies(i))}else i.executeWithin(function(){i.contextualized=i.variable.notifies(i)});this.deferredRender=n,this.renderLoading&&this.renderLoading(n,e)}},c.prototype.renderUpdate=function(e,t){throw new Error("renderUpdate(newValue) must be implemented")},u.Renderer=u,u.ElementRenderer=c,l.prototype=Object.create(c.prototype),l.prototype.type="AttributeRenderer",l.prototype.renderUpdate=function(e,t){"boolean"==typeof e||null==e?e?t.setAttribute(this.name,""):t.removeAttribute(this.name):t.setAttribute(this.name,e)},u.AttributeRenderer=l,f.prototype=Object.create(c.prototype),f.prototype.type="PropertyRenderer",f.prototype.renderUpdate=function(e,t){t[this.name]=e},u.PropertyRenderer=f,p.prototype=Object.create(f.prototype),p.prototype.type="InputPropertyRenderer",p.prototype.renderUpdate=function(e,t){(null==e||"number"===t.type&&isNaN(e))&&(e="");var n=t[this.name];"string"==typeof n&&"string"!=typeof e&&(e=null==e?"":String(e)),n!=e&&(t[this.name]=e)},p.prototype.renderSelectValueUpdate=function(t,n){n.value=t,n.value==t||n.value?n.eventualValue=void 0:(n.eventualValue=t,e.nextTurn(function(){n.eventualValue&&(n.value=n.eventualValue,n.eventualValue=void 0)}))},u.InputPropertyRenderer=p,h.prototype=Object.create(c.prototype),h.prototype.type="StyleRenderer",h.prototype.renderUpdate=function(e,t){t.style[this.name]=e},u.StyleRenderer=h,d.prototype=Object.create(c.prototype),d.prototype.type="ContentRenderer",d.prototype.renderUpdate=function(e,t){t.innerHTML="",void 0===e&&(e=""),t.appendChild(document.createTextNode(e))},u.ContentRenderer=d,v.prototype=Object.create(c.prototype),v.prototype.type="TextRenderer",v.prototype.updated=function(e,t){this.builtList&&("replaced"===e.type?(this.builtList=!1,this.omitValueOf=!1):(this.updates||(this.updates=[])).push(e)),c.prototype.updated.call(this,e,t)},v.prototype.renderUpdate=function(e,t){null==e&&(e=""),e.create&&(e=e.create({parent:t})),e.nodeType?(this.textNode&&this.textNode.parentNode==t?t.replaceChild(e,this.textNode):t.appendChild(e),this.textNode=e):e instanceof Array?(this.renderUpdate=y.prototype.renderUpdate,this.omitValueOf=!0,this.renderUpdate(e,t)):(this.textNode||t.childNodes[this.position]).nodeValue=e},u.TextRenderer=v,y.prototype=Object.create(c.prototype),y.prototype.updated=function(e,t){this.builtList&&("replaced"===e.type?(this.builtList=!1,this.omitValueOf=!1):(this.updates||(this.updates=[])).push(e)),c.prototype.updated.call(this,e,t)},y.prototype.type="ListRenderer",y.prototype.renderUpdate=function(e,t){var n=this.each||function(e){return e},r=this.element,i=this;if(this.builtList){a=this.childElements;var o=this.updates;o.forEach(function(e){if("replaced"===e.type){i.builtList=!1;for(var t=0,n=a.length;t<n;t++)r.removeChild(a[t]);i.updateElement(r)}else if("spliced"===e.type){for(e.start,t=0;t<e.deleteCount;t++)r.removeChild(a[e.start+t]);for(a.splice(e.start,e.deleteCount),t=0;t<e.items.length;t++){var o=e.items[t],s=a[t+e.start],c=u.append(r,l(o));s?(r.insertBefore(c,s),a.splice(t+e.start,0,c)):a.push(c)}}else e.type}),this.updates=[]}else{this.builtList=!0,this.omitValueOf=!0,t.innerHTML="";var a=this.childElements=[];if(n.defineHasOwn&&n.defineHasOwn(),e){var s=function(e){a.push(u.append(r,l(e)))},c=this.variable;c.collectionOf?this.executeWithin(function(){c.forEach(s)}):e.forEach(s)}(this.contextualized||this.variable).notifies(this)}function l(e){var t;return n.create?t=n.create({parent:r,_item:e}):(t=n(e,r)).create&&(t=t.create({parent:r,_item:e})),t}},u.ListRenderer=y,u.onShowElement=function(e){a(function(){n=null;var t=[].slice.call(e.getElementsByClassName("needs-rerendering"));if(e.className.indexOf("needs-rerendering")>0){var r=[e];r.push.apply(r,t),t=r}for(var i=0,o=t.length;i<o;i++){var a=t[i],s=a.renderersOnShow;if(s)for(var u in a.renderersOnShow=null,a.className=a.className.replace(/\s?needs\-rerendering\s?/g,""),s)s[u].updateElement(a)}})},u.onElementRemoval=function(e,t){t||m(e);for(var n=e.getElementsByTagName("*"),r=0,i=n.length;r<i;r++){var o=n[r];o.alkaliRenderers&&m(o)}},u})?r.apply(t,i):r)||(e.exports=o)},function(e,t,n){var r,i,o;i=[n(1)],void 0===(o="function"==typeof(r=function(e){var t=e.VBoolean,n=e.VNumber,r={},i={};function o(e){return r[e]||(r[e]=new Function("a","b","return "+e))}function a(t,n,r,a,s,u,c){var l=function(e,t){var n,r=t[0],i=t[1];if(r&&r.put)try{return r.put(u(e,i&&i.valueOf()))}catch(e){if(!e.deniedPut)throw e;n=e}if(!i||!i.put)throw n&&n.message?n:new Error("Can not assign change value to constant operators");i.put(c(e,r&&r.valueOf()))},f={apply:function(n,r){return s=o(s),u=u&&o(u),c=c&&o(c),s.reverse=l,i[t]=f=new e.Variable(s),p(f),r=Array.prototype.slice.call(r),f.apply(n,r)}};function p(e){e.precedence=a,e.infix=!1!==c}p(f),i[t]=f,i[r]=function(){var e=f.apply(null,arguments);return n?e.as(n):e}}return a("+",n,"add",6,"a+b","a-b","a-b"),a("-",n,"subtract",6,"a-b","a+b","b-a"),a("*",n,"multiply",5,"a*b","a/b","a/b"),a("/",n,"divide",5,"a/b","a*b","b/a"),a("?",null,"if",16,"b[a?0:1]","a===b[0]||(a===b[1]?false:(function(){throw new Error()})())","[a,b]"),a(":",null,"choose",15,"[a,b]","a[0]?a[1]:(function(){throw new Error()})()","a[1]"),a("!",t,"not",4,"!a","!a",!1),a("%",n,"remainder",5,"a%b"),a(">",t,"greater",8,"a>b"),a(">=",t,"greaterOrEqual",8,"a>=b"),a("<",t,"less",8,"a<b"),a("<=",t,"lessOrEqual",8,"a<=b"),a("===",t,"strictEqual",9,"a===b"),a("==",t,"equal",9,"a==b"),a("&",t,"and",8,"a&&b"),a("|",t,"or",8,"a||b"),a("nint",n,"round",8,"Math.round(a*Math.pow(10,b||1)/Math.pow(10,b||1))","a","a"),i})?r.apply(t,i):r)||(e.exports=o)},function(e,t,n){(function(r){var i,o,a;o=[n(6),n(3),n(7),n(8),n(4),n(1),n(0),n(9)],void 0===(a="function"==typeof(i=function(e,t,n,i,o,a,s,u){var c=Object.create(e);c.Copy=i,c.Element=e,s.copy(c,a),Object.defineProperty(c,"currentContext",Object.getOwnPropertyDescriptor(a,"currentContext")),c.reactive=n,s.copy(c.react,n),c.spawn=s.spawn,c.Renderer=t.ElementRenderer,s.copy(c,t),s.copy(c,o),c.ContextualPromise=u,c.default=n;var l="undefined"==typeof window?r:window;return l.alkali&&console.warn("Multiple instances of alkali have been defined, which can cause alkali context instances to be out of sync"),l.alkali=c})?i.apply(t,o):i)||(e.exports=a)}).call(this,n(2))},function(e,t,n){var r,i,o;i=[n(0),n(3),n(1)],void 0===(o="function"==typeof(r=function(e,t,n){var r,i=n.Variable,o=/^(\.|#)([-\w]+)(.+)?/,a=e.isGenerator,s=n.Context,u=t.PropertyRenderer,c=t.InputPropertyRenderer,l=t.AttributeRenderer,f=e.compose(t.StyleRenderer,function(){t.StyleRenderer.apply(this,arguments)},{renderUpdate:function(e,t){var n=S[this.name];n?n(t,e,this.name):t.style[this.name]=e}}),p="undefined"!=typeof Reflect?Reflect.construct:function(e,t,n){return e.apply(Object.create(n.prototype),t)},h=e.constructOrCall,d=e.compose(t.ElementRenderer,function(e){this.name=e.name,t.apply(this,arguments)},{renderUpdate:function(e,t){var n=t.className,r=this.name,i=n&&(" "+n+" ").replace(" "+r+" "," ");(r=e?n?(i+r).slice(1):r:i.slice(1,i.length-1))!=n&&(t.className=r)}}),v=e.compose(t.ElementRenderer,function(e){this.PropertyRenderer=e.PropertyRenderer,t.apply(this,arguments)},{renderUpdate:function(e,t){var n=[];for(var r in e)this.PropertyRenderer.prototype.renderUpdate.call({name:r},e[r],t),n.push(r);var i=this.lastProperties;if(i)for(var o=0,a=i.length;o<a;o++){var r=i[o];r in e||this.PropertyRenderer.prototype.renderUpdate.call({name:r},void 0,t)}this.lastProperties=n}}),y=t.TextRenderer,m=t.ListRenderer,g="undefined"!=typeof document?document:{createElement:function(e){return{}},addEventListener:function(){}},b={INPUT:1,TEXTAREA:1},w=!1,O=g.createElement("font"),_=O.constructor;function x(e){return function(t,n,r){"string"!=typeof n&&(n=e[n?0:1]),t.style[r]=n}}function C(e,t,n){"number"==typeof t&&(t+="px"),e.style[n]=t}function j(e,t,n){e.style[n]=t}O.constructor=function(){},g.createElement("font").constructor==O.constructor&&(O.__proto__.constructor=_,w=!0,e.buggyConstructorSetter=w);var E,S={display:x(["","none"]),visibility:x(["visible","hidden"]),color:j,opacity:j,zoom:j,minZoom:j,maxZoom:j,fontWeight:j,position:x(["absolute",""]),textDecoration:x(["underline",""]),fontWeight:j};["alignContent","alignItems","alignSelf","animation","animationDelay","animationDirection","animationDuration","animationFillMode","animationIterationCount","animationName","animationPlayState","animationTimingFunction","backfaceVisibility","background","backgroundAttachment","backgroundBlendMode","backgroundClip","backgroundColor","backgroundImage","backgroundOrigin","backgroundPosition","backgroundPositionX","backgroundPositionY","backgroundRepeat","backgroundRepeatX","backgroundRepeatY","backgroundSize","baselineShift","border","borderBottom","borderBottomColor","borderBottomLeftRadius","borderBottomRightRadius","borderBottomStyle","borderBottomWidth","borderCollapse","borderColor","borderImage","borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth","borderLeft","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRadius","borderRight","borderRightColor","borderRightStyle","borderRightWidth","borderSpacing","borderStyle","borderTop","borderTopColor","borderTopLeftRadius","borderTopRightRadius","borderTopStyle","borderTopWidth","borderWidth","bottom","boxShadow","boxSizing","bufferedRendering","captionSide","clear","clip","clipPath","clipRule","color","colorInterpolation","colorInterpolationFilters","colorRendering","counterIncrement","counterReset","cursor","direction","display","emptyCells","fill","fillOpacity","fillRule","filter","flex","flexBasis","flexDirection","flexFlow","flexGrow","flexShrink","flexWrap","float","floodColor","floodOpacity","font","fontFamily","fontFeatureSettings","fontKerning","fontSize","fontStretch","fontStyle","fontVariant","fontVariantLigatures","fontWeight","height","imageRendering","isolation","justifyContent","left","letterSpacing","lightingColor","lineHeight","listStyle","listStyleImage","listStylePosition","listStyleType","margin","marginBottom","marginLeft","marginRight","marginTop","marker","markerEnd","markerMid","markerStart","mask","maskType","maxHeight","maxWidth","maxZoom","minHeight","minWidth","minZoom","mixBlendMode","motion","motionOffset","motionPath","motionRotation","objectFit","objectPosition","opacity","order","orientation","orphans","outline","outlineColor","outlineOffset","outlineStyle","outlineWidth","overflow","overflowWrap","overflowX","overflowY","padding","paddingBottom","paddingLeft","paddingRight","paddingTop","page","pageBreakAfter","pageBreakBefore","pageBreakInside","paintOrder","perspective","perspectiveOrigin","pointerEvents","position","quotes","resize","right","shapeImageThreshold","shapeMargin","shapeOutside","shapeRendering","size","speak","src","stopColor","stopOpacity","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","tabSize","tableLayout","textAlign","textAlignLast","textAnchor","textCombineUpright","textDecoration","textIndent","textOrientation","textOverflow","textRendering","textShadow","textTransform","top","touchAction","transform","transformOrigin","transformStyle","transition","transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction","unicodeBidi","unicodeRange","userZoom","vectorEffect","verticalAlign","visibility","whiteSpace","widows","width","willChange","wordBreak","wordSpacing","wordWrap","writingMode","zIndex","zoom"].forEach(function(e){S[e]=S[e]||C});var P=new e.WeakMap,V=e.setPrototypeOf,T=Object.getPrototypeOf||function(e){return e.__proto__};function k(e){if(!E){var t=g.createElement("style");t.setAttribute("type","text/css"),g.head.insertBefore(t,g.head.firstChild),E=t.sheet}var n=E.cssRules||E.rules;return n[E.insertRule(e+" {}",n.length)]}function M(e,t,n,r){for(var i=t.length>1||r?g.createDocumentFragment():e,o=0,a=t.length;o<a;o++){var s,u=t[o];if(null!=u)if(u.notifies){var c=u.isIterable?i:e;i.appendChild(s=N(c,u))}else if("function"==typeof u)K=e,s=new u,i.appendChild(s),u.isContentNode&&(n.contentNode=s);else if("object"==typeof u)if(u instanceof Array)n=n||e,M((s=s||e).contentNode||s,u,n);else{if(!u.nodeType)throw new Error("Unknown child type "+u);i.appendChild(s=u)}else s=g.createTextNode(u),i.appendChild(s)}return i!=e&&(r?e.insertBefore(i,e.firstChild):e.appendChild(i)),s}function N(e,t){if(null==t)return g.createTextNode("");var n;if(t.notifies){n=g.createTextNode("");var r=new y({element:e,textNode:n,variable:t});n=r.textNode}else n=g.createTextNode(t);return n}function R(e,t,n){t&&t.notifies?(new c({name:n,variable:t,element:e}),(b[e.tagName]||"SELECT"===e.tagName)&&H(e,t,n)):"SELECT"===e.tagName&&"value"===n?c.prototype.renderSelectValueUpdate(t,e):("number"===e.type&&isNaN(t)&&(t=""),e[n]=t)}function A(){}var I={children:A,tagName:A,_generators:A,classes:function(e,t){if(t.notifies&&t.put)new v({PropertyRenderer:d,element:e,variable:t});else{var n;if(t.length>-1)n=!0;else{var r=0;for(var i in t)t[r]||(t[r]=i),r++;t.length=r}for(var r=0,o=t.length;r<o;r++){var a=t[r],s=t[a];s&&s.notifies?new d({element:e,name:a,variable:s}):(s||n)&&(e.className+=" "+a)}}},class:W,for:W,role:W,render:function(e,t,r,i){new u({name:r,variable:"function"==typeof t?new n.GeneratorVariable(t.bind(e,i)):t,element:e})},dataset:F(function(e,t,n){n=n||this.name,null==e?delete t.dataset[n]:t.dataset[n]=e}),attributes:F(function(e,t,n){l.prototype.renderUpdate.call({name:n||this.name},e,t)}),style:function(e,t,n){"string"==typeof t?e.setAttribute("style",t):t&&t.notifies?new l({name:"style",variable:t,element:e}):L(e,t,n)},_item:function(t,n){!function(t,n,r){var i=t.constructor,o=i.ownedClasses||(i.ownedClasses=new e.WeakMap),a=o.get(n);a||o.set(n,a=new e.WeakMap),(t.ownedInstances||(t.ownedInstances=new e.WeakMap)).set(n,r),a.set(t,r)}(t,n.constructor,n)}};["textContent","id","className","innerHTML","title","lang","hidden","translate","dir","tabIndex","accessKey","draggable","dropzone","spellcheck","contentEditable","innerText","translate","webkitdropzone"].forEach(function(e){I[e]=!0}),"undefined"!=typeof HTMLElement&&(HTMLElement.prototype._propertyHandlers=I);var D={input:e.copy(["accept","alt","autocomplete","autofocus","capture","defaultChecked","dirName","disabled","form","files","formAction","formEnctype","formMethod","formNoValidate","formTarget","indeterminate","inputMode","list","max","maxLength","min","minLength","multiple","name","pattern","placeholder","readOnly","required","size","src","step","type","defaultValue","willValidate","validity","validationMessage","useMap","autocapitalize","webkitdirectory","incremental","stepUp","stepDown"],{value:R,valueAsNumber:R,valueAsDate:R,checked:R,type:function(e,t){try{e.type=t}catch(e){}}}),select:e.copy(["disabled","name","size","type","selectedIndex","validationMessage"],{value:R}),textarea:e.copy(["cols","dirName","maxLength","minLength","name","placeholder","rows","wrap","type","defaultValue","textLength","validationMessage","autocapitalize"],{value:R}),a:["target","download","ping","rel","hreflang","type","referrerPolicy","href","media"],area:["target","download","coords","rel","hreflang","type","referrerPolicy","href","media","alt","shape"],button:["disabled","formAction","formEnctype","formMethod","formTarget","name","type","value","validationMessage"],details:["open"],dialog:["open"],embed:["src","type","name"],fieldset:["disabled","form","name"],form:["acceptCharset","action","autocomplete","enctype","encoding","method","name","target","novalidate"],frame:["name","scrolling","src","frameBorder"],frameset:["cols","rows"],iframe:["src","srcdoc","name","referrerPolicy","align","scrolling","frameBorder","longDesc"],img:["src","alt","crossorigin","ismap","longdesc","sizes","srcset","usemap","referrerpolicy"],option:["label","value","text","index"],optgroup:["label"],output:["name","type","defaultValue","value","validationMessage"],label:["htmlFor"],td:["colSpan","rowSpan"],th:["colSpan","rowSpan"],script:["src","type","charset","text","event","htmlFor","integrity"],style:["media","type"],track:["kind","src","srclang","label"],link:["href","rel","media","hreflang","type","charset","rev","target","integrity","as"],meta:["name","httpEquiv","content","scheme"],meter:["value","min","max","low","high","optimum"],progress:["value","max","position"],del:["cite","dateTime"],ins:["cite","dateTime"],source:["src","type","srcset","sizes","media"],video:["videoWidth","videoHeight","poster","webkitDecodedFrameCount","webkitDroppedFrameCount"],keygen:["challenge","keytype","name","type","validationMessage"],object:["data","type","name","useMap","validationMessage","archive","code","hspace","standby","vspace","codeBase","codeType"],param:["name","value","type","valueType"]};function W(e,t,n){t&&t.notifies?new l({name:n,variable:t,element:e}):e.setAttribute(n,t)}var L=F(function(e,t,n){t.style[n||this.name]=e});function F(t){var n=e.compose(u,function(e){u.apply(this,arguments)},{renderUpdate:t});return function(e,r,i){if(r.notifies&&r.put)new v({PropertyRenderer:n,variable:r,element:e});else for(var o in r){var a=r[o];a&&a.notifies?new n({name:o,variable:a,element:e}):t(a,e,o)}}}function U(e,t){var n=e._propertyHandlers,r=e.constructor;for(var i in t){var o,a=t[i],s=r[i];"function"==typeof s&&s.notifies&&s!==a&&(fe(r,s),s.for(e).put(a));var c=n[i];c?!0===c?a&&a.notifies?new u({name:i,variable:a,element:e}):e[i]=a:c(e,a,i,t):(o=S[i])?a&&a.notifies?new f({name:i,variable:a,element:e}):o(e,a,i):"function"==typeof a&&"on"===i.slice(0,2)?(null===e[i]||e["_registeredEvent_"+i]||(e["_registeredEvent_"+i]=!0,e.addEventListener(i.slice(2),function(e){this["on"+e.type](e)})),e[i]=a):null==e[i]?e[i]=a:Object.defineProperty(e,i,{value:a,enumerable:!0,configurable:!0,writable:!0})}}function B(e,t,n,r){var i=e.each||r.each;if(i&&t)if(i.create&&(i.defineHasOwn=function(){fe(i,de,function(e){var t=de.from(e._item);return t});var e=t.getCollectionOf&&t.getCollectionOf();e&&fe(i,e,function(t){var n=e.from(t._item);return n})}),t.notifies)new m({each:i,variable:t,element:e});else{var o=g.createDocumentFragment();i.defineHasOwn&&i.defineHasOwn(),t.forEach(function(t){i.create?childElement=i.create({parent:e,_item:t}):childElement=i(t,e),o.appendChild(childElement)}),e.appendChild(o)}else b[e.tagName]?function(e,t){var n=e.type,r=n in{date:1,datetime:1,time:1}?"valueAsDate":"checkbox"===n||"radio"===n?"checked":"value";t&&t.notifies?(new c({variable:t,name:r,element:e}),H(e,t,r,z)):e[r]=t}(e,t):t instanceof Array?M(e=e.contentNode||e,t,e):"function"==typeof t&&t.for?M(e=e.contentNode||e,[t],e):e.appendChild(N(e,t))}function H(t,r,i,o){e.nextTurn(function(){for(var e=t.inputEvents||["change","alkali-change"],a=0,u=e.length;a<u;a++)t.addEventListener(e[a],function(e){var a=t[i];new s(t).executeWithin(function(){var e=r.put(o?o(a,t):a);if(e===n.deny)throw new Error("Variable change denied")})})})}function z(e,t){return"number"==t.type?parseFloat(e):e}function q(e,t,n,r){var i=r[n];if(i)for(var o in t)i[o]=t[o];else r[n]=t}g.addEventListener("click",function(e){var t=e.target;if("radio"===t.type)for(var n=g.querySelectorAll("input[type=radio]"),r=0,i=n.length;r<i;r++){var o=n[r];o.name===t.name&&o!==t&&o.dispatchEvent(new Event("alkali-change",{}))}});var K,G={classes:q,_generators:q,dataset:q,attributes:q,style:q,hasOwn:function(e,t){fe(e,t)},children:function(e,t){e.children=t},shadow:function(e,t){e.shadow=t}};function Y(e,t){var n=t._applyOnCreate;if(e&&"object"==typeof e)if(e instanceof Array||e.notifies)n.content=e;else for(var r in e){var o=e[r],s=t[r];"function"==typeof o?o.notifies?(o===i&&(o=i()),t[r]?Object.defineProperty(t,r,{value:o,enumerable:!0}):t[r]=o):a(o)&&("get_"===r.slice(0,4)&&(r=r.slice(4)),(n._generators||(n._generators={}))[r]=o):o&&o.notifies&&(t[r]?Object.defineProperty(t,r,{value:o,enumerable:!0}):t[r]=o),G[r]?G[r](t,o,r,n):"function"==typeof s&&s.notifies?n[r]=new s(o):n[r]=o}else{if("function"==typeof e&&!e.for)throw new TypeError("Function as argument not supported");n.content=e}}function J(e){if(e.hasOwnProperty("_applyOnCreate"))return e._applyOnCreate;if(e.getForClass){var t=e._applyOnCreate={},n=J(T(e));for(var r in n)t[r]=G[r]?Object.create(n[r]):n[r];for(var i,o=e.prototype,s=Object.getOwnPropertyNames(o),u=0,c=s.length;u<c;u++){var r=s[u];if("on"===r.slice(0,2)||"render"===r&&a(o[r])){if(ne.disallowClassEventHandlers&&null===T(o)[r])throw new Error("Defining event handlers through class methods is not allowed (due to incompatibility with compiled code)");t[r]=o[r]}else if("render"===r.slice(0,6)){var l=r[6].toLowerCase()+r.slice(7);i||(i=o._propertyHandlers=Object.create(o._propertyHandlers)),i[l]=!0,Object.defineProperty(o,l,Z(r))}}return t}return null}function Z(t){var n=new e.WeakMap;return{get:function(){return n.has(this)?n.get(this):null},set:function(e){n.set(this,e),this[t](e)}}}function X(e,t){var n=function(e){var t=!e.with;if(Object.setPrototypeOf)for(;e.prototype.constructor!==e&&!e.hasOwnProperty("with");)e=T(e);var n=!1===Object.getOwnPropertyDescriptor(e,"prototype").writable;return h(e,t&&Q,X,n)}(this);this.with?(V(n,this),n.ownedClasses=null):(n.create=Q,n.with=X,n.defineElement=te,n.for=le,n.property=he,n.getForClass=pe),n.prototype=this.prototype;var r=n._applyOnCreate={},i=J(this);for(var a in i)r[a]=G[a]?Object.create(i[a]):i[a];var s=0;if("string"==typeof e){var u=e.match(o);if(u)do{var c=u[1],l=u[2];"."==c?r.className?r.className+=" "+l:r.className=l:r.id=l;var f=u[3];u=f&&f.match(o)}while(u);else r.content=e;s++}for(var p=arguments.length;s<p;s++)Y(arguments[s],n);return n}function Q(e,t){var r=J(this);if(K){var i=K;K=null}var a=this._ElementClass?p(this._BaseElementClass||HTMLElement,arguments,this._ElementClass):g.createElement(this.tagName);e&&e.parent&&(i=e.parent),i&&P.set(a,i),a instanceof this||V(a,this.prototype),a.constructor!=this&&(a.constructor=this);var s=arguments.length>0;if(s||a.created||a.ready){var u=r;for(var c in r={},u)r[c]=G[c]?Object.create(u[c]):u[c]}if(s){var l=0;if("string"==typeof e){l++;var f=e.match(o);if(f)do{var h=f[1],d=f[2];"."==h?r.className?r.className+=" "+d:a.className?a.className+=" "+d:a.className=d:r.id?r.id=d:a.id=d;var v=f[3];f=v&&v.match(o)}while(f);else r.content=e}else e&&e._item&&(a._item=e._item);for(var y=arguments.length;l<y;l++){var m=arguments[l];if(m&&"object"==typeof m)if(m instanceof Array||m.notifies)r.content=m;else for(var c in m)G[c]?G[c](this,m[c],c,r):r[c]=m[c];else"function"==typeof m&&m.for?r.content=m.for(a):r.content=m}}return a.created?r=a.created(r)||r:r.created&&(r=r.created.call(a,r)||r),U(a,r),r._generators&&function(e,t){var r,i,o,a=t._generators,s=e._propertyHandlers;for(var u in a){var c=new n.GeneratorVariable(a[u].bind(e,t));s[u]?(o||(o={}))[u]=c:S[u]?(i||(i={}))[u]=c:(r||(r={}))[u]=c}r&&U(e,r),i&&U(e,i),o&&U(e,o)}(a,r),this.children&&M(a,this.children,a),this.shadow&&M(a.attachShadow({mode:"open"}),this.shadow,a),null!=a.content&&B(a,a.content,0,r),a.ready&&a.ready(r),a}var $=[].slice;function ee(e){return this.nodeType?M(this,arguments,this):M(e,$.call(arguments,1),e)}function te(e,t){if(!t){if("string"!=typeof e)return e.with();t=this}var n=void 0===t.nativeTagName?t.tagName:t.nativeTagName,i=e.match(/[\.\#].+/),o=i?e.slice(0,e.length-(i=i[0]).length):e;if(n||(t.tagName=o),t.nativeTagName=n||null,"object"==typeof customElements){if(void 0===r){var a=function(){};customElements.define("alkali-test-support",a,{extends:"div"}),r=!1;try{p(HTMLDivElement,[],a),r=!0}catch(e){}}if(!n||r)try{(t._ElementClass=customElements.get(o))?console.warn("Element",o,"already registered"):(customElements.define(o,t,{extends:n}),t._ElementClass=t,n&&(t._BaseElementClass=customElements.get(n)||g.createElement(n).constructor))}catch(e){console.warn(e)}}return t.with||(t.with=X),ue(t,{selector:i,uniqueTag:!0})}var ne=ie("undefined"!=typeof HTMLElement?HTMLElement:function(){});ne.defineElement=te,ne.assign=function(e,t){if("function"==typeof e)J(e),Y(t,e);else{var n=e.alkaliRenderers,r=n?n.length:0;U(e,t);for(var i=n?n.length:0,o=r;o<i;o++)for(var a=0;a<r;a++)n[a].isSameProperty(n[o])&&(n[a].stop(),n.splice(a,1),a=-1,r--,i--)}},ne.within=function(e){},["Video","Source","Media","Audio","UL","U","Track","Title","TextArea","Template","TBody","THead","TFoot","TR","Table","Col","ColGroup","TH","TD","Caption","Sup","Sub","Style","Strong","Span","Small","Shadow","Select","Script","S","Quote","Progress","Pre","Picture","Param","P","Output","Option","Optgroup","Object","OL","Ins","I","Del","Meter","Meta","Menu","Map","Link","Legend","Label","LI","KeyGen","Input","Img","IFrame","H1","H2","H3","H4","H5","H6","Hr","FrameSet","Frame","Form","Font","FieldSet","Embed","Em","Code","Cite","Dfn","B","Article","Aside","Abbr","Footer","Figure","FigCaption","Header","Main","Mark","MenuItem","Nav","Section","Slot","Summary","WBr","Div","Dialog","Details","DataList","DL","DT","DD","Canvas","Button","Base","Br","Area","A"].forEach(function(e){var t;Object.defineProperty(ne,e,{get:function(){return t||(n=(n=e).toLowerCase(),t=re[n]||(re[n]=ie(g.createElement(n).constructor,n)));var n}})}),function(e){e.forEach(function(e){var t;Object.defineProperty(ne,e,{get:function(){return t||(t=ie(HTMLInputElement,"input",e.toLowerCase()))}}),Object.defineProperty(ne,e+"Input",{get:function(){return this[e]}})})}(["Checkbox","Password","Submit","Radio","Color","Date","DateTime","Email","Month","Number","Range","Search","Tel","Time","Url","Week"]);var re={};function ie(e,t,n){w&&(Object.defineProperty(e.prototype,"constructor",{get:function(){return this._constructor},set:function(e){this._constructor=e}}),e.prototype._constructor=e);var r=n?X.call(e,{type:n}):X.call(e),i=D[t];if(i&&!i.assigned){for(var o=r.prototype._propertyHandlers=Object.create(I),a=0,s=i.length;a<s;a++)o[i[a]]=!0;if(i.value)for(var a in i)a>-1||(o[a]=i[a]);i.assigned=!0}return r.tagName=t,r}var oe={Anchor:"A",Image:"Img",Paragraph:"P",Textarea:"TextArea",DList:"DL",UList:"UL",OList:"OL",ListItem:"LI",Text:"Input",TextInput:"Input",TableRow:"TR",TableCell:"TD",TableHeaderCell:"TH",TableHeader:"THead",TableBody:"TBody"};for(var ae in oe)!function(e,t){Object.defineProperty(ne,e,{get:function(){return this[t]}})}(ae,oe[ae]);function se(e){return{variable:e,then:function(e,t){return this.variable.then(e,t)},notifies:function(){},stopNotifies:function(){}}}function ue(e,t){t=t||{};var n,r=J(e),i={},o=e.prototype._propertyHandlers;for(var a in r){var s=r[a];if(s&&s.notifies&&!0===o[a])new u({name:a,variable:s.collection||s,getElements:function(){return t.uniqueTag?document.getElementsByTagName(v.tagName):ce(v,t.parent)}}),i[a]=se(s);else if(S[a])s&&s.notifies?(new f({name:a,variable:s.collection||s,getElements:function(){return t.uniqueTag?document.getElementsByTagName(v.tagName):ce(v,t.parent)}}),i[a]=se(s)):(n=n||k(t.uniqueTag?e.tagName:e.tagName+"."+r.className),S[a](n,s,a),i[a]=void 0);else if("style"===a&&s&&!s.notifies){for(var c in n=n||k(t.uniqueTag?e.tagName:e.tagName+"."+r.className),s)n.style[c]=s[c];i.style=void 0}}if(e._cssRule&&t.uniqueTag&&(e._cssRule.selectorText+=","+e.tagName),e.children){for(var l=[],p=0;p<e.children.length;p++){var h=e.children[p];if(h){if(h.notifies)throw new Error("Variables can not be used as child nodes in generalized/bound classes, consider wrapping with a span");"function"==typeof h&&(h=ue(h,{parent:t.parent}))}l[p]=h}i.children=l}var d=r.content;d&&(d.notifies?(new y({getElements:function(){return t.uniqueTag?document.getElementsByTagName(v.tagName):ce(v,t.parent)},variable:d.collection||d,position:0}),i.content=se(d)):d instanceof Array&&(i.content=d.map(function(e){if(e.notifies)throw new Error("Variables can not be used as child nodes in generalized/bound classes, consider wrapping with a span");return"function"==typeof e&&(e=ue(e,{parent:t.parent})),e})));var v=t.selector?e.with(t.selector,i):e.with(i);return n&&(v._cssRule=n),v}function ce(e,t){var n=e.tagName,r=e._applyOnCreate.className;return r&&(n+="."+r),[].filter.call((t||document).querySelectorAll(n),function(t){return t.constructor===e})}function le(e){return e.constructor.getForClass(e,this)}function fe(t,n,r){if("object"==typeof n){var i=t.ownedClasses||(t.ownedClasses=new e.WeakMap),o={get:function(){return n}};return i.set(n.constructor,o),fe(t,n.Class,n.createInstance)}if(n instanceof Array)return n.forEach(function(e){fe(t,e)});var i=t.ownedClasses||(t.ownedClasses=new e.WeakMap);if(!i.has(n)){var o=new e.WeakMap;o.createInstance=r,i.set(n,o)}return t}function pe(t,n){for(var r;t&&!(r=t.constructor.ownedClasses&&t.constructor.ownedClasses.get(n));)t=t.parentNode||P.get(t);if(r){var i=t.ownedInstances||(t.ownedInstances=new e.WeakMap),o=i.get(n);return void 0===o&&(i.set(n,o=r(t)),o.subject=t),o}}function he(e){return ThisElementVariable=this._Variable,ThisElementVariable||(ThisElementVariable=this._Variable=i(),fe(this,ThisElementVariable,function(e){var t;if(e.alkaliRenderers){for(var n={},r=0;r<e.alkaliRenderers.length;r++){var i=e.alkaliRenderers[r];i.name&&(n[i.name]={value:i.variable})}t=Object.create(e,n)}else t=e;var o=new ThisElementVariable(t);return o})),ThisElementVariable.property(e)}ne.append=ee,t.append=ee,ne.prepend=function(e){return this.nodeType?M(this,arguments,this,!0):M(e,$.call(arguments,1),e,!0)},ne.refresh=t.refresh,ne.options={moveLiveElementsEnabled:!0},ne.content=function(e){function t(){return new e}return t.isContentNode=!0,t},ne.ElementClass=function(){},"undefined"!=typeof Symbol&&Object.defineProperty(ne.ElementClass,Symbol.hasInstance,{value:function(e){return e&&e.create&&e.with}}),ne.extend=function(e,t){function n(){return e.apply(this,arguments)}V(n,e);var r=n.prototype=Object.create(e.prototype,{constructor:{value:n}});return Object.getOwnPropertyNames(t).forEach(function(e){var i=Object.getOwnPropertyDescriptor(t,e);G[e]?G[e](n,i.value,e,t):Object.defineProperty(r,e,i)}),n},ne.bindElementClass=ue;var de=ne.Item=n.Item,ve=[{name:"detached",nodes:"removedNodes",action:function(e){e.detached&&e.detached(),function(e){var t=e.alkaliRenderers;if(t){for(var n=0,r=t.length;n<r;n++)t[n].stop();e.needsRestart=!0}}(e)}},{name:"attached",nodes:"addedNodes",action:function(e){e.constructor.create&&(e.needsRestart&&function(e){var t=e.alkaliRenderers;if(t)for(var n=0,r=t.length;n<r;n++)t[n].restart();e.needsRestart=!1}(e),e.attached&&e.attached())}}];function ye(e,t){if("attached"===t.name)return!e.__alkaliAttached__&&(e.__alkaliAttached__=!0,t.action(e),!0);if(e.__alkaliAttached__){if(g.body.contains(e))return!1;e.__alkaliAttached__=!1,t.action(e)}return!0}if("function"==typeof MutationObserver){var me=new MutationObserver(function(e){for(var t=0,n=e.length;t<n;t++)for(var r=e[t],i=0,o=ve.length;i<o;i++){var a=ve[i],s=r[a.nodes];e:for(var u=0,c=s.length;u<c;u++){var l=s[u];if(ye(l,a)){var f=l.firstChild;if(f)for(;;){var p;if(1===f.nodeType&&ye(f,a)&&(p=f.firstChild)||(p=f.nextSibling),!p)do{if((f=f.parentNode)===l)continue e}while(!(p=f.nextSibling));f=p}}}}});me.observe(g.body||g,{childList:!0,subtree:!0})}else"undefined"!=typeof document&&setInterval(function(){for(var e=document.all,t=ve[1],n=0,r=e.length;n<r;n++)ye(e[n],t)},300);return e.copy(n.Context.prototype,{specify:function(e){var t=this.subject,n=!0;for((this.generics||(this.generics=[])).push(e);t;){this.distinctSubject===t&&(n=!1);var r=t.constructor.ownedClasses;if(r){var i=r.get(e);if(i)return n&&(this.distinctSubject=t),specifiedInstance=i.get(t),specifiedInstance||i.set(t,specifiedInstance=i.createInstance?i.createInstance(t):new e),specifiedInstance}t=t.parentNode||P.get(t)}return e.defaultInstance},getContextualized:function(e){var t=this.subject;if(!t)return e;if(e._contextMap)do{var n=e._contextMap.get(t);if(n&&n.context.matches(t))return n}while(t=t.parentNode||P.get(t));return e.context&&e.context.matches(this.subject)?e:void 0},merge:function(e){(!this.distinctSubject||this.distinctSubject!==e.distinctSubject&&this.distinctSubject.contains(e.distinctSubject))&&(this.distinctSubject=e.distinctSubject),[].push.apply(this.generics||(this.generics=[]),e.generics)},getDistinctElement:function(e,t){do{var n=t.constructor.ownedClasses;if(n){var r=n.get(e);if(r&&r.has(t))return t}}while(t=t.parentNode||P.get(t))},matches:function(e){var t=this.generics;if(t)for(var n=0,r=t.length;n<r;n++)if(this.getDistinctElement(t[n],e)!==this.distinctSubject)return!1;return!0}}),ne})?r.apply(t,i):r)||(e.exports=o)},function(e,t,n){var r,i,o;i=[n(0),n(4),n(1)],void 0===(o="function"==typeof(r=function(e,t,n){var r=n.Transform,i=n.Variable,o=n._changeValue,a=n.VArray,s=e.isGenerator;function u(e){for(var t=0,n=e.length;t<n;t++){var r=e[t];r&&r._getAsObject&&(e[t]=r._getAsObject())}return e}e.compose(r,function(e,t,n){this.sources=n,r.apply(this,arguments)},{_getAsObject:function(){return this.transform.apply(this,u(this.sources))}});var c=new Map;function l(e){return f(e)}function f(e,t,n){var o=c.get(typeof e)||c.get(e&&e.constructor)||e instanceof i&&!(e instanceof r)&&e.constructor;if(o)return new o(t?void 0:e);if(!n){var a;if(t?a=new i:(a=new i(e),e&&"object"==typeof e&&(a.fixed=!0)),e.then)return a;for(var s in e)if(e.hasOwnProperty(s)){var u=e[s],l=f(u,!0,!0);l?(l.key=s,l.parent=a,void 0===a[s]?a[s]=l:(a._properties||(a._properties={}))[s]=l):p(a,s,e)}return a}}function p(e,t,n){Object.defineProperty(e,t,{get:function(){return l.get(this,t,function(){return f(n[t],!0)})},set:function(e){l.set(this,t,e)},enumerable:!0})}function h(e){if(c.has(e))return c.get(e);if("object"==typeof e){if(e instanceof Array)return e[0]?a.of(h(e[0])):a;var t,n={};for(var r in e)n[r]=h(e[r]),t=!0;return t?i.with(n):i}return e}function d(e,t,n){n?n.notifies||(n=h(n)||i):console.warn("Invalid type specified for",e&&e.constructor.name,"property",t,"(ensure you are using a concrete type, not an interface)"),Object.defineProperty(e,t,{get:function(){return l.get(this,t,n)},set:function(e){l.set(this,t,e)},enumerable:!0})}return c.set("string",n.VString),c.set("number",n.VNumber),c.set("boolean",n.VBoolean),c.set("undefined",i),c.set(null,i),c.set(Array,a),c.set(Map,n.VMap),c.set(Set,n.VSet),n.reactive=l,e.copy(l,{from:function(e,t){return e&&e.property?e:"function"==typeof e&&s(e)?n.react(e,t):i.from(e)},getp:function(e,t){if(e){if(e.property){var n=e[t];return void 0!==n?n:e.property(t)}return e[t]}},get:function(e,t,n){var r=(e._properties||(e._properties={}))[t];return r||(e._properties[t]=r=new(h(n)),e.getValue&&(r.key=t,r.parent=e,r.listeners&&r.init())),r},set:function(e,t,n){var r=e[t];r.parent?o(r,3,n):r.put(n)},prop:function(e){return function(t,n){d(t,n,e)}},cond:function(e,n,r){return t.if(e,t.choose(n,r))},fcall:function(e,t){return e.property&&"function"==typeof e?e.apply(null,u(t)):new r(t[0],e,t)},mcall:function(e,t,n){var i=e[t];return"function"==typeof i&&i.property||"bind"===t?i.apply(e,u(n)):new r(n[0],e[t].bind(e),n)},ncall:function(e,t){return e.property&&"function"==typeof e?new(e.bind.apply(e,[null].concat(u(t)))):new r(t[0],function(){return new(e.bind.apply(e,[null].concat(arguments)))},t)},obj:function(e){return e},val:function(e){return e&&e.valueOf()},cls:function(e){return l=this,function(t){var n=t.prototype;for(var r in n instanceof i||(Object.getPrototypeOf(n)==Object.prototype?(Object.setPrototypeOf(t,i),Object.setPrototypeOf(n,i.prototype)):console.warn("Unable to make class a reactive variable")),e)d(n,r,e[r])}}}),e.copy(l,t),l})?r.apply(t,i):r)||(e.exports=o)},function(e,t,n){var r,i,o;i=[n(0),n(1)],void 0===(o="function"==typeof(r=function(e,t){var n=t.Variable;function r(e,t,n){if(e&&"object"==typeof e){if(e instanceof Array){t=[];for(var i=0,o=e.length;i<o;i++)t[i]=r(e[i],null,n)}else for(var i in t&&"object"==typeof t||(t=n&&n.get(e))||(t={},n&&n.set(e,t)),e)t[i]=r(e[i],t[i],n);return t}return e}return e.compose(n,function(t){this.copiedFrom=t,this.derivativeMap=new e.WeakMap(null,"derivative"),this.isDirty=new n(!1)},{getValue:function(e,t,i){this.state&&(this.state=null);var o=this.copiedFrom.valueOf();if(o&&"object"==typeof o){var a=this.derivativeMap.get(o);null==a&&(this.derivativeMap.set(o,a=r(o,void 0,this.derivativeMap)),this.value=a)}return void 0===this.value?o:n.prototype.getValue.call(this,e,t,i)},getCopyOf:function(e){var t=this.derivativeMap.get(e);return null==t&&this.derivativeMap.set(e,t=r(e,void 0,this.derivativeMap)),t},save:function(){if(this.copiedFrom.put)this.copiedFrom.put(this.valueOf());else{var e=this.copiedFrom.valueOf();r(this.valueOf(),e)}this.isDirty.put(!1),this.onSave&&this.onSave()},revert:function(){var t=this.copiedFrom.valueOf();this.derivativeMap=new e.WeakMap(null,"derivative"),this.put(r(t,void 0,this.derivativeMap)),this.isDirty.put(!1)},updated:function(){return this.isDirty.put(!0),n.prototype.updated.apply(this,arguments)}})})?r.apply(t,i):r)||(e.exports=o)},function(e,t,n){(function(r){var i,o,a;o=[n(0),n(1)],void 0===(a="function"==typeof(i=function(e,t){var n=(void 0!==r?r:window).Promise;function i(e){this.context=t.currentContext,this.promise=new n(e)}function o(e,t){return e&&t?function(n){return t.executeWithin(function(){var r=e(n);return r&&r.then?new s(r,t):r})}:e}function a(e){for(var t=new Array(e.length),n=i.propagateAbort,r=0,o=e.length;r<o;r++){var a=e[r];a&&a.then&&(a.notifies&&(a=a.then()),a.abort||(n=!1)),t[r]=a}return n&&(t.assignAbort=function(t){t.abort=function(t){for(var n=0,r=e.length;n<r;n++){var i=e[n];i&&i.abort&&i.abort(t)}}}),t}function s(e,t,n){this.context=t,this.promise=e,i.propagateAbort&&(n||e).abort&&(this.abort=(n||e).abort)}return e.copy(i.prototype,{then:function(e,t){var n=this.context,r=this.promise;if(n&&r.notifies){var i=this;return n.executeWithin(function(){return new s(r.then(o(e,n),o(t,n)),n,i)})}return new s(r.then(o(e,n),o(t,n)),n,this)},catch:function(e){var t=this.context;return new s(this.promise.catch(o(e,t)),t,this)},finally:function(e){var t=this.context;return new s(this.promise.finally(o(e,t)),t,this)},isContextual:!0}),i.resolve=function(e){return new s(e&&e.then?e:n.resolve(e),t.currentContext)},i.reject=function(e){return new s(n.reject(e),t.currentContext)},i.all=function(e){var r=a(e),i=new s(n.all(r),t.currentContext);return r.assignAbort&&r.assignAbort(i),i},i.race=function(e){var r=a(e),i=new s(n.race(r),t.currentContext);return r.assignAbort&&r.assignAbort(i),i},s.prototype=i.prototype,i})?i.apply(t,o):i)||(e.exports=a)}).call(this,n(2))}])});
//# sourceMappingURL=index.js.map